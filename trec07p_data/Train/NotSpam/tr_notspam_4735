From sugar-bounces@laptop.org  Tue Apr 24 19:34:09 2007
Return-Path: <sugar-bounces@laptop.org>
Received: from pedal.laptop.org (pedal.laptop.org [18.85.2.148])
	by speedy.uwaterloo.ca (8.12.8/8.12.5) with ESMTP id l3ONY86w020220
	for <ktwarwic@speedy.uwaterloo.ca>; Tue, 24 Apr 2007 19:34:08 -0400
Received: from pedal.laptop.org (localhost [127.0.0.1])
	by pedal.laptop.org (Postfix) with ESMTP id 3FA924F918;
	Tue, 24 Apr 2007 19:33:24 -0400 (EDT)
X-Original-To: sugar@laptop.org
Delivered-To: sugar@laptop.org
Received: from spam.laptop.org (spam.laptop.org [18.85.46.23])
	by pedal.laptop.org (Postfix) with ESMTP id 2E2F94F904
	for <sugar@laptop.org>; Tue, 24 Apr 2007 19:33:22 -0400 (EDT)
X-ASG-Debug-ID: 1177457641-485800000000-3Xmyjt
X-Barracuda-URL: http://18.85.46.23:8000/cgi-bin/mark.cgi
X-Barracuda-Connect: theworths.org[217.160.253.102]
X-Barracuda-Start-Time: 1177457641
X-Barracuda-Encrypted: DHE-RSA-AES256-SHA
Received: from theworths.org (theworths.org [217.160.253.102])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by spam.laptop.org (Spam Firewall) with ESMTP id 0D7B323F7E
	for <sugar@laptop.org>; Tue, 24 Apr 2007 19:34:02 -0400 (EDT)
Received: (qmail 10629 invoked from network); 24 Apr 2007 19:33:57 -0400
Received: from localhost (HELO raht.cworth.org) (127.0.0.1)
	by localhost with SMTP; 24 Apr 2007 19:33:57 -0400
Date: Tue, 24 Apr 2007 16:33:56 -0700
Message-ID: <87ps5t73ff.wl%cworth@cworth.org>
From: Carl Worth <cworth@redhat.com>
To: Don Hopkins <dhopkins@DonHopkins.com>
X-ASG-Orig-Subj: Re: Efficient general purpose tile engine,
	and a cellular automata machine
In-Reply-To: <462DE44D.1060304@DonHopkins.com>
References: <461F508F.8000406@rpi.edu> <46216D8A.4000103@DonHopkins.com>
	<1176615055.864.14.camel@localhost.localdomain>
	<87fy70tdn9.wl%cworth@cworth.org>
	<1176753788.29852.17.camel@localhost.localdomain>
	<46240DD6.1070600@DonHopkins.com> <87647vtynk.wl%cworth@cworth.org>
	<1176818012.26202.10.camel@localhost.localdomain>
	<462DE44D.1060304@DonHopkins.com>
User-Agent: Wanderlust/2.14.0 (Africa) Emacs/21.4 Mule/5.0 (SAKAKI)
Organization: Red Hat
MIME-Version: 1.0 (generated by SEMI 1.14.6 - "Maruoka")
X-Barracuda-Bayes: INNOCENT GLOBAL 0.0000 1.0000 -2.0210
X-Barracuda-Virus-Scanned: by Barracuda Spam Firewall at laptop.org
X-Barracuda-Spam-Score: -2.02
X-Barracuda-Spam-Status: No, SCORE=-2.02 using global scores of TAG_LEVEL=3.5
	QUARANTINE_LEVEL=1000.0 KILL_LEVEL=5.5 tests=
X-Barracuda-Spam-Report: Code version 3.1, rules version 3.1.15169
	Rule breakdown below
	pts rule name              description
	---- ----------------------
	--------------------------------------------------
Cc: Games for the OLPC <games@laptop.org>,
   "OLPC Developer's List" <devel@laptop.org>,
   "'Sugar List'" <sugar@laptop.org>
Subject: Re: [sugar] Efficient general purpose tile engine,
	and a cellular automata machine
X-BeenThere: sugar@laptop.org
X-Mailman-Version: 2.1.9
Precedence: list
List-Id: "Discussion of OLPC design,
	desktop platform and user experience" <sugar.laptop.org>
List-Unsubscribe: <http://mailman.laptop.org/mailman/listinfo/sugar>,
	<mailto:sugar-request@laptop.org?subject=unsubscribe>
List-Archive: <http://mailman.laptop.org/pipermail/sugar>
List-Post: <mailto:sugar@laptop.org>
List-Help: <mailto:sugar-request@laptop.org?subject=help>
List-Subscribe: <http://mailman.laptop.org/mailman/listinfo/sugar>,
	<mailto:sugar-request@laptop.org?subject=subscribe>
Content-Type: multipart/mixed; boundary="===============6482995759937725598=="
Mime-version: 1.0
Sender: sugar-bounces@laptop.org
Errors-To: sugar-bounces@laptop.org
Status: O
Content-Length: 2981
Lines: 86

--===============6482995759937725598==
Content-Type: multipart/signed;
 boundary="pgp-sign-Multipart_Tue_Apr_24_16:33:36_2007-1"; micalg=pgp-sha1;
 protocol="application/pgp-signature"
Content-Transfer-Encoding: 7bit

--pgp-sign-Multipart_Tue_Apr_24_16:33:36_2007-1
Content-Type: text/plain; charset=US-ASCII

On Tue, 24 Apr 2007 04:04:45 -0700, Don Hopkins wrote:
> Question: How to I tell Cairo to use FILTER_FAST instead of FILTER_BEST?
> The set_filter method is supported by the cairo pattern object, but not
> the surface or the context. How to I wrangle a surface into a pattern,
> or use a pattern instead of a surface, or whatever I have to do to
> switch to fast nearest neighbor interpolation mode when scaling a surface?

Whenever you're drawing anything with cairo there's a source pattern
object involved. That's most obvious when you set the pattern
explicitly with cairo_set_source. It's less obvious when you're using
the convenience function of cairo_set_source_surface. But it should be
clear again if you realize you could replace any call to
cairo_set_source_surface with the following sequence:

	cairo_pattern_t *pattern = cairo_pattern_create_for_surface (surface);

	cairo_matrix_init_translate (&matrix, -x, -y);
	cairo_pattern_set_matrix (pattern, &matrix);
	cairo_set_source (cr, pattern);

	cairo_pattern_destroy (pattern);

So there's the answer to your "wrangle a surface into a pattern"
question.

But since cairo_set_source_surface is quite convenient at creating the
pattern for you, here's another idiom that would probably be helpful
for you:

	cairo_set_source_surface (cr, surface, x, y);
	cairo_pattern_set_filter (cairo_get_source (cr), CAIRO_FILTER_FAST);

That's what I'd recommend you do here.

Or I guess in python land that would be:

	cr.get_source().set_filter (cairo.FILTER_FAST)

> http://www.DonHopkins.com/home/cam.tgz

Very nice, thanks for sharing this.

By the way, with all the aggressive tile caching you are doing here,
and with the many repeated images, (at least in the current example),
have you considered regenerating the tiles at "native" scale when
zooming in? That could make for a very lovely effect. (Or are you just
loading images for those little circles and arrows instead of drawing
them with cairo?).

-Carl

--pgp-sign-Multipart_Tue_Apr_24_16:33:36_2007-1
Content-Type: application/pgp-signature
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)

iD8DBQBGLpPk6JDdNq8qSWgRAm3WAKCKKdqMPgST01UxXGwaKjTkvj/+aACfWH6+
tjETlm62d7KQcFt2NhxtCmg=
=vRUQ
-----END PGP SIGNATURE-----

--pgp-sign-Multipart_Tue_Apr_24_16:33:36_2007-1--

--===============6482995759937725598==
Content-Type: text/plain; charset="us-ascii"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

_______________________________________________
Sugar mailing list
Sugar@laptop.org
http://mailman.laptop.org/mailman/listinfo/sugar

--===============6482995759937725598==--

