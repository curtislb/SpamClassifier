From r-help-bounces@stat.math.ethz.ch  Tue Jun 12 11:10:03 2007
Return-Path: <r-help-bounces@stat.math.ethz.ch>
Received: from hypatia.math.ethz.ch (hypatia.math.ethz.ch [129.132.145.15])
	by flax9.uwaterloo.ca (8.12.8/8.12.5) with ESMTP id l5CFA1L9027709
	for <ktwarwic@flax9.uwaterloo.ca>; Tue, 12 Jun 2007 11:10:01 -0400
Received: from hypatia.math.ethz.ch (hypatia [129.132.145.15])
	by hypatia.math.ethz.ch (8.13.6/8.13.6) with ESMTP id l5CF8k0N025938;
	Tue, 12 Jun 2007 17:08:58 +0200
X-Spam-Checker-Version: SpamAssassin 3.2.0 (2007-05-01) on hypatia.math.ethz.ch
X-Spam-Level: **
X-Spam-Status: No, score=2.1 required=5.0 tests=AWL, BAYES_50,
	DKIM_POLICY_SIGNSOME, RCVD_NUMERIC_HELO,
	SPF_HELO_PASS autolearn=no version=3.2.0
Received: from NIHCESSMTP2.hub.nih.gov (nihcessmtp2.hub.nih.gov
	[128.231.90.116])
	by hypatia.math.ethz.ch (8.13.6/8.13.6) with ESMTP id l5CF8d8o025904
	for <r-help@stat.math.ethz.ch>; Tue, 12 Jun 2007 17:08:39 +0200
Received: from NIHCESMLBX2.nih.gov ([156.40.71.202]) by
	NIHCESSMTP2.hub.nih.gov with Microsoft SMTPSVC(6.0.3790.1830); 
	Tue, 12 Jun 2007 11:08:34 -0400
Received: from 156.40.71.188 ([156.40.71.188]) by NIHCESMLBX2.nih.gov
	([156.40.71.202]) via Exchange Front-End Server mail.nih.gov
	([156.40.71.167]) with Microsoft Exchange Server HTTP-DAV ; 
	Tue, 12 Jun 2007 15:08:34 +0000
Received: from gestalt by mail.nih.gov; 12 Jun 2007 11:08:34 -0400
From: Alan S Barnett <asb@mail.nih.gov>
To: R-help <r-help@stat.math.ethz.ch>
Organization: NIMH/CBDB
Date: Tue, 12 Jun 2007 11:08:33 -0400
Message-Id: <1181660913.17656.30.camel@gestalt.nimh.nih.gov>
Mime-Version: 1.0
X-Mailer: Evolution 2.0.2 (2.0.2-34.el4) 
X-OriginalArrivalTime: 12 Jun 2007 15:08:34.0545 (UTC)
	FILETIME=[8BCEEE10:01C7AD03]
X-Virus-Scanned: by amavisd-new at stat.math.ethz.ch
Subject: [R] 2 Trellis graphics question
X-BeenThere: r-help@stat.math.ethz.ch
X-Mailman-Version: 2.1.9
Precedence: list
Reply-To: asb@mail.nih.gov
List-Id: "Main R Mailing List: Primary help" <r-help.stat.math.ethz.ch>
List-Unsubscribe: <https://stat.ethz.ch/mailman/listinfo/r-help>,
	<mailto:r-help-request@stat.math.ethz.ch?subject=unsubscribe>
List-Archive: <https://stat.ethz.ch/pipermail/r-help>
List-Post: <mailto:r-help@stat.math.ethz.ch>
List-Help: <mailto:r-help-request@stat.math.ethz.ch?subject=help>
List-Subscribe: <https://stat.ethz.ch/mailman/listinfo/r-help>,
	<mailto:r-help-request@stat.math.ethz.ch?subject=subscribe>
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: 7bit
Sender: r-help-bounces@stat.math.ethz.ch
Errors-To: r-help-bounces@stat.math.ethz.ch

1) I have a data that includes some "bad" data.  I want to make a
trellis plot where each panel contains 
a) A scatter plot of the "good" data
b) A scatter plot of the "bad" data in a different color
c) A best fit line of all the data, and
d) A best fit line of the "good" data.

I tried using xyplot and setting the "group" argument, but I'm having
trouble.  Here is my code:

xyplot(y ~ x | status, data=data,groups=good,
+  panel=function(x,y,...){
+  panel.xyplot(x,y,...)
+  panel.lmline(x,y,col = "red")
+  panel.lmline(x[good],y[good],col = "blue")
+ } 
+ )
a,groups=good,
data is a data frame containing names x, y and status.
good is logical variable labeling the "good" data.
Each panel of the trellis plot generated by this code includes
a) A scatterplot of the "good" data in magenta,
b) A scatterplot of the "bad" data in blue,
c) A best fit line of all the data in blue.

If I reverse the order of the last two lines, the best fit lines are
displayed in red.  Clearly, the correct value of good is not being
passed to panel.lmline, but is being correctly passed to panel.xyplot.

Substituting 
 panel.lmline(x,y,...)
for
 panel.lmline(x,y,col = "red") 
 panel.lmline(x[good],y[good],col = "blue)
results in the best fit line being plotted in black.
 
2) There are 5 different values of status, but I only want to plot three
of them.  Can I do this without copying only the desired elements into a
new data frame?

-- 
Alan S Barnett <asb@mail.nih.gov>
NIMH/CBDB

______________________________________________
R-help@stat.math.ethz.ch mailing list
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

