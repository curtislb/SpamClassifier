From samba-technical-bounces+ktwarwic=speedy.uwaterloo.ca@lists.samba.org  Mon Apr 30 06:18:29 2007
Return-Path: <samba-technical-bounces+ktwarwic=speedy.uwaterloo.ca@lists.samba.org>
Received: from lists.samba.org (mail.samba.org [66.70.73.150])
	by speedy.uwaterloo.ca (8.12.8/8.12.5) with ESMTP id l3UAIT6w011641
	for <ktwarwic@speedy.uwaterloo.ca>; Mon, 30 Apr 2007 06:18:29 -0400
Received: from dp.samba.org (localhost [127.0.0.1])
	by lists.samba.org (Postfix) with ESMTP id 3DD79162AF2
	for <ktwarwic@speedy.uwaterloo.ca>; Mon, 30 Apr 2007 10:18:28 +0000 (GMT)
X-Spam-Checker-Version: SpamAssassin 3.1.7 (2006-10-05) on dp.samba.org
X-Spam-Level: 
X-Spam-Status: No, score=-0.1 required=3.8 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO,RCVD_IN_DSBL,SPF_NEUTRAL autolearn=no version=3.1.7
X-Original-To: samba-technical@samba.org
Delivered-To: samba-technical@samba.org
Received: from smtp-vbr16.xs4all.nl (smtp-vbr16.xs4all.nl [194.109.24.36])
	by lists.samba.org (Postfix) with ESMTP id DF523162ACD;
	Mon, 30 Apr 2007 10:17:54 +0000 (GMT)
Received: from rhonwyn.vernstok.nl (a62-251-123-16.adsl.xs4all.nl
	[62.251.123.16])
	by smtp-vbr16.xs4all.nl (8.13.8/8.13.8) with ESMTP id l3UAHs7F088599;
	Mon, 30 Apr 2007 12:17:54 +0200 (CEST)
	(envelope-from jelmer@samba.org)
Received: from localhost (localhost [127.0.0.1])
	by rhonwyn.vernstok.nl (Postfix) with ESMTP id 901FA39A5A7;
	Mon, 30 Apr 2007 12:17:53 +0200 (CEST)
Received: from rhonwyn.vernstok.nl ([127.0.0.1])
	by localhost (rhonwyn.vernstok.nl [127.0.0.1]) (amavisd-new, port 10024)
	with SMTP id BDBI+D0VJalC; Mon, 30 Apr 2007 12:17:46 +0200 (CEST)
Received: from ganieda.vernstok.nl (ganieda.lan.vernstok.nl [192.168.1.6])
	by rhonwyn.vernstok.nl (Postfix) with ESMTP id 2E03C39A5A6;
	Mon, 30 Apr 2007 12:17:46 +0200 (CEST)
Received: from [127.0.0.1] (localhost [127.0.0.1])
	by ganieda.vernstok.nl (Postfix) with ESMTP id BA0AD5C4041;
	Mon, 30 Apr 2007 13:17:43 +0200 (CEST)
Message-ID: <4635D057.8070505@samba.org>
Date: Mon, 30 Apr 2007 13:17:43 +0200
From: Jelmer Vernooij <jelmer@samba.org>
User-Agent: Thunderbird 1.5.0.10 (X11/20070403)
MIME-Version: 1.0
To: Andrew Bartlett <abartlet@samba.org>
References: <1177862246.6033.44.camel@localhost.localdomain>	<463594C7.3010807@samba.org>	<1177915672.31472.16.camel@localhost.localdomain>	<4635A737.3030503@samba.org>	<1177919003.31472.32.camel@localhost.localdomain>	<4635B10F.2000506@samba.org>	<1177923760.31472.46.camel@localhost.localdomain>	<4635C4A2.2060306@samba.org>
	<4635B939.6050702@samba.org>	<1177926565.31472.60.camel@localhost.localdomain>	<4635CC0F.8080907@samba.org>
	<1177927448.31472.65.camel@localhost.localdomain>
In-Reply-To: <1177927448.31472.65.camel@localhost.localdomain>
X-Enigmail-Version: 0.94.2.0
OpenPGP: id=1EEF5276;
	url=http://samba.org/~jelmer/1eef5276.asc
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
X-Virus-Scanned: by XS4ALL Virus Scanner
Cc: "Stefan \(metze\) Metzmacher" <metze@samba.org>, samba-technical@samba.org
Subject: Re: [SAMBA4] we should create just one test environment
X-BeenThere: samba-technical@lists.samba.org
X-Mailman-Version: 2.1.5
Precedence: list
List-Id: "Discussions on Samba internals. For general questions please
	subscribe to the list samba@samba.org"
	<samba-technical.lists.samba.org>
List-Unsubscribe: <https://lists.samba.org/mailman/listinfo/samba-technical>, 
	<mailto:samba-technical-request@lists.samba.org?subject=unsubscribe>
List-Archive: <http://lists.samba.org/archive/samba-technical>
List-Post: <mailto:samba-technical@lists.samba.org>
List-Help: <mailto:samba-technical-request@lists.samba.org?subject=help>
List-Subscribe: <https://lists.samba.org/mailman/listinfo/samba-technical>,
	<mailto:samba-technical-request@lists.samba.org?subject=subscribe>
Sender: samba-technical-bounces+ktwarwic=speedy.uwaterloo.ca@lists.samba.org
Errors-To: samba-technical-bounces+ktwarwic=speedy.uwaterloo.ca@lists.samba.org
Status: O
Content-Length: 2939
Lines: 67

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Andrew Bartlett wrote:
> On Mon, 2007-04-30 at 12:59 +0200, Jelmer Vernooij wrote:
>> Andrew Bartlett wrote:
>>> On Mon, 2007-04-30 at 11:39 +0200, Stefan (metze) Metzmacher wrote:
>>>> -----BEGIN PGP SIGNED MESSAGE-----
>>>> Hash: SHA1
>>>> we have already make testenv SELFTEST_TESTENV=member
>>>>
>>>> we can make that the default for make testenv...
>>> But then it doesn't match how we run the tests otherwise.  
>>>
>>> My point is that I don't want to have to constantly wonder:  what test
>>> environment did we declare for this test, what test environment did it
>>> get, and what is 'make testenv' giving me
>> We only have three different ones at the moment (none, dc, member) so it
>> should be easy to guess against which environment a test is being run.
>> Once we get more, it may be harder to keep track, but then provisioning
>> will be too expensive to set up all environments always anyway.h
> You keep saying that, and this seems to be the reason why we are doing
> this the current way.  But I really don't buy it - we are going to be
> doing a *lot* more tests against the member server, so we will almost
> always have to pay that setup price.
Maybe that is true for the member server, but what happens when we start
adding tests for trusted domains, nt4-style dcs or involving one or more
samba3 servers?

The setup price also doesn't have to be paid when you're just running dc
tests - of which we still have plenty.

> I also think that we can reduce that price.
How?

>>> I really just want one setup, and I don't mind the extra smbd or member
>>> server configuration if it ensures that all the tests run against a
>>> consistent set of servers.
>>> If we are only going to give the tests the environment they declare, are
>>> we going to start up/shut down environments between tests?
>> We do support doing that, though it is not the default. It can be very
>> useful in tracking down, for example, whether a test is corrupting one
>> of smbd's databases and thus is causing strange failures in subsequent
>> tests.
>>
>> At the moment, though, we set up environments on a when-needed basis and
>> close them all when selftest exits. 
> That's why I just want to set up a generally useful test environment
> once, and run with that.  It can list 'provides: dc, member', if that
> helps you keep track of what scripts require which parts, but I just
> want one test network...
I think we're just repeating ourselves here - I'm not a big fan of a
kitchensink test environment.

Cheers,

Jelmer
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iQCVAwUBRjXQVAy0JeEGD2blAQJ6owP+MZKJLsyDs0cv8HLZFFj2r/oLTGTKF+zq
yHyMl3Kup0ou9elk0dcvirTLAY4W/mYnw5oUJh1E8Nc60bRonPuNpMkliY6qP/Nq
1j9PUKA8xs3WoJwqNTLq6Q7uh2qR786l464S8inxv5wSg3IIJqNjgf+MNwIvD8pL
reopkD67E28=
=D/B/
-----END PGP SIGNATURE-----

