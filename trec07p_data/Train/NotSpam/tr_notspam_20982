From beginners-return-92604-ktwarwic=speedy.uwaterloo.ca@perl.org  Wed Jun 20 15:09:06 2007
Return-Path: <beginners-return-92604-ktwarwic=speedy.uwaterloo.ca@perl.org>
Received: from lists.develooper.com (x6.develooper.com [63.251.223.186])
	by flax9.uwaterloo.ca (8.12.8/8.12.5) with SMTP id l5KJ95L9013848
	for <ktwarwic@flax9.uwaterloo.ca>; Wed, 20 Jun 2007 15:09:05 -0400
Received: (qmail 1670 invoked by uid 514); 20 Jun 2007 19:08:53 -0000
Mailing-List: contact beginners-help@perl.org; run by ezmlm
Precedence: bulk
List-Post: <mailto:beginners@perl.org>
List-Help: <mailto:beginners-help@perl.org>
List-Unsubscribe: <mailto:beginners-unsubscribe@perl.org>
List-Subscribe: <mailto:beginners-subscribe@perl.org>
List-Id: <beginners.perl.org>
Delivered-To: mailing list beginners@perl.org
Received: (qmail 1658 invoked from network); 20 Jun 2007 19:08:50 -0000
Received: from x1a.develooper.com (HELO x1.develooper.com) (216.52.237.111)
  by lists.develooper.com with SMTP; 20 Jun 2007 19:08:50 -0000
Received: (qmail 9258 invoked by uid 225); 20 Jun 2007 19:08:50 -0000
Delivered-To: beginners@perl.org
Received: (qmail 9246 invoked by alias); 20 Jun 2007 19:08:49 -0000
X-Spam-Status: No, hits=-1.9 required=8.0
	tests=BAYES_00,DKIM_POLICY_SIGNSOME,DK_POLICY_SIGNSOME,SPF_NEUTRAL
X-Spam-Check-By: la.mx.develooper.com
Received-SPF: neutral (x1.develooper.com: 63.251.223.186 is neither permitted nor denied by domain of mritty@gmail.com)
Received: from x6.develooper.com (HELO lists.develooper.com) (63.251.223.186)
    by la.mx.develooper.com (qpsmtpd/0.28) with SMTP; Wed, 20 Jun 2007 12:08:39 -0700
Received: (qmail 1632 invoked by uid 515); 20 Jun 2007 19:08:35 -0000
To: beginners@perl.org
MBOX-Line: From news@google.com Wed Jun 20 19:08:32 2007
Delivered-To: colobus-nntpmod@lists.develooper.com
Received: (qmail 1611 invoked from network); 20 Jun 2007 19:08:31 -0000
Received: from x1a.develooper.com (HELO x1.develooper.com) (216.52.237.111)
  by lists.develooper.com with SMTP; 20 Jun 2007 19:08:31 -0000
Received: (qmail 9149 invoked by uid 225); 20 Jun 2007 19:08:31 -0000
Delivered-To: news-moderator-perl.beginners@perl.org
Received: (qmail 9141 invoked by alias); 20 Jun 2007 19:08:30 -0000
Received-SPF: neutral (x1.develooper.com: 216.168.1.22 is neither permitted nor denied by domain of news@google.com)
Received: from trinity.supernews.net (HELO trinity.supernews.net) (216.168.1.22)
    by la.mx.develooper.com (qpsmtpd/0.28) with ESMTP; Wed, 20 Jun 2007 12:08:27 -0700
Received: from proxy.google.com ([64.233.167.4]:38383)
	by trinity.supernews.net with esmtps (TLSv1:AES256-SHA:256)
	(Exim 4.66 (FreeBSD))
	(envelope-from <news@google.com>)
	id 1I15XS-00060A-WE
	for perl-beginners@moderators.isc.org; Wed, 20 Jun 2007 19:08:23 +0000
Received: from AR020007
	by proxy.google.com with ESMTP id l5KJ8Djg014985
	for <perl-beginners@moderators.isc.org>; Wed, 20 Jun 2007 12:08:13 -0700
Received: (from news@localhost)
	by Google Production id l5KJ8Cxc025008
	for perl-beginners@moderators.isc.org; Wed, 20 Jun 2007 12:08:12 -0700
From: Paul Lalli <mritty@gmail.com>
Subject: Re: the Database is not updated
Date: Wed, 20 Jun 2007 12:08:12 -0700
Organization: http://groups.google.com
Lines: 76
Message-ID: <1182366492.735529.25050@w5g2000hsg.googlegroups.com>
References: <46797093.6010006@gmail.com>
NNTP-Posting-Host: 204.97.183.31
Mime-Version: 1.0
Content-Type: text/plain; charset="us-ascii"
X-Trace: posting.google.com 1182366492 25007 127.0.0.1 (20 Jun 2007 19:08:12 GMT)
X-Complaints-To: groups-abuse@google.com
NNTP-Posting-Date: Wed, 20 Jun 2007 19:08:12 +0000 (UTC)
In-Reply-To: <46797093.6010006@gmail.com>
User-Agent: G2/1.0
X-HTTP-UserAgent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; InfoPath.1),gzip(gfe),gzip(gfe)
X-HTTP-Via: 1.0 mndnetcachea (NetCache NetApp/6.0.5)
Complaints-To: groups-abuse@google.com
Injection-Info: w5g2000hsg.googlegroups.com; posting-host=204.97.183.31;
   posting-account=p3DCbw0AAAAc32agNMy1mXKInuw5KHP_
X-Posted-By: 63.251.223.186
X-Old-Spam-Check-By: la.mx.develooper.com
X-Old-Spam-Status: No, hits=-1.9 required=8.0
	tests=BAYES_00,DKIM_POLICY_SIGNSOME,DK_POLICY_SIGNSOME,SPF_NEUTRAL

On Jun 20, 2:23 pm, mykl...@gmail.com (Aruna Goke) wrote:
> Can someone put me thru this?
>
> when I run the script..it bring no error..

That's because you never asked it to give you any errors.  That's
something of a Perl trait - it generally doesn't tell you anything's
wrong unless you ask it to tell you.

> however, the table radacct is not updated.
>
> what have i done wrong.
>

> $dbh = DBI->connect($data_source, $user, $pass);

You should pass a fourth argument to connect().  That argument is a
reference to a hash of the options you'd like to enable.
Specifically, you should enable RaiseError, which tells DBI to die
with an error any time there's a database error.

So:
my $dbh = DBI->connect( $data_source, $user, $pass, { RaiseError =>
1 } );

(I also usually recomment specifying AutoCommit as either 0 or 1,
depending on if you want the database to commit after every insert/
update/delete, because the default can change between different
database systems, different versions of the database, and different
versions of DBD::*)

> $sql = "UPDATE radacct SET AcctSessionTime = ?, TrunkIdOut = ?,
> TrunkIdIn = ? where AcctUniqueId = ?";
> $sth = $dbh->prepare($sql);

Because you've now enabled RaiseError, if prepare() has an error, Perl
will now exit with an error.  If you don't enable RaiseError, you must
check prepare() explicitly:
my $sth = $dbh->prepare($sql) or
   die "Error preparing <<$sql>>: $DBI::errstr";

> #split the file into variables
>    @x =(split/,/)[0,1,2,3,4,5,6];

my @x = (split /,/)[0..6];
or
my @x;
@x[0..6] = split /,/;

>   $sth->execute($x[2], $x[5], $x[4], $x[6]);

$sth->execute(@x[2,5,4,6]);

And, again, if you don't enable RaiseError, you must check execute()
for errors explicitly:
$sth->execute(@x[2,5,4,6]) or
   die "Error executing <<$sth->{Statement}>> with values @x[2,5,4,6]:
$DBI::errstr";

This might not be necessary for the RDMS you use, but I generally end
my database-driven scripts with this block:

END {
   if ($?) {
        print "Exiting with error, rolling back data!\n";
        $dbh->rollback();
   } else {
        print "Exiting successfully, committing data\n";
        $dbh->commit();
   }
   $dbh->disconnect();
}

Hope this helps,
Paul Lalli


-- 
To unsubscribe, e-mail: beginners-unsubscribe@perl.org
For additional commands, e-mail: beginners-help@perl.org
http://learn.perl.org/


