From samba-technical-bounces+ktwarwic=speedy.uwaterloo.ca@lists.samba.org  Mon Apr 30 14:26:00 2007
Return-Path: <samba-technical-bounces+ktwarwic=speedy.uwaterloo.ca@lists.samba.org>
Received: from lists.samba.org (mail.samba.org [66.70.73.150])
	by speedy.uwaterloo.ca (8.12.8/8.12.5) with ESMTP id l3UIPx6w016098
	for <ktwarwic@speedy.uwaterloo.ca>; Mon, 30 Apr 2007 14:26:00 -0400
Received: from dp.samba.org (localhost [127.0.0.1])
	by lists.samba.org (Postfix) with ESMTP id 79226162BC6
	for <ktwarwic@speedy.uwaterloo.ca>; Mon, 30 Apr 2007 18:25:58 +0000 (GMT)
X-Spam-Checker-Version: SpamAssassin 3.1.7 (2006-10-05) on dp.samba.org
X-Spam-Level: 
X-Spam-Status: No, score=-1.8 required=3.8 tests=ALL_TRUSTED,AWL,BAYES_00,
	RCVD_IN_DSBL autolearn=ham version=3.1.7
X-Original-To: samba-technical@samba.org
Delivered-To: samba-technical@samba.org
Received: from [127.0.0.1] (dp [66.70.73.150])
	by lists.samba.org (Postfix) with ESMTP id EE255162AEC;
	Mon, 30 Apr 2007 18:25:08 +0000 (GMT)
From: Andrew Bartlett <abartlet@samba.org>
To: metze@samba.org
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature";
	boundary="=-twZ2Xex/SRTm+ld88wiY"
Date: Mon, 30 Apr 2007 20:25:00 +0200
Message-Id: <1177957500.31472.105.camel@localhost.localdomain>
Mime-Version: 1.0
X-Mailer: Evolution 2.10.1 (2.10.1-4.fc7) 
Cc: samba-technical@samba.org
Subject: My current patch for winbind
X-BeenThere: samba-technical@lists.samba.org
X-Mailman-Version: 2.1.5
Precedence: list
List-Id: "Discussions on Samba internals. For general questions please
	subscribe to the list samba@samba.org"
	<samba-technical.lists.samba.org>
List-Unsubscribe: <https://lists.samba.org/mailman/listinfo/samba-technical>, 
	<mailto:samba-technical-request@lists.samba.org?subject=unsubscribe>
List-Archive: <http://lists.samba.org/archive/samba-technical>
List-Post: <mailto:samba-technical@lists.samba.org>
List-Help: <mailto:samba-technical-request@lists.samba.org?subject=help>
List-Subscribe: <https://lists.samba.org/mailman/listinfo/samba-technical>,
	<mailto:samba-technical-request@lists.samba.org?subject=subscribe>
Sender: samba-technical-bounces+ktwarwic=speedy.uwaterloo.ca@lists.samba.org
Errors-To: samba-technical-bounces+ktwarwic=speedy.uwaterloo.ca@lists.samba.org
Status: O
Content-Length: 15682
Lines: 235


--=-twZ2Xex/SRTm+ld88wiY
Content-Type: multipart/mixed; boundary="=-viUGsSpyTmeE/vtvcuQ1"


--=-viUGsSpyTmeE/vtvcuQ1
Content-Type: text/plain
Content-Transfer-Encoding: quoted-printable

Attached is my current winbind patch, to get Samba4 going.

I then test it with=20
SELFTEST_TESTENV=3Dmember make gdbtest-env

and in the testenv

bin/smbclient //localmember3/tmp -Uadministrator%localmemberpass
$CONFIGURATION

--=20
Andrew Bartlett                                http://samba.org/~abartlet/
Authentication Developer, Samba Team           http://samba.org
Samba Developer, Red Hat Inc.                  http://redhat.com


--=-viUGsSpyTmeE/vtvcuQ1
Content-Disposition: attachment; filename=winbind-auth-methods.patch
Content-Transfer-Encoding: base64
Content-Type: text/x-patch; name=winbind-auth-methods.patch; charset=UTF-8

SW5kZXg6IHBhcmFtL2xvYWRwYXJtLmMNCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCi0tLSBwYXJhbS9sb2FkcGFybS5j
CShyZXZpc2lvbiAyMjYxMCkNCisrKyBwYXJhbS9sb2FkcGFybS5jCSh3b3JraW5nIGNvcHkpDQpA
QCAtMzk4LDcgKzM5OCw2IEBADQogCXsiU2VjdXJpdHkgT3B0aW9ucyIsIFBfU0VQLCBQX1NFUEFS
QVRPUn0sDQogCQ0KIAl7InNlY3VyaXR5IiwgUF9FTlVNLCBQX0dMT0JBTCwgJkdsb2JhbHMuc2Vj
dXJpdHksIE5VTEwsIGVudW1fc2VjdXJpdHksIEZMQUdfQkFTSUMgfCBGTEFHX0FEVkFOQ0VEIHwg
RkxBR19XSVpBUkQgfCBGTEFHX0RFVkVMT1BFUn0sDQotCXsiYXV0aCBtZXRob2RzIiwgUF9MSVNU
LCBQX0dMT0JBTCwgJkdsb2JhbHMuQXV0aE1ldGhvZHMsIE5VTEwsIE5VTEwsIEZMQUdfQkFTSUMg
fCBGTEFHX0FEVkFOQ0VEIHwgRkxBR19XSVpBUkQgfCBGTEFHX0RFVkVMT1BFUn0sDQogCXsiZW5j
cnlwdCBwYXNzd29yZHMiLCBQX0JPT0wsIFBfR0xPQkFMLCAmR2xvYmFscy5iRW5jcnlwdFBhc3N3
b3JkcywgTlVMTCwgTlVMTCwgRkxBR19CQVNJQyB8IEZMQUdfQURWQU5DRUQgfCBGTEFHX1dJWkFS
RCB8IEZMQUdfREVWRUxPUEVSfSwNCiAJeyJudWxsIHBhc3N3b3JkcyIsIFBfQk9PTCwgUF9HTE9C
QUwsICZHbG9iYWxzLmJOdWxsUGFzc3dvcmRzLCBOVUxMLCBOVUxMLCBGTEFHX0FEVkFOQ0VEIHwg
RkxBR19ERVZFTE9QRVJ9LA0KIAl7Im9iZXkgcGFtIHJlc3RyaWN0aW9ucyIsIFBfQk9PTCwgUF9H
TE9CQUwsICZHbG9iYWxzLmJPYmV5UGFtUmVzdHJpY3Rpb25zLCBOVUxMLCBOVUxMLCBGTEFHX0FE
VkFOQ0VEIHwgRkxBR19ERVZFTE9QRVJ9LA0KQEAgLTYwOSw3ICs2MDgsOSBAQA0KIAlkb19wYXJh
bWV0ZXIoImRjZXJwYyBlbmRwb2ludCBzZXJ2ZXJzIiwgImVwbWFwcGVyIHNydnN2YyB3a3NzdmMg
cnBjZWNobyBzYW1yIG5ldGxvZ29uIGxzYXJwYyBzcG9vbHNzIGRyc3VhcGkgd2lucmVnIGRzc2V0
dXAgdW5peGluZm8iLCBOVUxMKTsNCiAJZG9fcGFyYW1ldGVyKCJzZXJ2ZXIgc2VydmljZXMiLCAi
c21iIHJwYyBuYnQgd3JlcGwgbGRhcCBjbGRhcCB3ZWIga2RjIGRyZXBsIHdpbmJpbmQiLCBOVUxM
KTsNCiAJZG9fcGFyYW1ldGVyKCJudHB0ciBwcm92aWRvciIsICJzaW1wbGVfbGRiIiwgTlVMTCk7
DQotCWRvX3BhcmFtZXRlcigiYXV0aCBtZXRob2RzIiwgImFub255bW91cyBzYW1faWdub3JlZG9t
YWluIiwgTlVMTCk7DQorCWRvX3BhcmFtZXRlcigiYXV0aCBtZXRob2RzOmRvbWFpbiBjb250cm9s
bGVyIiwgImFub255bW91cyBzYW1faWdub3JlZG9tYWluIiwgTlVMTCk7DQorCWRvX3BhcmFtZXRl
cigiYXV0aCBtZXRob2RzOm1lbWJlciBzZXJ2ZXIiLCAiYW5vbnltb3VzIHNhbSB3aW5iaW5kIiwg
TlVMTCk7DQorCWRvX3BhcmFtZXRlcigiYXV0aCBtZXRob2RzOnN0YW5kYWxvbmUiLCAiYW5vbnlt
b3VzIHNhbV9pZ25vcmVkb21haW4iLCBOVUxMKTsNCiAJZG9fcGFyYW1ldGVyKCJwcml2YXRlIGRp
ciIsIGR5bl9QUklWQVRFX0RJUiwgTlVMTCk7DQogCWRvX3BhcmFtZXRlcigic2FtIGRhdGFiYXNl
IiwgInNhbS5sZGIiLCBOVUxMKTsNCiAJZG9fcGFyYW1ldGVyKCJzZWNyZXRzIGRhdGFiYXNlIiwg
InNlY3JldHMubGRiIiwgTlVMTCk7DQpJbmRleDogYXV0aC9hdXRoLmMNCj09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCi0t
LSBhdXRoL2F1dGguYwkocmV2aXNpb24gMjI2MTApDQorKysgYXV0aC9hdXRoLmMJKHdvcmtpbmcg
Y29weSkNCkBAIC0zNDgsMTEgKzM0OCwxMiBAQA0KIA0KIC8qKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCiAg
TWFrZSBhIGF1dGhfaW5mbyBzdHJ1Y3QgZm9yIHRoZSBhdXRoIHN1YnN5c3RlbQ0KKyAtIEFsbG93
IHRoZSBjYWxsZXIgdG8gc3BlY2lmeSB0aGUgbWV0aG9kcyB0byB1c2UNCiAqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKiovDQotTlRTVEFUVVMgYXV0aF9jb250ZXh0X2NyZWF0ZShUQUxMT0NfQ1RYICptZW1fY3R4
LCBjb25zdCBjaGFyICoqbWV0aG9kcywgDQotCQkJICAgICBzdHJ1Y3QgZXZlbnRfY29udGV4dCAq
ZXYsDQotCQkJICAgICBzdHJ1Y3QgbWVzc2FnaW5nX2NvbnRleHQgKm1zZywNCi0JCQkgICAgIHN0
cnVjdCBhdXRoX2NvbnRleHQgKiphdXRoX2N0eCkNCitOVFNUQVRVUyBhdXRoX2NvbnRleHRfY3Jl
YXRlX21ldGhvZHMoVEFMTE9DX0NUWCAqbWVtX2N0eCwgY29uc3QgY2hhciAqKm1ldGhvZHMsIA0K
KwkJCQkgICAgIHN0cnVjdCBldmVudF9jb250ZXh0ICpldiwNCisJCQkJICAgICBzdHJ1Y3QgbWVz
c2FnaW5nX2NvbnRleHQgKm1zZywNCisJCQkJICAgICBzdHJ1Y3QgYXV0aF9jb250ZXh0ICoqYXV0
aF9jdHgpDQogew0KIAlpbnQgaTsNCiAJc3RydWN0IGF1dGhfY29udGV4dCAqY3R4Ow0KQEAgLTQw
Niw3ICs0MDcsMzEgQEANCiANCiAJcmV0dXJuIE5UX1NUQVRVU19PSzsNCiB9DQorLyoqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKg0KKyBNYWtlIGEgYXV0aF9pbmZvIHN0cnVjdCBmb3IgdGhlIGF1dGggc3Vic3lz
dGVtDQorIC0gVXNlcyBkZWZhdWx0IGF1dGhfbWV0aG9kcywgZGVwZW5kaW5nIG9uIHNlcnZlciBy
b2xlIGFuZCBzbWIuY29uZiBzZXR0aW5ncw0KKyoqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8NCitOVFNUQVRV
UyBhdXRoX2NvbnRleHRfY3JlYXRlKFRBTExPQ19DVFggKm1lbV9jdHgsIA0KKwkJCSAgICAgc3Ry
dWN0IGV2ZW50X2NvbnRleHQgKmV2LA0KKwkJCSAgICAgc3RydWN0IG1lc3NhZ2luZ19jb250ZXh0
ICptc2csDQorCQkJICAgICBzdHJ1Y3QgYXV0aF9jb250ZXh0ICoqYXV0aF9jdHgpDQorew0KKwlj
b25zdCBjaGFyICoqYXV0aF9tZXRob2RzID0gTlVMTDsNCisJc3dpdGNoIChscF9zZXJ2ZXJfcm9s
ZSgpKSB7DQorCWNhc2UgUk9MRV9TVEFOREFMT05FOg0KKwkJYXV0aF9tZXRob2RzID0gbHBfcGFy
bV9zdHJpbmdfbGlzdCgtMSwgImF1dGggbWV0aG9kcyIsICJzdGFuZGFsb25lIiwgTlVMTCk7DQor
CQlicmVhazsNCisJY2FzZSBST0xFX0RPTUFJTl9NRU1CRVI6DQorCQlhdXRoX21ldGhvZHMgPSBs
cF9wYXJtX3N0cmluZ19saXN0KC0xLCAiYXV0aCBtZXRob2RzIiwgIm1lbWJlciBzZXJ2ZXIiLCBO
VUxMKTsNCisJCWJyZWFrOw0KKwljYXNlIFJPTEVfRE9NQUlOX0NPTlRST0xMRVI6DQorCQlhdXRo
X21ldGhvZHMgPSBscF9wYXJtX3N0cmluZ19saXN0KC0xLCAiYXV0aCBtZXRob2RzIiwgImRvbWFp
biBjb250cm9sbGVyIiwgTlVMTCk7DQorCQlicmVhazsNCisJfQ0KKwlyZXR1cm4gYXV0aF9jb250
ZXh0X2NyZWF0ZV9tZXRob2RzKG1lbV9jdHgsIGF1dGhfbWV0aG9kcywgZXYsIG1zZywgYXV0aF9j
dHgpOw0KK30NCiANCisNCiAvKiB0aGUgbGlzdCBvZiBjdXJyZW50bHkgcmVnaXN0ZXJlZCBBVVRI
IGJhY2tlbmRzICovDQogc3RhdGljIHN0cnVjdCBhdXRoX2JhY2tlbmQgew0KIAljb25zdCBzdHJ1
Y3QgYXV0aF9vcGVyYXRpb25zICpvcHM7DQpJbmRleDogYXV0aC9hdXRoX3NpbXBsZS5jDQo9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09DQotLS0gYXV0aC9hdXRoX3NpbXBsZS5jCShyZXZpc2lvbiAyMjYxMCkNCisrKyBhdXRo
L2F1dGhfc2ltcGxlLmMJKHdvcmtpbmcgY29weSkNCkBAIC00OCw3ICs0OCw3IEBADQogCQlyZXR1
cm4gTlRfU1RBVFVTX05PX01FTU9SWTsNCiAJfQ0KIA0KLQludF9zdGF0dXMgPSBhdXRoX2NvbnRl
eHRfY3JlYXRlKHRtcF9jdHgsIGxwX2F1dGhfbWV0aG9kcygpLA0KKwludF9zdGF0dXMgPSBhdXRo
X2NvbnRleHRfY3JlYXRlKHRtcF9jdHgsIA0KIAkJCQkJZXYsIG1zZywNCiAJCQkJCSZhdXRoX2Nv
bnRleHQpOw0KIAlpZiAoIU5UX1NUQVRVU19JU19PSyhudF9zdGF0dXMpKSB7DQpJbmRleDogYXV0
aC9udGxtc3NwL250bG1zc3Bfc2VydmVyLmMNCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCi0tLSBhdXRoL250bG1zc3Av
bnRsbXNzcF9zZXJ2ZXIuYwkocmV2aXNpb24gMjI2MTApDQorKysgYXV0aC9udGxtc3NwL250bG1z
c3Bfc2VydmVyLmMJKHdvcmtpbmcgY29weSkNCkBAIC04MzUsNyArODM1LDcgQEANCiAJCWdlbnNl
Y19udGxtc3NwX3N0YXRlLT5uZWdfZmxhZ3MgfD0gTlRMTVNTUF9ORUdPVElBVEVfU0VBTDsNCiAJ
fQ0KIA0KLQludF9zdGF0dXMgPSBhdXRoX2NvbnRleHRfY3JlYXRlKGdlbnNlY19udGxtc3NwX3N0
YXRlLCBscF9hdXRoX21ldGhvZHMoKSwgDQorCW50X3N0YXR1cyA9IGF1dGhfY29udGV4dF9jcmVh
dGUoZ2Vuc2VjX250bG1zc3Bfc3RhdGUsIA0KIAkJCQkJZ2Vuc2VjX3NlY3VyaXR5LT5ldmVudF9j
dHgsDQogCQkJCQlnZW5zZWNfc2VjdXJpdHktPm1zZ19jdHgsDQogCQkJCQkmZ2Vuc2VjX250bG1z
c3Bfc3RhdGUtPmF1dGhfY29udGV4dCk7DQpJbmRleDogc2NyaXB0aW5nL2Vqcy9zbWJjYWxsc19s
ZGIuYw0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PQ0KLS0tIHNjcmlwdGluZy9lanMvc21iY2FsbHNfbGRiLmMJKHJldmlz
aW9uIDIyNjEwKQ0KKysrIHNjcmlwdGluZy9lanMvc21iY2FsbHNfbGRiLmMJKHdvcmtpbmcgY29w
eSkNCkBAIC0xNTAsOSArMTUwLDkgQEANCiANCiAJaWYgKHJldCAhPSBMREJfU1VDQ0VTUykgew0K
IAkJZWpzU2V0RXJyb3JNc2coZWlkLCAibGRiLnNlYXJjaCBmYWlsZWQgLSAlcyIsIGxkYl9lcnJz
dHJpbmcobGRiKSk7DQotCQltcHJfUmV0dXJuKGVpZCwgbXByTGRiUmVzdWx0KGxkYiwgcmV0LCBO
VUxMKSk7DQorCQltcHJfUmV0dXJuKGVpZCwgbXByTGRiUmVzdWx0KGxkYiwgcmV0LCBiYXNlZG4s
IE5VTEwpKTsNCiAJfSBlbHNlIHsNCi0JCW1wcl9SZXR1cm4oZWlkLCBtcHJMZGJSZXN1bHQobGRi
LCByZXQsIHJlcykpOw0KKwkJbXByX1JldHVybihlaWQsIG1wckxkYlJlc3VsdChsZGIsIHJldCwg
TlVMTCwgcmVzKSk7DQogCX0NCiANCiAJdGFsbG9jX2ZyZWUodG1wX2N0eCk7DQpAQCAtMTk0LDgg
KzE5NCwxMiBAQA0KIAl3aGlsZSAoKGxkaWYgPSBsZGJfbGRpZl9yZWFkX3N0cmluZyhsZGIsICZs
ZGlmc3RyaW5nKSkpIHsNCiAJCWNvdW50Kys7DQogCQlyZXQgPSBmbihsZGIsIGxkaWYtPm1zZyk7
DQorCQlpZiAocmV0ICE9IDApIHsNCisJCQltcHJfUmV0dXJuKGVpZCwgbXByTGRiUmVzdWx0KGxk
YiwgcmV0LCBsZGlmLT5tc2ctPmRuLCBOVUxMKSk7DQorCQkJdGFsbG9jX2ZyZWUobGRpZik7DQor
CQkJcmV0dXJuIDA7DQorCQl9DQogCQl0YWxsb2NfZnJlZShsZGlmKTsNCi0JCWlmIChyZXQgIT0g
MCkgYnJlYWs7DQogCX0NCiANCiAJaWYgKGNvdW50ID09IDApIHsNCkBAIC0yMDMsNyArMjA3LDcg
QEANCiAJCXJldHVybiAtMTsNCiAJfQ0KIA0KLQltcHJfUmV0dXJuKGVpZCwgbXByTGRiUmVzdWx0
KGxkYiwgcmV0LCBOVUxMKSk7DQorCW1wcl9SZXR1cm4oZWlkLCBtcHJMZGJSZXN1bHQobGRiLCBy
ZXQsIE5VTEwsIE5VTEwpKTsNCiAJcmV0dXJuIDA7DQogfQ0KIA0KQEAgLTIzOSw3ICsyNDMsNyBA
QA0KIA0KIAl0YWxsb2NfZnJlZShkbik7DQogDQotCW1wcl9SZXR1cm4oZWlkLCBtcHJMZGJSZXN1
bHQobGRiLCByZXQsIE5VTEwpKTsNCisJbXByX1JldHVybihlaWQsIG1wckxkYlJlc3VsdChsZGIs
IHJldCwgZG4sIE5VTEwpKTsNCiAJcmV0dXJuIDA7DQogfQ0KIA0KQEAgLTI3Niw3ICsyODAsNyBA
QA0KIAl0YWxsb2NfZnJlZShkbjEpOw0KIAl0YWxsb2NfZnJlZShkbjIpOw0KIA0KLQltcHJfUmV0
dXJuKGVpZCwgbXByTGRiUmVzdWx0KGxkYiwgcmV0LCBOVUxMKSk7DQorCW1wcl9SZXR1cm4oZWlk
LCBtcHJMZGJSZXN1bHQobGRiLCByZXQsIGRuMSwgTlVMTCkpOw0KIAlyZXR1cm4gMDsNCiB9DQog
DQpJbmRleDogc2NyaXB0aW5nL2Vqcy9zbWJjYWxsc19hdXRoLmMNCj09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCi0tLSBz
Y3JpcHRpbmcvZWpzL3NtYmNhbGxzX2F1dGguYwkocmV2aXNpb24gMjI2MTApDQorKysgc2NyaXB0
aW5nL2Vqcy9zbWJjYWxsc19hdXRoLmMJKHdvcmtpbmcgY29weSkNCkBAIC01Niw3ICs1NiwxMSBA
QA0KIAkJbXNnID0gbWVzc2FnaW5nX2NsaWVudF9pbml0KHRtcF9jdHgsIGV2KTsNCiAJfQ0KIA0K
LQludF9zdGF0dXMgPSBhdXRoX2NvbnRleHRfY3JlYXRlKHRtcF9jdHgsIGF1dGhfdHlwZXMsIGV2
LCBtc2csICZhdXRoX2NvbnRleHQpOw0KKwlpZiAoYXV0aF90eXBlcykgew0KKwkJbnRfc3RhdHVz
ID0gYXV0aF9jb250ZXh0X2NyZWF0ZV9tZXRob2RzKHRtcF9jdHgsIGF1dGhfdHlwZXMsIGV2LCBt
c2csICZhdXRoX2NvbnRleHQpOw0KKwl9IGVsc2Ugew0KKwkJbnRfc3RhdHVzID0gYXV0aF9jb250
ZXh0X2NyZWF0ZSh0bXBfY3R4LCBldiwgbXNnLCAmYXV0aF9jb250ZXh0KTsNCisJfQ0KIAlpZiAo
IU5UX1NUQVRVU19JU19PSyhudF9zdGF0dXMpKSB7DQogCQltcHJTZXRQcm9wZXJ0eVZhbHVlKGF1
dGgsICJyZXN1bHQiLCBtcHJDcmVhdGVCb29sVmFyKEZhbHNlKSk7DQogCQltcHJTZXRQcm9wZXJ0
eVZhbHVlKGF1dGgsICJyZXBvcnQiLCBtcHJTdHJpbmcoIkF1dGggU3lzdGVtIEZhaWx1cmUiKSk7
DQpAQCAtMTc0LDcgKzE3OCw3IEBADQogCWlmIChkb21haW4gJiYgKHN0cmNtcCgiU1lTVEVNIFVT
RVIiLCBkb21haW4pID09IDApKSB7DQogCQllanNfZG9hdXRoKGVpZCwgdG1wX2N0eCwgJmF1dGgs
IHVzZXJuYW1lLCBwYXNzd29yZCwgZG9tYWluLCB3b3Jrc3RhdGlvbiwgcmVtb3RlX2hvc3QsIGF1
dGhfdHlwZXNfdW5peCk7DQogCX0gZWxzZSB7DQotCQllanNfZG9hdXRoKGVpZCwgdG1wX2N0eCwg
JmF1dGgsIHVzZXJuYW1lLCBwYXNzd29yZCwgZG9tYWluLCB3b3Jrc3RhdGlvbiwgcmVtb3RlX2hv
c3QsIGxwX2F1dGhfbWV0aG9kcygpKTsNCisJCWVqc19kb2F1dGgoZWlkLCB0bXBfY3R4LCAmYXV0
aCwgdXNlcm5hbWUsIHBhc3N3b3JkLCBkb21haW4sIHdvcmtzdGF0aW9uLCByZW1vdGVfaG9zdCwg
TlVMTCk7DQogCX0NCiANCiAJbXByX1JldHVybihlaWQsIGF1dGgpOw0KSW5kZXg6IHNjcmlwdGlu
Zy9lanMvbXBydXRpbC5jDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09DQotLS0gc2NyaXB0aW5nL2Vqcy9tcHJ1dGlsLmMJ
KHJldmlzaW9uIDIyNjEwKQ0KKysrIHNjcmlwdGluZy9lanMvbXBydXRpbC5jCSh3b3JraW5nIGNv
cHkpDQpAQCAtMjI1LDE1ICsyMjUsMTggQEANCiAvKg0KICAgYnVpbGQgYSBNcHJWYXIgcmVzdWx0
IG9iamVjdCBmb3IgbGRiIG9wZXJhdGlvbnMgd2l0aCBsb3RzIG9mIGZ1bmt5IHByb3BlcnRpZXMN
CiAqLw0KLXN0cnVjdCBNcHJWYXIgbXByTGRiUmVzdWx0KHN0cnVjdCBsZGJfY29udGV4dCAqbGRi
LCBpbnQgZXJyLCBzdHJ1Y3QgbGRiX3Jlc3VsdCAqcmVzdWx0KQ0KK3N0cnVjdCBNcHJWYXIgbXBy
TGRiUmVzdWx0KHN0cnVjdCBsZGJfY29udGV4dCAqbGRiLCBpbnQgZXJyLCBzdHJ1Y3QgbGRiX2Ru
ICpkbiwgDQorCQkJICAgc3RydWN0IGxkYl9yZXN1bHQgKnJlc3VsdCkNCiB7DQogCXN0cnVjdCBN
cHJWYXIgcmV0Ow0KIAlzdHJ1Y3QgTXByVmFyIGFyeTsNCi0NCisJY2hhciAqZXJyb3Jfc3RyaW5n
ID0gdGFsbG9jX2FzcHJpbnRmKG1wck1lbUN0eCgpLCAiJXM6ICVzIiwNCisJCQkJCSAgICAgbGRi
X2RuX2dldF9saW5lYXJpemVkKGRuKSwgbGRiX2VycnN0cmluZyhsZGIpKTsNCisJDQogCXJldCA9
IG1wck9iamVjdCgibGRicmV0Iik7DQogDQogCW1wclNldFZhcigmcmV0LCAiZXJyb3IiLCBtcHJD
cmVhdGVJbnRlZ2VyVmFyKGVycikpOw0KLQltcHJTZXRWYXIoJnJldCwgImVycnN0ciIsIG1wclN0
cmluZyhsZGJfZXJyc3RyaW5nKGxkYikpKTsNCisJbXByU2V0VmFyKCZyZXQsICJlcnJzdHIiLCBt
cHJDcmVhdGVTdHJpbmdWYXIoZXJyb3Jfc3RyaW5nLCBGYWxzZSkpOw0KIA0KIAlhcnkgPSBtcHJB
cnJheSgibGRiX21lc3NhZ2UiKTsNCiAJaWYgKHJlc3VsdCkgew0KSW5kZXg6IGxpYi9sZGIvaW5j
bHVkZS9sZGIuaA0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PQ0KLS0tIGxpYi9sZGIvaW5jbHVkZS9sZGIuaAkocmV2aXNp
b24gMjI2MTApDQorKysgbGliL2xkYi9pbmNsdWRlL2xkYi5oCSh3b3JraW5nIGNvcHkpDQpAQCAt
MTUwMSw2ICsxNTAxLDkgQEANCiBpbnQgbGRiX21zZ19hZGRfZm10KHN0cnVjdCBsZGJfbWVzc2Fn
ZSAqbXNnLCANCiAJCSAgICBjb25zdCBjaGFyICphdHRyX25hbWUsIGNvbnN0IGNoYXIgKmZtdCwg
Li4uKSBQUklOVEZfQVRUUklCVVRFKDMsNCk7DQogDQoraW50IGxkYl9tc2dfcmVtb3ZlX3ZhbHVl
KHN0cnVjdCBsZGJfbWVzc2FnZSAqbXNnLCANCisJCQkgY29uc3QgY2hhciAqYXR0cl9uYW1lLA0K
KwkJCSBjb25zdCBzdHJ1Y3QgbGRiX3ZhbCAqdmFsKTsNCiAvKioNCiAgICBjb21wYXJlIHR3byBt
ZXNzYWdlIGVsZW1lbnRzIC0gcmV0dXJuIDAgb24gbWF0Y2gNCiAqLw0KSW5kZXg6IHNtYl9zZXJ2
ZXIvc21iL25lZ3Byb3QuYw0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KLS0tIHNtYl9zZXJ2ZXIvc21iL25lZ3Byb3Qu
YwkocmV2aXNpb24gMjI2MTApDQorKysgc21iX3NlcnZlci9zbWIvbmVncHJvdC5jCSh3b3JraW5n
IGNvcHkpDQpAQCAtNDQsNyArNDQsNyBAQA0KIA0KIAlERUJVRygxMCwgKCJnZXQgY2hhbGxlbmdl
OiBjcmVhdGluZyBuZWdwcm90X2dsb2JhbF9hdXRoX2NvbnRleHRcbiIpKTsNCiANCi0JbnRfc3Rh
dHVzID0gYXV0aF9jb250ZXh0X2NyZWF0ZShzbWJfY29ubiwgbHBfYXV0aF9tZXRob2RzKCksIA0K
KwludF9zdGF0dXMgPSBhdXRoX2NvbnRleHRfY3JlYXRlKHNtYl9jb25uLCANCiAJCQkJCXNtYl9j
b25uLT5jb25uZWN0aW9uLT5ldmVudC5jdHgsDQogCQkJCQlzbWJfY29ubi0+Y29ubmVjdGlvbi0+
bXNnX2N0eCwNCiAJCQkJCSZzbWJfY29ubi0+bmVnb3RpYXRlLmF1dGhfY29udGV4dCk7DQpJbmRl
eDogc21iX3NlcnZlci9zbWIvc2Vzc3NldHVwLmMNCj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCi0tLSBzbWJfc2VydmVy
L3NtYi9zZXNzc2V0dXAuYwkocmV2aXNpb24gMjI2MTApDQorKysgc21iX3NlcnZlci9zbWIvc2Vz
c3NldHVwLmMJKHdvcmtpbmcgY29weSkNCkBAIC0yNDEsNyArMjQxLDcgQEANCiAJCX0NCiANCiAJ
CS8qIFRPRE86IHNob3VsZCB3ZSB1c2UganVzdCAiYW5vbnltb3VzIiBoZXJlPyAqLw0KLQkJc3Rh
dHVzID0gYXV0aF9jb250ZXh0X2NyZWF0ZShyZXEsIGxwX2F1dGhfbWV0aG9kcygpLCANCisJCXN0
YXR1cyA9IGF1dGhfY29udGV4dF9jcmVhdGUocmVxLCANCiAJCQkJCSAgICAgcmVxLT5zbWJfY29u
bi0+Y29ubmVjdGlvbi0+ZXZlbnQuY3R4LA0KIAkJCQkJICAgICByZXEtPnNtYl9jb25uLT5jb25u
ZWN0aW9uLT5tc2dfY3R4LA0KIAkJCQkJICAgICAmYXV0aF9jb250ZXh0KTsNCkluZGV4OiBycGNf
c2VydmVyL25ldGxvZ29uL2RjZXJwY19uZXRsb2dvbi5jDQo9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQotLS0gcnBjX3Nl
cnZlci9uZXRsb2dvbi9kY2VycGNfbmV0bG9nb24uYwkocmV2aXNpb24gMjI2MTApDQorKysgcnBj
X3NlcnZlci9uZXRsb2dvbi9kY2VycGNfbmV0bG9nb24uYwkod29ya2luZyBjb3B5KQ0KQEAgLTQz
MSw3ICs0MzEsNyBAQA0KIAkJfQ0KIA0KIAkJLyogVE9ETzogd2UgbmVlZCB0byBkZW55IGFub255
bW91cyBhY2Nlc3MgaGVyZSAqLw0KLQkJbnRfc3RhdHVzID0gYXV0aF9jb250ZXh0X2NyZWF0ZSht
ZW1fY3R4LCBscF9hdXRoX21ldGhvZHMoKSwNCisJCW50X3N0YXR1cyA9IGF1dGhfY29udGV4dF9j
cmVhdGUobWVtX2N0eCwgDQogCQkJCQkJZGNlX2NhbGwtPmV2ZW50X2N0eCwgZGNlX2NhbGwtPm1z
Z19jdHgsDQogCQkJCQkJJmF1dGhfY29udGV4dCk7DQogCQlOVF9TVEFUVVNfTk9UX09LX1JFVFVS
TihudF9zdGF0dXMpOw0KQEAgLTQ1Nyw3ICs0NTcsNyBAQA0KIAljYXNlIDY6DQogDQogCQkvKiBU
T0RPOiB3ZSBuZWVkIHRvIGRlbnkgYW5vbnltb3VzIGFjY2VzcyBoZXJlICovDQotCQludF9zdGF0
dXMgPSBhdXRoX2NvbnRleHRfY3JlYXRlKG1lbV9jdHgsIGxwX2F1dGhfbWV0aG9kcygpLA0KKwkJ
bnRfc3RhdHVzID0gYXV0aF9jb250ZXh0X2NyZWF0ZShtZW1fY3R4LCANCiAJCQkJCQlkY2VfY2Fs
bC0+ZXZlbnRfY3R4LCBkY2VfY2FsbC0+bXNnX2N0eCwNCiAJCQkJCQkmYXV0aF9jb250ZXh0KTsN
CiAJCU5UX1NUQVRVU19OT1RfT0tfUkVUVVJOKG50X3N0YXR1cyk7DQo=


--=-viUGsSpyTmeE/vtvcuQ1--

--=-twZ2Xex/SRTm+ld88wiY
Content-Type: application/pgp-signature; name=signature.asc
Content-Description: This is a digitally signed message part

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (GNU/Linux)

iD8DBQBGNjR8z4A8Wyi0NrsRAixwAKCHEc0X8fxqOhXmXkZVYnbIQthJkwCePklN
2+bz5+7U402ZXtw9lU7Ljlg=
=QZd8
-----END PGP SIGNATURE-----

--=-twZ2Xex/SRTm+ld88wiY--

