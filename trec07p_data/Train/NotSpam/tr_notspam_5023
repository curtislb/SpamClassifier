From r-help-bounces@stat.math.ethz.ch  Wed Apr 25 15:55:09 2007
Return-Path: <r-help-bounces@stat.math.ethz.ch>
Received: from hypatia.math.ethz.ch (hypatia.math.ethz.ch [129.132.145.15])
	by speedy.uwaterloo.ca (8.12.8/8.12.5) with ESMTP id l3PJt76w002393
	for <ktwarwic@speedy.uwaterloo.ca>; Wed, 25 Apr 2007 15:55:08 -0400
Received: from hypatia.math.ethz.ch (hypatia [129.132.145.15])
	by hypatia.math.ethz.ch (8.13.6/8.13.6) with ESMTP id l3PJrMIi013161;
	Wed, 25 Apr 2007 21:54:03 +0200
X-Spam-Checker-Version: SpamAssassin 3.1.8 (2007-02-13) on hypatia.math.ethz.ch
X-Spam-Level: 
X-Spam-Status: No, score=-1.0 required=5.0 tests=AWL,
	BAYES_50 autolearn=no version=3.1.8
Received: from tango.stat.unipd.it (tango.stat.unipd.it [147.162.23.130])
	by hypatia.math.ethz.ch (8.13.6/8.13.6) with ESMTP id l3PJr1IP012934
	for <r-help@stat.math.ethz.ch>; Wed, 25 Apr 2007 21:53:01 +0200
Received: by tango.stat.unipd.it (Postfix, from userid 1000)
	id 34C1614E21E; Wed, 25 Apr 2007 21:49:59 +0200 (CEST)
Date: Wed, 25 Apr 2007 21:49:59 +0200
To: Daniel Elliott <danelliottster@gmail.com>
Message-ID: <20070425194959.GA11126@tango.stat.unipd.it>
References: <f08455590704251121l78f98bbcue5ff4cc1c103d8e6@mail.gmail.com>
	<f08455590704251125s60c31382u559841c34cdaacaa@mail.gmail.com>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <f08455590704251125s60c31382u559841c34cdaacaa@mail.gmail.com>
User-Agent: Mutt/1.5.13 (2006-08-11)
From: aa@tango.stat.unipd.it (Adelchi Azzalini)
X-Virus-Scanned: by amavisd-new at stat.math.ethz.ch
Cc: r-help@stat.math.ethz.ch
Subject: Re: [R] Fwd: dmnorm not meant for 1024-dimensional data?
X-BeenThere: r-help@stat.math.ethz.ch
X-Mailman-Version: 2.1.9
Precedence: list
Reply-To: azzalini@stat.unipd.it
List-Id: "Main R Mailing List: Primary help" <r-help.stat.math.ethz.ch>
List-Unsubscribe: <https://stat.ethz.ch/mailman/listinfo/r-help>,
	<mailto:r-help-request@stat.math.ethz.ch?subject=unsubscribe>
List-Archive: <https://stat.ethz.ch/pipermail/r-help>
List-Post: <mailto:r-help@stat.math.ethz.ch>
List-Help: <mailto:r-help-request@stat.math.ethz.ch?subject=help>
List-Subscribe: <https://stat.ethz.ch/mailman/listinfo/r-help>,
	<mailto:r-help-request@stat.math.ethz.ch?subject=subscribe>
Content-Type: text/plain; charset="iso-8859-1"
Sender: r-help-bounces@stat.math.ethz.ch
Errors-To: r-help-bounces@stat.math.ethz.ch
Content-Transfer-Encoding: 8bit
X-MIME-Autoconverted: from quoted-printable to 8bit by speedy.uwaterloo.ca id l3PJt76w002393
Status: O
Content-Length: 2379
Lines: 77

On Wed, Apr 25, 2007 at 01:25:09PM -0500, Daniel Elliott wrote:
> Hello.  Thank you for your mnormt package.  Below is an email I sent to
> R-help regarding the function dmnorm.
> 
> Any help you can provide would be greatly appreciated.
> 

Hello.

You have not provided information on what specifically you 
have tried as for parameters and evaluation points, so I have
chosen a particularly simple case, namely the 1024-dimensional
density with independent standard marginals, using this code

d<- 1024
x <- 1
const<- 0.5*log(2*pi)
log.pdf <-0
for (i in 1:d)   log.pdf <- log.pdf - x^2/2 -const
#
S <- diag(d)
mu<- rep(0,d)
X <- rep(x,d)
log.pdf2 <- dmnorm(X,mu,S, log=TRUE)
cat(log.pdf, log.pdf2, abs(log.pdf-log.pdf2),"\n")

and the outcome was this one:
  -1453 -1453 2.137e-11 
which seems quite decent to me. Obviously, you must not take exp()
of this log-density, as otherwise a 0 is indeed produced, but 
the reason is not in the package, rather in the possibility of
representing that number using standard floating-point
numerical devices.

best regards,

Adelchi Azzalini


> Thank you.
> 
> - dan elliott
> 
> ---------- Forwarded message ----------
> From: Daniel Elliott <danelliottster@gmail.com>
> Date: Apr 25, 2007 1:21 PM
> Subject: dmnorm not meant for 1024-dimensional data?
> To: r-help@stat.math.ethz.ch
> 
> Hello,
> 
> I have some data generated by a simple mixture of Gaussians (more like
> K-means) and (as a test) am using dmnorm to calculate the probability
> of each data point coming from each Gaussian.  However, I get only
> zero probabilities.
> 
> This code works in low dimensions (tried 2 and 3 already).  I have run
> into many implementations that do not work in high dimension, but I
> thought that I was safe with dmnorm because it has an option to
> compute the log of the probability.
> 
> So, is dmnorm not intended to be used with data of such high dimensionality?
> 
> Thank you,
> 
> dan elliott

-- 
Adelchi Azzalini  <azzalini@stat.unipd.it>
Dipart.Scienze Statistiche, Università di Padova, Italia
tel. +39 049 8274147,  http://azzalini.stat.unipd.it/

______________________________________________
R-help@stat.math.ethz.ch mailing list
https://stat.ethz.ch/mailman/listinfo/r-help
PLEASE do read the posting guide http://www.R-project.org/posting-guide.html
and provide commented, minimal, self-contained, reproducible code.

