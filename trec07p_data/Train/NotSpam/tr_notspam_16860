From samba-technical-bounces+ktwarwic=speedy.uwaterloo.ca@lists.samba.org  Wed Jun  6 08:09:41 2007
Return-Path: <samba-technical-bounces+ktwarwic=speedy.uwaterloo.ca@lists.samba.org>
Received: from lists.samba.org (mail.samba.org [66.70.73.150])
	by flax9.uwaterloo.ca (8.12.8/8.12.5) with ESMTP id l56C9ehB021153
	for <ktwarwic@speedy.uwaterloo.ca>; Wed, 6 Jun 2007 08:09:40 -0400
Received: from dp.samba.org (localhost [127.0.0.1])
	by lists.samba.org (Postfix) with ESMTP id 705231638B5
	for <ktwarwic@speedy.uwaterloo.ca>; Wed,  6 Jun 2007 12:09:34 +0000 (GMT)
X-Spam-Checker-Version: SpamAssassin 3.1.7 (2006-10-05) on dp.samba.org
X-Spam-Level: 
X-Spam-Status: No, score=-0.3 required=3.8 tests=AWL,BAYES_00,
	FORGED_RCVD_HELO,RCVD_IN_BLARS_RBL,RCVD_IN_SORBS_DUL,SPF_NEUTRAL 
	autolearn=no version=3.1.7
X-Original-To: samba-technical@lists.samba.org
Delivered-To: samba-technical@lists.samba.org
Received: from mail.plainjoe.org (68-117-186-136.dhcp.mtgm.al.charter.com
	[68.117.186.136])
	by lists.samba.org (Postfix) with ESMTP id 58C18162BC9;
	Wed,  6 Jun 2007 12:08:49 +0000 (GMT)
Received: from [192.168.1.47] (oak.plainjoe.org [192.168.1.47])
	by mail.plainjoe.org (Postfix) with ESMTP id D131D2F1FE;
	Wed,  6 Jun 2007 07:08:48 -0500 (CDT)
Message-ID: <4666A3D3.5070009@samba.org>
Date: Wed, 06 Jun 2007 07:08:51 -0500
From: "Gerald (Jerry) Carter" <jerry@samba.org>
User-Agent: Thunderbird 1.5.0.10 (X11/20070403)
MIME-Version: 1.0
To: tridge@samba.org
References: <D4ADD9E4-9613-466E-9618-6DC251575315@samba.org>	<1180906540.24923.198.camel@localhost.localdomain>	<46636B0C.2030202@samba.org>	<1180928372.24923.238.camel@localhost.localdomain>	<089D1CE1-5D21-4711-918B-48E2C36C5D1D@samba.org>	<18021.64361.164851.672386@samba.org>	<5A8F8CFA-D862-4C8D-8134-A88913D85DED@samba.org>	<Pine.LNX.4.64.0706052130040.22014@dolby.south.ad.plainjoe.org>	<18022.10164.545376.678905@samba.org>	<46662AD0.50301@samba.org>
	<18022.12332.550130.866023@samba.org>
In-Reply-To: <18022.12332.550130.866023@samba.org>
X-Enigmail-Version: 0.94.2.0
Content-Type: text/plain; charset=ISO-8859-1
Content-Transfer-Encoding: 7bit
Cc: samba-technical@lists.samba.org
Subject: Re: getting rid of mkproto.sh from Samba3
X-BeenThere: samba-technical@lists.samba.org
X-Mailman-Version: 2.1.5
Precedence: list
List-Id: "Discussions on Samba internals. For general questions please
	subscribe to the list samba@samba.org"
	<samba-technical.lists.samba.org>
List-Unsubscribe: <https://lists.samba.org/mailman/listinfo/samba-technical>, 
	<mailto:samba-technical-request@lists.samba.org?subject=unsubscribe>
List-Archive: <http://lists.samba.org/archive/samba-technical>
List-Post: <mailto:samba-technical@lists.samba.org>
List-Help: <mailto:samba-technical-request@lists.samba.org?subject=help>
List-Subscribe: <https://lists.samba.org/mailman/listinfo/samba-technical>,
	<mailto:samba-technical-request@lists.samba.org?subject=subscribe>
Sender: samba-technical-bounces+ktwarwic=speedy.uwaterloo.ca@lists.samba.org
Errors-To: samba-technical-bounces+ktwarwic=speedy.uwaterloo.ca@lists.samba.org

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

tridge@samba.org wrote:

> discussions like these are really good! We all have 
> things to learn about good coding practices. A lot of what
> I have learnt has come from discussions like these
> within various projects, so don't cut it short just
> because we don't agree.

I'm not tailing off because we disagree.  I just think this
is more in the area of philosophical debates.  Everything
has a tradeoff.  For example, fully autogenerated code
like VB can turn lawyers into programmers (no offense
to lawyers) and yet we would really scoff at the notion
that that VB is a good thing for large, maintainable
projects.

[note to reader, you may skip to the last paragraph now
 and avoid the boring debate...]

Autogenerated headers are like sharp knives.  They can be
use and have their place in some areas.  But they can cause
a lot of damage if used in correctly.  proto.h has caused
a lot of damage in Samba IMO.  It's has led us to the
libbigballofmud.so in the Makefile.  In fact, I would argue,
like James, that it has promoted code duplication and not
code reuse.

The turnover of the developer base on in open source means
that I value maintainable code above convenient or clever
code.  proto.h is convenient and clever, but not maintainable.

A good example of code that is reused all the time is
dlinklist.h.  not one even thinks of using any other
list implementation in Samba.  But a example of code
that everyone always searches for is the name resolution
routines.

And if autogenerated headers are so great, why are tdb.h
and ldb.h checked into the source tree?

Your points about static functions just don't hold any
convincing truth for me.  In fact, autogenerating headers
makes such functions more likely to be placed in the header
as the programmers has to consciously think about what
is placed in the public and private headers.

Here's another example.  Just because a function can
be used from a library even though its not declared in
the header does not mean that you should use it.  There
must be some reason why the author decided not to place
it there.  For example, (ironic that I'm using the MIT
krb5 libs here since I don't hold them up as a model
of great code), krb5_rc_close() is not exported in
krb5.h.  But if I grep the src/lib/krb5/ it's in there.
The function cannot be declared static because it is
used in other files in src/lib/krb5/ but it is certainly
not public.  It's intended to be be called internally when
an application closes the auth context.

You might argue that an tool to autogenerate the headers
could be smart enough to know what to do.  My point is that
once you reach that point, you have to embed so much
information in the tool or source code that you should just
be writing the header yourself.

So in summary, your points are not technical,  only philosphical.
Which is why until I have a replacement system to propose,
it is fruitless to try to get censuses on the philosophical point
of generating proto.h.  Consensus will only be possible when
reviewing specific patches.






cheers, jerry

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org

iD8DBQFGZqPTIR7qMdg1EfYRAndyAKDAh/AETmWs7Hj0juvLIo2k1SRUZQCgg9lJ
jIVCJo0PCUNpjKW4Tklm4Sg=
=Mxfi
-----END PGP SIGNATURE-----

