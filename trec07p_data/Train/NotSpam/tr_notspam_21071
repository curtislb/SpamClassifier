From samba-technical-bounces+ktwarwic=speedy.uwaterloo.ca@lists.samba.org  Wed Jun 20 22:09:11 2007
Return-Path: <samba-technical-bounces+ktwarwic=speedy.uwaterloo.ca@lists.samba.org>
Received: from lists.samba.org (mail.samba.org [66.70.73.150])
	by flax9.uwaterloo.ca (8.12.8/8.12.5) with ESMTP id l5L29AL9017466
	for <ktwarwic@speedy.uwaterloo.ca>; Wed, 20 Jun 2007 22:09:10 -0400
Received: from dp.samba.org (localhost [127.0.0.1])
	by lists.samba.org (Postfix) with ESMTP id A81A81638DA
	for <ktwarwic@speedy.uwaterloo.ca>; Thu, 21 Jun 2007 02:09:08 +0000 (GMT)
X-Spam-Checker-Version: SpamAssassin 3.1.7 (2006-10-05) on dp.samba.org
X-Spam-Level: 
X-Spam-Status: No, score=-2.1 required=3.8 tests=ALL_TRUSTED,AWL,BAYES_00,
	MIME_BASE64_NO_NAME,RCVD_IN_DSBL autolearn=ham version=3.1.7
X-Original-To: samba-technical@samba.org
Delivered-To: samba-technical@samba.org
Received: from localhost.localdomain (localhost [127.0.0.1])
	by lists.samba.org (Postfix) with ESMTP id 9A8D9162AF4
	for <samba-technical@samba.org>; Thu, 21 Jun 2007 02:08:01 +0000 (GMT)
From: Andrew Bartlett <abartlet@samba.org>
To: Multiple recipients of list SAMBA-TECHNICAL <samba-technical@samba.org>
In-Reply-To: <1182345477.8067.3.camel@localhost.localdomain>
References: <1182212093.3538.15.camel@naomi>
	<1182345477.8067.3.camel@localhost.localdomain>
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature";
	boundary="=-kX1bS734ddd7UAY4ZxtJ"
Date: Thu, 21 Jun 2007 12:07:59 +1000
Message-Id: <1182391679.2972.14.camel@localhost.localdomain>
Mime-Version: 1.0
X-Mailer: Evolution 2.6.3 (2.6.3-2.fc5) 
Subject: Re: [SAMBA4] Faster schema loading
X-BeenThere: samba-technical@lists.samba.org
X-Mailman-Version: 2.1.5
Precedence: list
List-Id: "Discussions on Samba internals. For general questions please
	subscribe to the list samba@samba.org"
	<samba-technical.lists.samba.org>
List-Unsubscribe: <https://lists.samba.org/mailman/listinfo/samba-technical>, 
	<mailto:samba-technical-request@lists.samba.org?subject=unsubscribe>
List-Archive: <http://lists.samba.org/archive/samba-technical>
List-Post: <mailto:samba-technical@lists.samba.org>
List-Help: <mailto:samba-technical-request@lists.samba.org?subject=help>
List-Subscribe: <https://lists.samba.org/mailman/listinfo/samba-technical>,
	<mailto:samba-technical-request@lists.samba.org?subject=subscribe>
Sender: samba-technical-bounces+ktwarwic=speedy.uwaterloo.ca@lists.samba.org
Errors-To: samba-technical-bounces+ktwarwic=speedy.uwaterloo.ca@lists.samba.org


--=-kX1bS734ddd7UAY4ZxtJ
Content-Type: multipart/mixed; boundary="=-fVrw6eB8mcrUhg5OgLca"


--=-fVrw6eB8mcrUhg5OgLca
Content-Type: text/plain
Content-Transfer-Encoding: quoted-printable

On Wed, 2007-06-20 at 23:17 +1000, Andrew Bartlett wrote:
> On Tue, 2007-06-19 at 10:14 +1000, Andrew Bartlett wrote:
> > Metze posted me a patch (schema-loading-13.diff), to load the schema at
> > LDB startup, which I hope to use for MMC write support.
> >=20
> > The problem, as metze pointed out, is that it is slow.
> >=20
> > In the attached patch, for which I would like suggestions as to cleaner
> > methods, I now keep a global variable, with the loaded schema.=20
> >=20
> > How should we better control this?  In particular, we only really want
> > to do this for smbd - but what is the best way to tell that we are 'in
> > smbd'?  Likewise, we will at some point need invalidation.
> >=20
> > make quickest times:
> >=20
> > 33sec without
> > 174sec with
> > 39sec with global variable hack
>=20
> I've now extended this to do some good work - we now have correct
> canonisation of objectCategory entries, and I hope the right
> implementation of allowedAttributesEffective.  I'm having trouble
> getting MMC to talk to Samba4 however.

I've got MMC as far as recognising (and editing the description of) the
Samba4 Domain, but I can't see the user's container.=20

I've added a test to verify that we continue to get the order of the
domain objectClass attributes correct (this is what caused MMC to fail
up to this point).=20

It would be very helpful if someone could find out how long ago MMC
broke...

Andrew Bartlett

--=20
Andrew Bartlett                                http://samba.org/~abartlet/
Authentication Developer, Samba Team           http://samba.org
Samba Developer, Red Hat Inc.                  http://redhat.com

--=-fVrw6eB8mcrUhg5OgLca
Content-Description: 
Content-Disposition: attachment; filename="schema-loading-13-abartlet-2.diff "
Content-Transfer-Encoding: base64
Content-Type: text/x-patch; charset=utf-8

SW5kZXg6IHRlc3Rwcm9ncy9lanMvc2FtYmEzc2FtLmpzDQo9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQotLS0gdGVzdHBy
b2dzL2Vqcy9zYW1iYTNzYW0uanMJKHJldmlzaW9uIDIzNTUwKQ0KKysrIHRlc3Rwcm9ncy9lanMv
c2FtYmEzc2FtLmpzCSh3b3JraW5nIGNvcHkpDQpAQCAtMjcwLDcgKzI3MCw3IEBADQogY246IFgN
CiBjb2RlUGFnZTogeA0KIHJldmlzaW9uOiB4DQotb2JqZWN0Q2F0ZWdvcnk6IHgNCitkbnNIb3N0
TmFtZTogeA0KIG5leHRSaWQ6IHkNCiBsYXN0TG9nb246IHgNCiBkZXNjcmlwdGlvbjogeA0KQEAg
LTI4Miw3ICsyODIsNyBAQA0KIGNuOiBZDQogY29kZVBhZ2U6IHgNCiByZXZpc2lvbjogeA0KLW9i
amVjdENhdGVnb3J5OiB5DQorZG5zSG9zdE5hbWU6IHkNCiBuZXh0UmlkOiB5DQogbGFzdExvZ29u
OiB5DQogZGVzY3JpcHRpb246IHgNCkBAIC0yOTIsNyArMjkyLDcgQEANCiBjbjogWg0KIGNvZGVQ
YWdlOiB4DQogcmV2aXNpb246IHkNCi1vYmplY3RDYXRlZ29yeTogeg0KK2Ruc0hvc3ROYW1lOiB6
DQogbmV4dFJpZDogeQ0KIGxhc3RMb2dvbjogeg0KIGRlc2NyaXB0aW9uOiB5DQpAQCAtMzQyLDg2
ICszNDIsODYgQEANCiANCiAJLyogU2VhcmNoIHJlbW90ZSByZWNvcmQgYnkgbG9jYWwgRE4gKi8N
CiAJZG4gPSBzNC5kbigiY249QSIpOw0KLQlhdHRycyA9IG5ldyBBcnJheSgib2JqZWN0Q2F0ZWdv
cnkiLCAibGFzdExvZ29uIik7DQorCWF0dHJzID0gbmV3IEFycmF5KCJkbnNIb3N0TmFtZSIsICJs
YXN0TG9nb24iKTsNCiAJcmVzID0gbGRiLnNlYXJjaCgiIiwgZG4sIGxkYi5TQ09QRV9CQVNFLCBh
dHRycyk7DQogCWFzc2VydChyZXMuZXJyb3IgPT0gMCk7DQogCWFzc2VydChyZXMubXNncy5sZW5n
dGggPT0gMSk7DQogCWFzc2VydChyZXMubXNnc1swXS5kbiA9PSBkbik7DQotCWFzc2VydChyZXMu
bXNnc1swXS5vYmplY3RDYXRlZ29yeSA9PSB1bmRlZmluZWQpOw0KKwlhc3NlcnQocmVzLm1zZ3Nb
MF0uZG5zSG9zdE5hbWUgPT0gdW5kZWZpbmVkKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzBdLmxhc3RM
b2dvbiA9PSAieCIpOw0KIA0KIAkvKiBTZWFyY2ggcmVtb3RlIHJlY29yZCBieSByZW1vdGUgRE4g
Ki8NCiAJZG4gPSBzMy5kbigiY249QSIpOw0KLQlhdHRycyA9IG5ldyBBcnJheSgib2JqZWN0Q2F0
ZWdvcnkiLCAibGFzdExvZ29uIiwgInNhbWJhTG9nb25UaW1lIik7DQorCWF0dHJzID0gbmV3IEFy
cmF5KCJkbnNIb3N0TmFtZSIsICJsYXN0TG9nb24iLCAic2FtYmFMb2dvblRpbWUiKTsNCiAJcmVz
ID0gczMuZGIuc2VhcmNoKCIiLCBkbiwgbGRiLlNDT1BFX0JBU0UsIGF0dHJzKTsNCiAJYXNzZXJ0
KHJlcy5lcnJvciA9PSAwKTsNCiAJYXNzZXJ0KHJlcy5tc2dzLmxlbmd0aCA9PSAxKTsNCiAJYXNz
ZXJ0KHJlcy5tc2dzWzBdLmRuID09IGRuKTsNCi0JYXNzZXJ0KHJlcy5tc2dzWzBdLm9iamVjdENh
dGVnb3J5ID09IHVuZGVmaW5lZCk7DQorCWFzc2VydChyZXMubXNnc1swXS5kbnNIb3N0TmFtZSA9
PSB1bmRlZmluZWQpOw0KIAlhc3NlcnQocmVzLm1zZ3NbMF0ubGFzdExvZ29uID09IHVuZGVmaW5l
ZCk7DQogCWFzc2VydChyZXMubXNnc1swXS5zYW1iYUxvZ29uVGltZSA9PSAieCIpOw0KIA0KIAkv
KiBTZWFyY2ggc3BsaXQgcmVjb3JkIGJ5IGxvY2FsIEROICovDQogCWRuID0gczQuZG4oImNuPVgi
KTsNCi0JYXR0cnMgPSBuZXcgQXJyYXkoIm9iamVjdENhdGVnb3J5IiwgImxhc3RMb2dvbiIpOw0K
KwlhdHRycyA9IG5ldyBBcnJheSgiZG5zSG9zdE5hbWUiLCAibGFzdExvZ29uIik7DQogCXJlcyA9
IGxkYi5zZWFyY2goIiIsIGRuLCBsZGIuU0NPUEVfQkFTRSwgYXR0cnMpOw0KIAlhc3NlcnQocmVz
LmVycm9yID09IDApOw0KIAlhc3NlcnQocmVzLm1zZ3MubGVuZ3RoID09IDEpOw0KIAlhc3NlcnQo
cmVzLm1zZ3NbMF0uZG4gPT0gZG4pOw0KLQlhc3NlcnQocmVzLm1zZ3NbMF0ub2JqZWN0Q2F0ZWdv
cnkgPT0gIngiKTsNCisJYXNzZXJ0KHJlcy5tc2dzWzBdLmRuc0hvc3ROYW1lID09ICJ4Iik7DQog
CWFzc2VydChyZXMubXNnc1swXS5sYXN0TG9nb24gPT0gIngiKTsNCiANCiAJLyogU2VhcmNoIHNw
bGl0IHJlY29yZCBieSByZW1vdGUgRE4gKi8NCiAJZG4gPSBzMy5kbigiY249WCIpOw0KLQlhdHRy
cyA9IG5ldyBBcnJheSgib2JqZWN0Q2F0ZWdvcnkiLCAibGFzdExvZ29uIiwgInNhbWJhTG9nb25U
aW1lIik7DQorCWF0dHJzID0gbmV3IEFycmF5KCJkbnNIb3N0TmFtZSIsICJsYXN0TG9nb24iLCAi
c2FtYmFMb2dvblRpbWUiKTsNCiAJcmVzID0gczMuZGIuc2VhcmNoKCIiLCBkbiwgbGRiLlNDT1BF
X0JBU0UsIGF0dHJzKTsNCiAJYXNzZXJ0KHJlcy5lcnJvciA9PSAwKTsNCiAJYXNzZXJ0KHJlcy5t
c2dzLmxlbmd0aCA9PSAxKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzBdLmRuID09IGRuKTsNCi0JYXNz
ZXJ0KHJlcy5tc2dzWzBdLm9iamVjdENhdGVnb3J5ID09IHVuZGVmaW5lZCk7DQorCWFzc2VydChy
ZXMubXNnc1swXS5kbnNIb3N0TmFtZSA9PSB1bmRlZmluZWQpOw0KIAlhc3NlcnQocmVzLm1zZ3Nb
MF0ubGFzdExvZ29uID09IHVuZGVmaW5lZCk7DQogCWFzc2VydChyZXMubXNnc1swXS5zYW1iYUxv
Z29uVGltZSA9PSAieCIpOw0KIA0KIAlwcmludGxuKCJUZXN0aW5nIHNlYXJjaCBieSBhdHRyaWJ1
dGUiKTsNCiANCiAJLyogU2VhcmNoIGJ5IGlnbm9yZWQgYXR0cmlidXRlICovDQotCWF0dHJzID0g
bmV3IEFycmF5KCJvYmplY3RDYXRlZ29yeSIsICJsYXN0TG9nb24iKTsNCisJYXR0cnMgPSBuZXcg
QXJyYXkoImRuc0hvc3ROYW1lIiwgImxhc3RMb2dvbiIpOw0KIAlyZXMgPSBsZGIuc2VhcmNoKCIo
cmV2aXNpb249eCkiLCBOVUxMLCBsZGIuIFNDT1BFX0RFRkFVTFQsIGF0dHJzKTsNCiAJYXNzZXJ0
KHJlcy5lcnJvciA9PSAwKTsNCiAJYXNzZXJ0KHJlcy5tc2dzLmxlbmd0aCA9PSAyKTsNCiAJYXNz
ZXJ0KHJlcy5tc2dzWzBdLmRuID09IHM0LmRuKCJjbj1ZIikpOw0KLQlhc3NlcnQocmVzLm1zZ3Nb
MF0ub2JqZWN0Q2F0ZWdvcnkgPT0gInkiKTsNCisJYXNzZXJ0KHJlcy5tc2dzWzBdLmRuc0hvc3RO
YW1lID09ICJ5Iik7DQogCWFzc2VydChyZXMubXNnc1swXS5sYXN0TG9nb24gPT0gInkiKTsNCiAJ
YXNzZXJ0KHJlcy5tc2dzWzFdLmRuID09IHM0LmRuKCJjbj1YIikpOw0KLQlhc3NlcnQocmVzLm1z
Z3NbMV0ub2JqZWN0Q2F0ZWdvcnkgPT0gIngiKTsNCisJYXNzZXJ0KHJlcy5tc2dzWzFdLmRuc0hv
c3ROYW1lID09ICJ4Iik7DQogCWFzc2VydChyZXMubXNnc1sxXS5sYXN0TG9nb24gPT0gIngiKTsN
CiANCiAJLyogU2VhcmNoIGJ5IGtlcHQgYXR0cmlidXRlICovDQotCWF0dHJzID0gbmV3IEFycmF5
KCJvYmplY3RDYXRlZ29yeSIsICJsYXN0TG9nb24iKTsNCisJYXR0cnMgPSBuZXcgQXJyYXkoImRu
c0hvc3ROYW1lIiwgImxhc3RMb2dvbiIpOw0KIAlyZXMgPSBsZGIuc2VhcmNoKCIoZGVzY3JpcHRp
b249eSkiLCBOVUxMLCBsZGIuIFNDT1BFX0RFRkFVTFQsIGF0dHJzKTsNCiAJYXNzZXJ0KHJlcy5l
cnJvciA9PSAwKTsNCiAJYXNzZXJ0KHJlcy5tc2dzLmxlbmd0aCA9PSAyKTsNCiAJYXNzZXJ0KHJl
cy5tc2dzWzBdLmRuID09IHM0LmRuKCJjbj1aIikpOw0KLQlhc3NlcnQocmVzLm1zZ3NbMF0ub2Jq
ZWN0Q2F0ZWdvcnkgPT0gInoiKTsNCisJYXNzZXJ0KHJlcy5tc2dzWzBdLmRuc0hvc3ROYW1lID09
ICJ6Iik7DQogCWFzc2VydChyZXMubXNnc1swXS5sYXN0TG9nb24gPT0gInoiKTsNCiAJYXNzZXJ0
KHJlcy5tc2dzWzFdLmRuID09IHM0LmRuKCJjbj1DIikpOw0KLQlhc3NlcnQocmVzLm1zZ3NbMV0u
b2JqZWN0Q2F0ZWdvcnkgPT0gdW5kZWZpbmVkKTsNCisJYXNzZXJ0KHJlcy5tc2dzWzFdLmRuc0hv
c3ROYW1lID09IHVuZGVmaW5lZCk7DQogCWFzc2VydChyZXMubXNnc1sxXS5sYXN0TG9nb24gPT0g
InoiKTsNCiANCiAJLyogU2VhcmNoIGJ5IHJlbmFtZWQgYXR0cmlidXRlICovDQotCWF0dHJzID0g
bmV3IEFycmF5KCJvYmplY3RDYXRlZ29yeSIsICJsYXN0TG9nb24iKTsNCisJYXR0cnMgPSBuZXcg
QXJyYXkoImRuc0hvc3ROYW1lIiwgImxhc3RMb2dvbiIpOw0KIAlyZXMgPSBsZGIuc2VhcmNoKCIo
YmFkUHdkQ291bnQ9eCkiLCBOVUxMLCBsZGIuIFNDT1BFX0RFRkFVTFQsIGF0dHJzKTsNCiAJYXNz
ZXJ0KHJlcy5lcnJvciA9PSAwKTsNCiAJYXNzZXJ0KHJlcy5tc2dzLmxlbmd0aCA9PSAyKTsNCiAJ
YXNzZXJ0KHJlcy5tc2dzWzBdLmRuID09IHM0LmRuKCJjbj1CIikpOw0KLQlhc3NlcnQocmVzLm1z
Z3NbMF0ub2JqZWN0Q2F0ZWdvcnkgPT0gdW5kZWZpbmVkKTsNCisJYXNzZXJ0KHJlcy5tc2dzWzBd
LmRuc0hvc3ROYW1lID09IHVuZGVmaW5lZCk7DQogCWFzc2VydChyZXMubXNnc1swXS5sYXN0TG9n
b24gPT0gInkiKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzFdLmRuID09IHM0LmRuKCJjbj1BIikpOw0K
LQlhc3NlcnQocmVzLm1zZ3NbMV0ub2JqZWN0Q2F0ZWdvcnkgPT0gdW5kZWZpbmVkKTsNCisJYXNz
ZXJ0KHJlcy5tc2dzWzFdLmRuc0hvc3ROYW1lID09IHVuZGVmaW5lZCk7DQogCWFzc2VydChyZXMu
bXNnc1sxXS5sYXN0TG9nb24gPT0gIngiKTsNCiANCiAJLyogU2VhcmNoIGJ5IGNvbnZlcnRlZCBh
dHRyaWJ1dGUgKi8NCi0JYXR0cnMgPSBuZXcgQXJyYXkoIm9iamVjdENhdGVnb3J5IiwgImxhc3RM
b2dvbiIsICJvYmplY3RTaWQiKTsNCisJYXR0cnMgPSBuZXcgQXJyYXkoImRuc0hvc3ROYW1lIiwg
Imxhc3RMb2dvbiIsICJvYmplY3RTaWQiKTsNCiAJLyogVE9ETzoNCiAJICAgVXNpbmcgdGhlIFNJ
RCBkaXJlY3RseSBpbiB0aGUgcGFyc2UgdHJlZSBsZWFkcyB0byBjb252ZXJzaW9uDQogCSAgIGVy
cm9ycywgbGV0dGluZyB0aGUgc2VhcmNoIGZhaWwgd2l0aCBubyByZXN1bHRzLg0KQEAgLTQzMSwy
MyArNDMxLDIzIEBADQogCWFzc2VydChyZXMuZXJyb3IgPT0gMCk7DQogCWFzc2VydChyZXMubXNn
cy5sZW5ndGggPT0gMik7DQogCWFzc2VydChyZXMubXNnc1swXS5kbiA9PSBzNC5kbigiY249WCIp
KTsNCi0JYXNzZXJ0KHJlcy5tc2dzWzBdLm9iamVjdENhdGVnb3J5ID09ICJ4Iik7DQorCWFzc2Vy
dChyZXMubXNnc1swXS5kbnNIb3N0TmFtZSA9PSAieCIpOw0KIAlhc3NlcnQocmVzLm1zZ3NbMF0u
bGFzdExvZ29uID09ICJ4Iik7DQogCWFzc2VydChyZXMubXNnc1swXS5vYmplY3RTaWQgPT0gIlMt
MS01LTIxLTQyMzE2MjY0MjMtMjQxMDAxNDg0OC0yMzYwNjc5NzM5LTU1MiIpOw0KIAlhc3NlcnQo
cmVzLm1zZ3NbMV0uZG4gPT0gczQuZG4oImNuPUEiKSk7DQotCWFzc2VydChyZXMubXNnc1sxXS5v
YmplY3RDYXRlZ29yeSA9PSB1bmRlZmluZWQpOw0KKwlhc3NlcnQocmVzLm1zZ3NbMV0uZG5zSG9z
dE5hbWUgPT0gdW5kZWZpbmVkKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzFdLmxhc3RMb2dvbiA9PSAi
eCIpOw0KIAlhc3NlcnQocmVzLm1zZ3NbMV0ub2JqZWN0U2lkID09ICJTLTEtNS0yMS00MjMxNjI2
NDIzLTI0MTAwMTQ4NDgtMjM2MDY3OTczOS01NTIiKTsNCiANCiAJLyogU2VhcmNoIGJ5IGdlbmVy
YXRlZCBhdHRyaWJ1dGUgKi8NCiAJLyogSW4gbW9zdCBjYXNlcywgdGhpcyBldmVuIHdvcmtzIHdo
ZW4gdGhlIG1hcHBpbmcgaXMgbWlzc2luZw0KIAkgKiBhIGBjb252ZXJ0X29wZXJhdG9yJyBieSBl
bnVtZXJhdGluZyB0aGUgcmVtb3RlIGRiLiAqLw0KLQlhdHRycyA9IG5ldyBBcnJheSgib2JqZWN0
Q2F0ZWdvcnkiLCAibGFzdExvZ29uIiwgInByaW1hcnlHcm91cElEIik7DQorCWF0dHJzID0gbmV3
IEFycmF5KCJkbnNIb3N0TmFtZSIsICJsYXN0TG9nb24iLCAicHJpbWFyeUdyb3VwSUQiKTsNCiAJ
cmVzID0gbGRiLnNlYXJjaCgiKHByaW1hcnlHcm91cElEPTUxMikiLCBOVUxMLCBsZGIuIFNDT1BF
X0RFRkFVTFQsIGF0dHJzKTsNCiAJYXNzZXJ0KHJlcy5lcnJvciA9PSAwKTsNCiAJYXNzZXJ0KHJl
cy5tc2dzLmxlbmd0aCA9PSAxKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzBdLmRuID09IHM0LmRuKCJj
bj1BIikpOw0KLQlhc3NlcnQocmVzLm1zZ3NbMF0ub2JqZWN0Q2F0ZWdvcnkgPT0gdW5kZWZpbmVk
KTsNCisJYXNzZXJ0KHJlcy5tc2dzWzBdLmRuc0hvc3ROYW1lID09IHVuZGVmaW5lZCk7DQogCWFz
c2VydChyZXMubXNnc1swXS5sYXN0TG9nb24gPT0gIngiKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzBd
LnByaW1hcnlHcm91cElEID09ICI1MTIiKTsNCiANCkBAIC00NjgsMjMgKzQ2OCwyMyBAQA0KIAkq
Lw0KIA0KIAkvKiBTZWFyY2ggYnkgcmVtb3RlIG5hbWUgb2YgcmVuYW1lZCBhdHRyaWJ1dGUgKi8N
Ci0JYXR0cnMgPSBuZXcgQXJyYXkoIm9iamVjdENhdGVnb3J5IiwgImxhc3RMb2dvbiIpOw0KKwlh
dHRycyA9IG5ldyBBcnJheSgiZG5zSG9zdE5hbWUiLCAibGFzdExvZ29uIik7DQogCXJlcyA9IGxk
Yi5zZWFyY2goIihzYW1iYUJhZFBhc3N3b3JkQ291bnQ9KikiLCAiIiwgbGRiLiBTQ09QRV9ERUZB
VUxULCBhdHRycyk7DQogCWFzc2VydChyZXMuZXJyb3IgPT0gMCk7DQogCWFzc2VydChyZXMubXNn
cy5sZW5ndGggPT0gMCk7DQogDQogCS8qIFNlYXJjaCBieSBvYmplY3RDbGFzcyAqLw0KLQlhdHRy
cyA9IG5ldyBBcnJheSgib2JqZWN0Q2F0ZWdvcnkiLCAibGFzdExvZ29uIiwgIm9iamVjdENsYXNz
Iik7DQorCWF0dHJzID0gbmV3IEFycmF5KCJkbnNIb3N0TmFtZSIsICJsYXN0TG9nb24iLCAib2Jq
ZWN0Q2xhc3MiKTsNCiAJcmVzID0gbGRiLnNlYXJjaCgiKG9iamVjdENsYXNzPXVzZXIpIiwgTlVM
TCwgbGRiLiBTQ09QRV9ERUZBVUxULCBhdHRycyk7DQogCWFzc2VydChyZXMuZXJyb3IgPT0gMCk7
DQogCWFzc2VydChyZXMubXNncy5sZW5ndGggPT0gMik7DQogCWFzc2VydChyZXMubXNnc1swXS5k
biA9PSBzNC5kbigiY249WCIpKTsNCi0JYXNzZXJ0KHJlcy5tc2dzWzBdLm9iamVjdENhdGVnb3J5
ID09ICJ4Iik7DQorCWFzc2VydChyZXMubXNnc1swXS5kbnNIb3N0TmFtZSA9PSAieCIpOw0KIAlh
c3NlcnQocmVzLm1zZ3NbMF0ubGFzdExvZ29uID09ICJ4Iik7DQogCWFzc2VydChyZXMubXNnc1sw
XS5vYmplY3RDbGFzcyAhPSB1bmRlZmluZWQpOw0KIAlhc3NlcnQocmVzLm1zZ3NbMF0ub2JqZWN0
Q2xhc3NbM10gPT0gInVzZXIiKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzFdLmRuID09IHM0LmRuKCJj
bj1BIikpOw0KLQlhc3NlcnQocmVzLm1zZ3NbMV0ub2JqZWN0Q2F0ZWdvcnkgPT0gdW5kZWZpbmVk
KTsNCisJYXNzZXJ0KHJlcy5tc2dzWzFdLmRuc0hvc3ROYW1lID09IHVuZGVmaW5lZCk7DQogCWFz
c2VydChyZXMubXNnc1sxXS5sYXN0TG9nb24gPT0gIngiKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzFd
Lm9iamVjdENsYXNzICE9IHVuZGVmaW5lZCk7DQogCWFzc2VydChyZXMubXNnc1sxXS5vYmplY3RD
bGFzc1swXSA9PSAidXNlciIpOw0KQEAgLTQ5NCwxOSArNDk0LDE5IEBADQogCWFzc2VydChyZXMu
ZXJyb3IgPT0gMCk7DQogCWFzc2VydChyZXMubXNncy5sZW5ndGggPT0gMyk7DQogCWFzc2VydChy
ZXMubXNnc1swXS5kbiA9PSBzNC5kbigiY249QiIpKTsNCi0JYXNzZXJ0KHJlcy5tc2dzWzBdLm9i
amVjdENhdGVnb3J5ID09IHVuZGVmaW5lZCk7DQorCWFzc2VydChyZXMubXNnc1swXS5kbnNIb3N0
TmFtZSA9PSB1bmRlZmluZWQpOw0KIAlhc3NlcnQocmVzLm1zZ3NbMF0ubGFzdExvZ29uID09ICJ5
Iik7DQogCWFzc2VydChyZXMubXNnc1swXS5vYmplY3RDbGFzcyAhPSB1bmRlZmluZWQpOw0KIAlm
b3IgKGk9MDtpPHJlcy5tc2dzWzBdLm9iamVjdENsYXNzLmxlbmd0aDtpKyspIHsNCiAJCWFzc2Vy
dChyZXMubXNnc1swXS5vYmplY3RDbGFzc1tpXSAhPSAidXNlciIpOw0KIAl9DQogCWFzc2VydChy
ZXMubXNnc1sxXS5kbiA9PSBzNC5kbigiY249WCIpKTsNCi0JYXNzZXJ0KHJlcy5tc2dzWzFdLm9i
amVjdENhdGVnb3J5ID09ICJ4Iik7DQorCWFzc2VydChyZXMubXNnc1sxXS5kbnNIb3N0TmFtZSA9
PSAieCIpOw0KIAlhc3NlcnQocmVzLm1zZ3NbMV0ubGFzdExvZ29uID09ICJ4Iik7DQogCWFzc2Vy
dChyZXMubXNnc1sxXS5vYmplY3RDbGFzcyAhPSB1bmRlZmluZWQpOw0KIAlhc3NlcnQocmVzLm1z
Z3NbMV0ub2JqZWN0Q2xhc3NbM10gPT0gInVzZXIiKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzJdLmRu
ID09IHM0LmRuKCJjbj1BIikpOw0KLQlhc3NlcnQocmVzLm1zZ3NbMl0ub2JqZWN0Q2F0ZWdvcnkg
PT0gdW5kZWZpbmVkKTsNCisJYXNzZXJ0KHJlcy5tc2dzWzJdLmRuc0hvc3ROYW1lID09IHVuZGVm
aW5lZCk7DQogCWFzc2VydChyZXMubXNnc1syXS5sYXN0TG9nb24gPT0gIngiKTsNCiAJYXNzZXJ0
KHJlcy5tc2dzWzJdLm9iamVjdENsYXNzICE9IHVuZGVmaW5lZCk7DQogCWFzc2VydChyZXMubXNn
c1syXS5vYmplY3RDbGFzc1swXSA9PSAidXNlciIpOw0KQEAgLTUxNCw0MyArNTE0LDQzIEBADQog
CXByaW50bG4oIlRlc3Rpbmcgc2VhcmNoIGJ5IHBhcnNlIHRyZWUiKTsNCiANCiAJLyogU2VhcmNo
IGJ5IGNvbmp1bmN0aW9uIG9mIGxvY2FsIGF0dHJpYnV0ZXMgKi8NCi0JYXR0cnMgPSBuZXcgQXJy
YXkoIm9iamVjdENhdGVnb3J5IiwgImxhc3RMb2dvbiIpOw0KKwlhdHRycyA9IG5ldyBBcnJheSgi
ZG5zSG9zdE5hbWUiLCAibGFzdExvZ29uIik7DQogCXJlcyA9IGxkYi5zZWFyY2goIigmKGNvZGVQ
YWdlPXgpKHJldmlzaW9uPXgpKSIsIE5VTEwsIGxkYi5TQ09QRV9ERUZBVUxULCBhdHRycyk7DQog
CWFzc2VydChyZXMuZXJyb3IgPT0gMCk7DQogCWFzc2VydChyZXMubXNncy5sZW5ndGggPT0gMik7
DQogCWFzc2VydChyZXMubXNnc1swXS5kbiA9PSBzNC5kbigiY249WSIpKTsNCi0JYXNzZXJ0KHJl
cy5tc2dzWzBdLm9iamVjdENhdGVnb3J5ID09ICJ5Iik7DQorCWFzc2VydChyZXMubXNnc1swXS5k
bnNIb3N0TmFtZSA9PSAieSIpOw0KIAlhc3NlcnQocmVzLm1zZ3NbMF0ubGFzdExvZ29uID09ICJ5
Iik7DQogCWFzc2VydChyZXMubXNnc1sxXS5kbiA9PSBzNC5kbigiY249WCIpKTsNCi0JYXNzZXJ0
KHJlcy5tc2dzWzFdLm9iamVjdENhdGVnb3J5ID09ICJ4Iik7DQorCWFzc2VydChyZXMubXNnc1sx
XS5kbnNIb3N0TmFtZSA9PSAieCIpOw0KIAlhc3NlcnQocmVzLm1zZ3NbMV0ubGFzdExvZ29uID09
ICJ4Iik7DQogDQogCS8qIFNlYXJjaCBieSBjb25qdW5jdGlvbiBvZiByZW1vdGUgYXR0cmlidXRl
cyAqLw0KLQlhdHRycyA9IG5ldyBBcnJheSgib2JqZWN0Q2F0ZWdvcnkiLCAibGFzdExvZ29uIik7
DQorCWF0dHJzID0gbmV3IEFycmF5KCJkbnNIb3N0TmFtZSIsICJsYXN0TG9nb24iKTsNCiAJcmVz
ID0gbGRiLnNlYXJjaCgiKCYobGFzdExvZ29uPXgpKGRlc2NyaXB0aW9uPXgpKSIsIE5VTEwsIGxk
Yi5TQ09QRV9ERUZBVUxULCBhdHRycyk7DQogCWFzc2VydChyZXMuZXJyb3IgPT0gMCk7DQogCWFz
c2VydChyZXMubXNncy5sZW5ndGggPT0gMik7DQogCWFzc2VydChyZXMubXNnc1swXS5kbiA9PSBz
NC5kbigiY249WCIpKTsNCi0JYXNzZXJ0KHJlcy5tc2dzWzBdLm9iamVjdENhdGVnb3J5ID09ICJ4
Iik7DQorCWFzc2VydChyZXMubXNnc1swXS5kbnNIb3N0TmFtZSA9PSAieCIpOw0KIAlhc3NlcnQo
cmVzLm1zZ3NbMF0ubGFzdExvZ29uID09ICJ4Iik7DQogCWFzc2VydChyZXMubXNnc1sxXS5kbiA9
PSBzNC5kbigiY249QSIpKTsNCi0JYXNzZXJ0KHJlcy5tc2dzWzFdLm9iamVjdENhdGVnb3J5ID09
IHVuZGVmaW5lZCk7DQorCWFzc2VydChyZXMubXNnc1sxXS5kbnNIb3N0TmFtZSA9PSB1bmRlZmlu
ZWQpOw0KIAlhc3NlcnQocmVzLm1zZ3NbMV0ubGFzdExvZ29uID09ICJ4Iik7DQogCQ0KIAkvKiBT
ZWFyY2ggYnkgY29uanVuY3Rpb24gb2YgbG9jYWwgYW5kIHJlbW90ZSBhdHRyaWJ1dGUgKi8NCi0J
YXR0cnMgPSBuZXcgQXJyYXkoIm9iamVjdENhdGVnb3J5IiwgImxhc3RMb2dvbiIpOw0KKwlhdHRy
cyA9IG5ldyBBcnJheSgiZG5zSG9zdE5hbWUiLCAibGFzdExvZ29uIik7DQogCXJlcyA9IGxkYi5z
ZWFyY2goIigmKGNvZGVQYWdlPXgpKGRlc2NyaXB0aW9uPXgpKSIsIE5VTEwsIGxkYi5TQ09QRV9E
RUZBVUxULCBhdHRycyk7DQogCWFzc2VydChyZXMuZXJyb3IgPT0gMCk7DQogCWFzc2VydChyZXMu
bXNncy5sZW5ndGggPT0gMik7DQogCWFzc2VydChyZXMubXNnc1swXS5kbiA9PSBzNC5kbigiY249
WSIpKTsNCi0JYXNzZXJ0KHJlcy5tc2dzWzBdLm9iamVjdENhdGVnb3J5ID09ICJ5Iik7DQorCWFz
c2VydChyZXMubXNnc1swXS5kbnNIb3N0TmFtZSA9PSAieSIpOw0KIAlhc3NlcnQocmVzLm1zZ3Nb
MF0ubGFzdExvZ29uID09ICJ5Iik7DQogCWFzc2VydChyZXMubXNnc1sxXS5kbiA9PSBzNC5kbigi
Y249WCIpKTsNCi0JYXNzZXJ0KHJlcy5tc2dzWzFdLm9iamVjdENhdGVnb3J5ID09ICJ4Iik7DQor
CWFzc2VydChyZXMubXNnc1sxXS5kbnNIb3N0TmFtZSA9PSAieCIpOw0KIAlhc3NlcnQocmVzLm1z
Z3NbMV0ubGFzdExvZ29uID09ICJ4Iik7DQogDQogCS8qIFNlYXJjaCBieSBjb25qdW5jdGlvbiBv
ZiBsb2NhbCBhbmQgcmVtb3RlIGF0dHJpYnV0ZSB3L28gbWF0Y2ggKi8NCi0JYXR0cnMgPSBuZXcg
QXJyYXkoIm9iamVjdENhdGVnb3J5IiwgImxhc3RMb2dvbiIpOw0KKwlhdHRycyA9IG5ldyBBcnJh
eSgiZG5zSG9zdE5hbWUiLCAibGFzdExvZ29uIik7DQogCXJlcyA9IGxkYi5zZWFyY2goIigmKGNv
ZGVQYWdlPXgpKG5leHRSaWQ9eCkpIiwgTlVMTCwgbGRiLlNDT1BFX0RFRkFVTFQsIGF0dHJzKTsN
CiAJYXNzZXJ0KHJlcy5lcnJvciA9PSAwKTsNCiAJYXNzZXJ0KHJlcy5tc2dzLmxlbmd0aCA9PSAw
KTsNCkBAIC01NTksMjAzICs1NTksMjAzIEBADQogCWFzc2VydChyZXMubXNncy5sZW5ndGggPT0g
MCk7DQogDQogCS8qIFNlYXJjaCBieSBkaXNqdW5jdGlvbiBvZiBsb2NhbCBhdHRyaWJ1dGVzICov
DQotCWF0dHJzID0gbmV3IEFycmF5KCJvYmplY3RDYXRlZ29yeSIsICJsYXN0TG9nb24iKTsNCi0J
cmVzID0gbGRiLnNlYXJjaCgiKHwocmV2aXNpb249eCkob2JqZWN0Q2F0ZWdvcnk9eCkpIiwgTlVM
TCwgbGRiLlNDT1BFX0RFRkFVTFQsIGF0dHJzKTsNCisJYXR0cnMgPSBuZXcgQXJyYXkoImRuc0hv
c3ROYW1lIiwgImxhc3RMb2dvbiIpOw0KKwlyZXMgPSBsZGIuc2VhcmNoKCIofChyZXZpc2lvbj14
KShkbnNIb3N0TmFtZT14KSkiLCBOVUxMLCBsZGIuU0NPUEVfREVGQVVMVCwgYXR0cnMpOw0KIAlh
c3NlcnQocmVzLmVycm9yID09IDApOw0KIAlhc3NlcnQocmVzLm1zZ3MubGVuZ3RoID09IDIpOw0K
IAlhc3NlcnQocmVzLm1zZ3NbMF0uZG4gPT0gczQuZG4oImNuPVkiKSk7DQotCWFzc2VydChyZXMu
bXNnc1swXS5vYmplY3RDYXRlZ29yeSA9PSAieSIpOw0KKwlhc3NlcnQocmVzLm1zZ3NbMF0uZG5z
SG9zdE5hbWUgPT0gInkiKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzBdLmxhc3RMb2dvbiA9PSAieSIp
Ow0KIAlhc3NlcnQocmVzLm1zZ3NbMV0uZG4gPT0gczQuZG4oImNuPVgiKSk7DQotCWFzc2VydChy
ZXMubXNnc1sxXS5vYmplY3RDYXRlZ29yeSA9PSAieCIpOw0KKwlhc3NlcnQocmVzLm1zZ3NbMV0u
ZG5zSG9zdE5hbWUgPT0gIngiKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzFdLmxhc3RMb2dvbiA9PSAi
eCIpOw0KIA0KIAkvKiBTZWFyY2ggYnkgZGlzanVuY3Rpb24gb2YgcmVtb3RlIGF0dHJpYnV0ZXMg
Ki8NCi0JYXR0cnMgPSBuZXcgQXJyYXkoIm9iamVjdENhdGVnb3J5IiwgImxhc3RMb2dvbiIpOw0K
KwlhdHRycyA9IG5ldyBBcnJheSgiZG5zSG9zdE5hbWUiLCAibGFzdExvZ29uIik7DQogCXJlcyA9
IGxkYi5zZWFyY2goIih8KGJhZFB3ZENvdW50PXgpKGxhc3RMb2dvbj14KSkiLCBOVUxMLCBsZGIu
U0NPUEVfREVGQVVMVCwgYXR0cnMpOw0KIAlhc3NlcnQocmVzLmVycm9yID09IDApOw0KIAlhc3Nl
cnQocmVzLm1zZ3MubGVuZ3RoID09IDMpOw0KIAlhc3NlcnQocmVzLm1zZ3NbMF0uZG4gPT0gczQu
ZG4oImNuPUIiKSk7DQotCWFzc2VydChyZXMubXNnc1swXS5vYmplY3RDYXRlZ29yeSA9PSB1bmRl
ZmluZWQpOw0KKwlhc3NlcnQocmVzLm1zZ3NbMF0uZG5zSG9zdE5hbWUgPT0gdW5kZWZpbmVkKTsN
CiAJYXNzZXJ0KHJlcy5tc2dzWzBdLmxhc3RMb2dvbiA9PSAieSIpOw0KIAlhc3NlcnQocmVzLm1z
Z3NbMV0uZG4gPT0gczQuZG4oImNuPVgiKSk7DQotCWFzc2VydChyZXMubXNnc1sxXS5vYmplY3RD
YXRlZ29yeSA9PSAieCIpOw0KKwlhc3NlcnQocmVzLm1zZ3NbMV0uZG5zSG9zdE5hbWUgPT0gIngi
KTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzFdLmxhc3RMb2dvbiA9PSAieCIpOw0KIAlhc3NlcnQocmVz
Lm1zZ3NbMl0uZG4gPT0gczQuZG4oImNuPUEiKSk7DQotCWFzc2VydChyZXMubXNnc1syXS5vYmpl
Y3RDYXRlZ29yeSA9PSB1bmRlZmluZWQpOw0KKwlhc3NlcnQocmVzLm1zZ3NbMl0uZG5zSG9zdE5h
bWUgPT0gdW5kZWZpbmVkKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzJdLmxhc3RMb2dvbiA9PSAieCIp
Ow0KIA0KIAkvKiBTZWFyY2ggYnkgZGlzanVuY3Rpb24gb2YgbG9jYWwgYW5kIHJlbW90ZSBhdHRy
aWJ1dGUgKi8NCi0JYXR0cnMgPSBuZXcgQXJyYXkoIm9iamVjdENhdGVnb3J5IiwgImxhc3RMb2dv
biIpOw0KKwlhdHRycyA9IG5ldyBBcnJheSgiZG5zSG9zdE5hbWUiLCAibGFzdExvZ29uIik7DQog
CXJlcyA9IGxkYi5zZWFyY2goIih8KHJldmlzaW9uPXgpKGxhc3RMb2dvbj15KSkiLCBOVUxMLCBs
ZGIuU0NPUEVfREVGQVVMVCwgYXR0cnMpOw0KIAlhc3NlcnQocmVzLmVycm9yID09IDApOw0KIAlh
c3NlcnQocmVzLm1zZ3MubGVuZ3RoID09IDMpOw0KIAlhc3NlcnQocmVzLm1zZ3NbMF0uZG4gPT0g
czQuZG4oImNuPVkiKSk7DQotCWFzc2VydChyZXMubXNnc1swXS5vYmplY3RDYXRlZ29yeSA9PSAi
eSIpOw0KKwlhc3NlcnQocmVzLm1zZ3NbMF0uZG5zSG9zdE5hbWUgPT0gInkiKTsNCiAJYXNzZXJ0
KHJlcy5tc2dzWzBdLmxhc3RMb2dvbiA9PSAieSIpOw0KIAlhc3NlcnQocmVzLm1zZ3NbMV0uZG4g
PT0gczQuZG4oImNuPUIiKSk7DQotCWFzc2VydChyZXMubXNnc1sxXS5vYmplY3RDYXRlZ29yeSA9
PSB1bmRlZmluZWQpOw0KKwlhc3NlcnQocmVzLm1zZ3NbMV0uZG5zSG9zdE5hbWUgPT0gdW5kZWZp
bmVkKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzFdLmxhc3RMb2dvbiA9PSAieSIpOw0KIAlhc3NlcnQo
cmVzLm1zZ3NbMl0uZG4gPT0gczQuZG4oImNuPVgiKSk7DQotCWFzc2VydChyZXMubXNnc1syXS5v
YmplY3RDYXRlZ29yeSA9PSAieCIpOw0KKwlhc3NlcnQocmVzLm1zZ3NbMl0uZG5zSG9zdE5hbWUg
PT0gIngiKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzJdLmxhc3RMb2dvbiA9PSAieCIpOw0KIA0KIAkv
KiBTZWFyY2ggYnkgZGlzanVuY3Rpb24gb2YgbG9jYWwgYW5kIHJlbW90ZSBhdHRyaWJ1dGUgdy9v
IG1hdGNoICovDQotCWF0dHJzID0gbmV3IEFycmF5KCJvYmplY3RDYXRlZ29yeSIsICJsYXN0TG9n
b24iKTsNCisJYXR0cnMgPSBuZXcgQXJyYXkoImRuc0hvc3ROYW1lIiwgImxhc3RMb2dvbiIpOw0K
IAlyZXMgPSBsZGIuc2VhcmNoKCIofChjb2RlUGFnZT15KShuZXh0UmlkPXopKSIsIE5VTEwsIGxk
Yi5TQ09QRV9ERUZBVUxULCBhdHRycyk7DQogCWFzc2VydChyZXMuZXJyb3IgPT0gMCk7DQogCWFz
c2VydChyZXMubXNncy5sZW5ndGggPT0gMCk7DQogDQogCS8qIFNlYXJjaCBieSBuZWdhdGVkIGxv
Y2FsIGF0dHJpYnV0ZSAqLw0KLQlhdHRycyA9IG5ldyBBcnJheSgib2JqZWN0Q2F0ZWdvcnkiLCAi
bGFzdExvZ29uIik7DQorCWF0dHJzID0gbmV3IEFycmF5KCJkbnNIb3N0TmFtZSIsICJsYXN0TG9n
b24iKTsNCiAJcmVzID0gbGRiLnNlYXJjaCgiKCEocmV2aXNpb249eCkpIiwgTlVMTCwgbGRiLlND
T1BFX0RFRkFVTFQsIGF0dHJzKTsNCiAJYXNzZXJ0KHJlcy5lcnJvciA9PSAwKTsNCiAJYXNzZXJ0
KHJlcy5tc2dzLmxlbmd0aCA9PSA0KTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzBdLmRuID09IHM0LmRu
KCJjbj1CIikpOw0KLQlhc3NlcnQocmVzLm1zZ3NbMF0ub2JqZWN0Q2F0ZWdvcnkgPT0gdW5kZWZp
bmVkKTsNCisJYXNzZXJ0KHJlcy5tc2dzWzBdLmRuc0hvc3ROYW1lID09IHVuZGVmaW5lZCk7DQog
CWFzc2VydChyZXMubXNnc1swXS5sYXN0TG9nb24gPT0gInkiKTsNCiAJYXNzZXJ0KHJlcy5tc2dz
WzFdLmRuID09IHM0LmRuKCJjbj1BIikpOw0KLQlhc3NlcnQocmVzLm1zZ3NbMV0ub2JqZWN0Q2F0
ZWdvcnkgPT0gdW5kZWZpbmVkKTsNCisJYXNzZXJ0KHJlcy5tc2dzWzFdLmRuc0hvc3ROYW1lID09
IHVuZGVmaW5lZCk7DQogCWFzc2VydChyZXMubXNnc1sxXS5sYXN0TG9nb24gPT0gIngiKTsNCiAJ
YXNzZXJ0KHJlcy5tc2dzWzJdLmRuID09IHM0LmRuKCJjbj1aIikpOw0KLQlhc3NlcnQocmVzLm1z
Z3NbMl0ub2JqZWN0Q2F0ZWdvcnkgPT0gInoiKTsNCisJYXNzZXJ0KHJlcy5tc2dzWzJdLmRuc0hv
c3ROYW1lID09ICJ6Iik7DQogCWFzc2VydChyZXMubXNnc1syXS5sYXN0TG9nb24gPT0gInoiKTsN
CiAJYXNzZXJ0KHJlcy5tc2dzWzNdLmRuID09IHM0LmRuKCJjbj1DIikpOw0KLQlhc3NlcnQocmVz
Lm1zZ3NbM10ub2JqZWN0Q2F0ZWdvcnkgPT0gdW5kZWZpbmVkKTsNCisJYXNzZXJ0KHJlcy5tc2dz
WzNdLmRuc0hvc3ROYW1lID09IHVuZGVmaW5lZCk7DQogCWFzc2VydChyZXMubXNnc1szXS5sYXN0
TG9nb24gPT0gInoiKTsNCiANCiAJLyogU2VhcmNoIGJ5IG5lZ2F0ZWQgcmVtb3RlIGF0dHJpYnV0
ZSAqLw0KLQlhdHRycyA9IG5ldyBBcnJheSgib2JqZWN0Q2F0ZWdvcnkiLCAibGFzdExvZ29uIik7
DQorCWF0dHJzID0gbmV3IEFycmF5KCJkbnNIb3N0TmFtZSIsICJsYXN0TG9nb24iKTsNCiAJcmVz
ID0gbGRiLnNlYXJjaCgiKCEoZGVzY3JpcHRpb249eCkpIiwgTlVMTCwgbGRiLlNDT1BFX0RFRkFV
TFQsIGF0dHJzKTsNCiAJYXNzZXJ0KHJlcy5lcnJvciA9PSAwKTsNCiAJYXNzZXJ0KHJlcy5tc2dz
Lmxlbmd0aCA9PSAyKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzBdLmRuID09IHM0LmRuKCJjbj1aIikp
Ow0KLQlhc3NlcnQocmVzLm1zZ3NbMF0ub2JqZWN0Q2F0ZWdvcnkgPT0gInoiKTsNCisJYXNzZXJ0
KHJlcy5tc2dzWzBdLmRuc0hvc3ROYW1lID09ICJ6Iik7DQogCWFzc2VydChyZXMubXNnc1swXS5s
YXN0TG9nb24gPT0gInoiKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzFdLmRuID09IHM0LmRuKCJjbj1D
IikpOw0KLQlhc3NlcnQocmVzLm1zZ3NbMV0ub2JqZWN0Q2F0ZWdvcnkgPT0gdW5kZWZpbmVkKTsN
CisJYXNzZXJ0KHJlcy5tc2dzWzFdLmRuc0hvc3ROYW1lID09IHVuZGVmaW5lZCk7DQogCWFzc2Vy
dChyZXMubXNnc1sxXS5sYXN0TG9nb24gPT0gInoiKTsNCiANCiAJLyogU2VhcmNoIGJ5IG5lZ2F0
ZWQgY29uanVuY3Rpb24gb2YgbG9jYWwgYXR0cmlidXRlcyAqLw0KLQlhdHRycyA9IG5ldyBBcnJh
eSgib2JqZWN0Q2F0ZWdvcnkiLCAibGFzdExvZ29uIik7DQorCWF0dHJzID0gbmV3IEFycmF5KCJk
bnNIb3N0TmFtZSIsICJsYXN0TG9nb24iKTsNCiAJcmVzID0gbGRiLnNlYXJjaCgiKCEoJihjb2Rl
UGFnZT14KShyZXZpc2lvbj14KSkpIiwgTlVMTCwgbGRiLlNDT1BFX0RFRkFVTFQsIGF0dHJzKTsN
CiAJYXNzZXJ0KHJlcy5lcnJvciA9PSAwKTsNCiAJYXNzZXJ0KHJlcy5tc2dzLmxlbmd0aCA9PSA0
KTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzBdLmRuID09IHM0LmRuKCJjbj1CIikpOw0KLQlhc3NlcnQo
cmVzLm1zZ3NbMF0ub2JqZWN0Q2F0ZWdvcnkgPT0gdW5kZWZpbmVkKTsNCisJYXNzZXJ0KHJlcy5t
c2dzWzBdLmRuc0hvc3ROYW1lID09IHVuZGVmaW5lZCk7DQogCWFzc2VydChyZXMubXNnc1swXS5s
YXN0TG9nb24gPT0gInkiKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzFdLmRuID09IHM0LmRuKCJjbj1B
IikpOw0KLQlhc3NlcnQocmVzLm1zZ3NbMV0ub2JqZWN0Q2F0ZWdvcnkgPT0gdW5kZWZpbmVkKTsN
CisJYXNzZXJ0KHJlcy5tc2dzWzFdLmRuc0hvc3ROYW1lID09IHVuZGVmaW5lZCk7DQogCWFzc2Vy
dChyZXMubXNnc1sxXS5sYXN0TG9nb24gPT0gIngiKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzJdLmRu
ID09IHM0LmRuKCJjbj1aIikpOw0KLQlhc3NlcnQocmVzLm1zZ3NbMl0ub2JqZWN0Q2F0ZWdvcnkg
PT0gInoiKTsNCisJYXNzZXJ0KHJlcy5tc2dzWzJdLmRuc0hvc3ROYW1lID09ICJ6Iik7DQogCWFz
c2VydChyZXMubXNnc1syXS5sYXN0TG9nb24gPT0gInoiKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzNd
LmRuID09IHM0LmRuKCJjbj1DIikpOw0KLQlhc3NlcnQocmVzLm1zZ3NbM10ub2JqZWN0Q2F0ZWdv
cnkgPT0gdW5kZWZpbmVkKTsNCisJYXNzZXJ0KHJlcy5tc2dzWzNdLmRuc0hvc3ROYW1lID09IHVu
ZGVmaW5lZCk7DQogCWFzc2VydChyZXMubXNnc1szXS5sYXN0TG9nb24gPT0gInoiKTsNCiANCiAJ
LyogU2VhcmNoIGJ5IG5lZ2F0ZWQgY29uanVuY3Rpb24gb2YgcmVtb3RlIGF0dHJpYnV0ZXMgKi8N
Ci0JYXR0cnMgPSBuZXcgQXJyYXkoIm9iamVjdENhdGVnb3J5IiwgImxhc3RMb2dvbiIpOw0KKwlh
dHRycyA9IG5ldyBBcnJheSgiZG5zSG9zdE5hbWUiLCAibGFzdExvZ29uIik7DQogCXJlcyA9IGxk
Yi5zZWFyY2goIighKCYobGFzdExvZ29uPXgpKGRlc2NyaXB0aW9uPXgpKSkiLCBOVUxMLCBsZGIu
U0NPUEVfREVGQVVMVCwgYXR0cnMpOw0KIAlhc3NlcnQocmVzLmVycm9yID09IDApOw0KIAlhc3Nl
cnQocmVzLm1zZ3MubGVuZ3RoID09IDQpOw0KIAlhc3NlcnQocmVzLm1zZ3NbMF0uZG4gPT0gczQu
ZG4oImNuPVkiKSk7DQotCWFzc2VydChyZXMubXNnc1swXS5vYmplY3RDYXRlZ29yeSA9PSAieSIp
Ow0KKwlhc3NlcnQocmVzLm1zZ3NbMF0uZG5zSG9zdE5hbWUgPT0gInkiKTsNCiAJYXNzZXJ0KHJl
cy5tc2dzWzBdLmxhc3RMb2dvbiA9PSAieSIpOw0KIAlhc3NlcnQocmVzLm1zZ3NbMV0uZG4gPT0g
czQuZG4oImNuPUIiKSk7DQotCWFzc2VydChyZXMubXNnc1sxXS5vYmplY3RDYXRlZ29yeSA9PSB1
bmRlZmluZWQpOw0KKwlhc3NlcnQocmVzLm1zZ3NbMV0uZG5zSG9zdE5hbWUgPT0gdW5kZWZpbmVk
KTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzFdLmxhc3RMb2dvbiA9PSAieSIpOw0KIAlhc3NlcnQocmVz
Lm1zZ3NbMl0uZG4gPT0gczQuZG4oImNuPVoiKSk7DQotCWFzc2VydChyZXMubXNnc1syXS5vYmpl
Y3RDYXRlZ29yeSA9PSAieiIpOw0KKwlhc3NlcnQocmVzLm1zZ3NbMl0uZG5zSG9zdE5hbWUgPT0g
InoiKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzJdLmxhc3RMb2dvbiA9PSAieiIpOw0KIAlhc3NlcnQo
cmVzLm1zZ3NbM10uZG4gPT0gczQuZG4oImNuPUMiKSk7DQotCWFzc2VydChyZXMubXNnc1szXS5v
YmplY3RDYXRlZ29yeSA9PSB1bmRlZmluZWQpOw0KKwlhc3NlcnQocmVzLm1zZ3NbM10uZG5zSG9z
dE5hbWUgPT0gdW5kZWZpbmVkKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzNdLmxhc3RMb2dvbiA9PSAi
eiIpOw0KIA0KIAkvKiBTZWFyY2ggYnkgbmVnYXRlZCBjb25qdW5jdGlvbiBvZiBsb2NhbCBhbmQg
cmVtb3RlIGF0dHJpYnV0ZSAqLw0KLQlhdHRycyA9IG5ldyBBcnJheSgib2JqZWN0Q2F0ZWdvcnki
LCAibGFzdExvZ29uIik7DQorCWF0dHJzID0gbmV3IEFycmF5KCJkbnNIb3N0TmFtZSIsICJsYXN0
TG9nb24iKTsNCiAJcmVzID0gbGRiLnNlYXJjaCgiKCEoJihjb2RlUGFnZT14KShkZXNjcmlwdGlv
bj14KSkpIiwgTlVMTCwgbGRiLlNDT1BFX0RFRkFVTFQsIGF0dHJzKTsNCiAJYXNzZXJ0KHJlcy5l
cnJvciA9PSAwKTsNCiAJYXNzZXJ0KHJlcy5tc2dzLmxlbmd0aCA9PSA0KTsNCiAJYXNzZXJ0KHJl
cy5tc2dzWzBdLmRuID09IHM0LmRuKCJjbj1CIikpOw0KLQlhc3NlcnQocmVzLm1zZ3NbMF0ub2Jq
ZWN0Q2F0ZWdvcnkgPT0gdW5kZWZpbmVkKTsNCisJYXNzZXJ0KHJlcy5tc2dzWzBdLmRuc0hvc3RO
YW1lID09IHVuZGVmaW5lZCk7DQogCWFzc2VydChyZXMubXNnc1swXS5sYXN0TG9nb24gPT0gInki
KTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzFdLmRuID09IHM0LmRuKCJjbj1BIikpOw0KLQlhc3NlcnQo
cmVzLm1zZ3NbMV0ub2JqZWN0Q2F0ZWdvcnkgPT0gdW5kZWZpbmVkKTsNCisJYXNzZXJ0KHJlcy5t
c2dzWzFdLmRuc0hvc3ROYW1lID09IHVuZGVmaW5lZCk7DQogCWFzc2VydChyZXMubXNnc1sxXS5s
YXN0TG9nb24gPT0gIngiKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzJdLmRuID09IHM0LmRuKCJjbj1a
IikpOw0KLQlhc3NlcnQocmVzLm1zZ3NbMl0ub2JqZWN0Q2F0ZWdvcnkgPT0gInoiKTsNCisJYXNz
ZXJ0KHJlcy5tc2dzWzJdLmRuc0hvc3ROYW1lID09ICJ6Iik7DQogCWFzc2VydChyZXMubXNnc1sy
XS5sYXN0TG9nb24gPT0gInoiKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzNdLmRuID09IHM0LmRuKCJj
bj1DIikpOw0KLQlhc3NlcnQocmVzLm1zZ3NbM10ub2JqZWN0Q2F0ZWdvcnkgPT0gdW5kZWZpbmVk
KTsNCisJYXNzZXJ0KHJlcy5tc2dzWzNdLmRuc0hvc3ROYW1lID09IHVuZGVmaW5lZCk7DQogCWFz
c2VydChyZXMubXNnc1szXS5sYXN0TG9nb24gPT0gInoiKTsNCiANCiAJLyogU2VhcmNoIGJ5IG5l
Z2F0ZWQgZGlzanVuY3Rpb24gb2YgbG9jYWwgYXR0cmlidXRlcyAqLw0KLQlhdHRycyA9IG5ldyBB
cnJheSgib2JqZWN0Q2F0ZWdvcnkiLCAibGFzdExvZ29uIik7DQotCXJlcyA9IGxkYi5zZWFyY2go
IighKHwocmV2aXNpb249eCkob2JqZWN0Q2F0ZWdvcnk9eCkpKSIsIE5VTEwsIGxkYi5TQ09QRV9E
RUZBVUxULCBhdHRycyk7DQorCWF0dHJzID0gbmV3IEFycmF5KCJkbnNIb3N0TmFtZSIsICJsYXN0
TG9nb24iKTsNCisJcmVzID0gbGRiLnNlYXJjaCgiKCEofChyZXZpc2lvbj14KShkbnNIb3N0TmFt
ZT14KSkpIiwgTlVMTCwgbGRiLlNDT1BFX0RFRkFVTFQsIGF0dHJzKTsNCiAJYXNzZXJ0KHJlcy5l
cnJvciA9PSAwKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzBdLmRuID09IHM0LmRuKCJjbj1CIikpOw0K
LQlhc3NlcnQocmVzLm1zZ3NbMF0ub2JqZWN0Q2F0ZWdvcnkgPT0gdW5kZWZpbmVkKTsNCisJYXNz
ZXJ0KHJlcy5tc2dzWzBdLmRuc0hvc3ROYW1lID09IHVuZGVmaW5lZCk7DQogCWFzc2VydChyZXMu
bXNnc1swXS5sYXN0TG9nb24gPT0gInkiKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzFdLmRuID09IHM0
LmRuKCJjbj1BIikpOw0KLQlhc3NlcnQocmVzLm1zZ3NbMV0ub2JqZWN0Q2F0ZWdvcnkgPT0gdW5k
ZWZpbmVkKTsNCisJYXNzZXJ0KHJlcy5tc2dzWzFdLmRuc0hvc3ROYW1lID09IHVuZGVmaW5lZCk7
DQogCWFzc2VydChyZXMubXNnc1sxXS5sYXN0TG9nb24gPT0gIngiKTsNCiAJYXNzZXJ0KHJlcy5t
c2dzWzJdLmRuID09IHM0LmRuKCJjbj1aIikpOw0KLQlhc3NlcnQocmVzLm1zZ3NbMl0ub2JqZWN0
Q2F0ZWdvcnkgPT0gInoiKTsNCisJYXNzZXJ0KHJlcy5tc2dzWzJdLmRuc0hvc3ROYW1lID09ICJ6
Iik7DQogCWFzc2VydChyZXMubXNnc1syXS5sYXN0TG9nb24gPT0gInoiKTsNCiAJYXNzZXJ0KHJl
cy5tc2dzWzNdLmRuID09IHM0LmRuKCJjbj1DIikpOw0KLQlhc3NlcnQocmVzLm1zZ3NbM10ub2Jq
ZWN0Q2F0ZWdvcnkgPT0gdW5kZWZpbmVkKTsNCisJYXNzZXJ0KHJlcy5tc2dzWzNdLmRuc0hvc3RO
YW1lID09IHVuZGVmaW5lZCk7DQogCWFzc2VydChyZXMubXNnc1szXS5sYXN0TG9nb24gPT0gInoi
KTsNCiANCiAJLyogU2VhcmNoIGJ5IG5lZ2F0ZWQgZGlzanVuY3Rpb24gb2YgcmVtb3RlIGF0dHJp
YnV0ZXMgKi8NCi0JYXR0cnMgPSBuZXcgQXJyYXkoIm9iamVjdENhdGVnb3J5IiwgImxhc3RMb2dv
biIpOw0KKwlhdHRycyA9IG5ldyBBcnJheSgiZG5zSG9zdE5hbWUiLCAibGFzdExvZ29uIik7DQog
CXJlcyA9IGxkYi5zZWFyY2goIighKHwoYmFkUHdkQ291bnQ9eCkobGFzdExvZ29uPXgpKSkiLCBO
VUxMLCBsZGIuU0NPUEVfREVGQVVMVCwgYXR0cnMpOw0KIAlhc3NlcnQocmVzLmVycm9yID09IDAp
Ow0KIAlhc3NlcnQocmVzLm1zZ3MubGVuZ3RoID09IDMpOw0KIAlhc3NlcnQocmVzLm1zZ3NbMF0u
ZG4gPT0gczQuZG4oImNuPVkiKSk7DQotCWFzc2VydChyZXMubXNnc1swXS5vYmplY3RDYXRlZ29y
eSA9PSAieSIpOw0KKwlhc3NlcnQocmVzLm1zZ3NbMF0uZG5zSG9zdE5hbWUgPT0gInkiKTsNCiAJ
YXNzZXJ0KHJlcy5tc2dzWzBdLmxhc3RMb2dvbiA9PSAieSIpOw0KIAlhc3NlcnQocmVzLm1zZ3Nb
MV0uZG4gPT0gczQuZG4oImNuPVoiKSk7DQotCWFzc2VydChyZXMubXNnc1sxXS5vYmplY3RDYXRl
Z29yeSA9PSAieiIpOw0KKwlhc3NlcnQocmVzLm1zZ3NbMV0uZG5zSG9zdE5hbWUgPT0gInoiKTsN
CiAJYXNzZXJ0KHJlcy5tc2dzWzFdLmxhc3RMb2dvbiA9PSAieiIpOw0KIAlhc3NlcnQocmVzLm1z
Z3NbMl0uZG4gPT0gczQuZG4oImNuPUMiKSk7DQotCWFzc2VydChyZXMubXNnc1syXS5vYmplY3RD
YXRlZ29yeSA9PSB1bmRlZmluZWQpOw0KKwlhc3NlcnQocmVzLm1zZ3NbMl0uZG5zSG9zdE5hbWUg
PT0gdW5kZWZpbmVkKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzJdLmxhc3RMb2dvbiA9PSAieiIpOw0K
IA0KIAkvKiBTZWFyY2ggYnkgbmVnYXRlZCBkaXNqdW5jdGlvbiBvZiBsb2NhbCBhbmQgcmVtb3Rl
IGF0dHJpYnV0ZSAqLw0KLQlhdHRycyA9IG5ldyBBcnJheSgib2JqZWN0Q2F0ZWdvcnkiLCAibGFz
dExvZ29uIik7DQorCWF0dHJzID0gbmV3IEFycmF5KCJkbnNIb3N0TmFtZSIsICJsYXN0TG9nb24i
KTsNCiAJcmVzID0gbGRiLnNlYXJjaCgiKCEofChyZXZpc2lvbj14KShsYXN0TG9nb249eSkpKSIs
IE5VTEwsIGxkYi5TQ09QRV9ERUZBVUxULCBhdHRycyk7DQogCWFzc2VydChyZXMuZXJyb3IgPT0g
MCk7DQogCWFzc2VydChyZXMubXNncy5sZW5ndGggPT0gMyk7DQogCWFzc2VydChyZXMubXNnc1sw
XS5kbiA9PSBzNC5kbigiY249QSIpKTsNCi0JYXNzZXJ0KHJlcy5tc2dzWzBdLm9iamVjdENhdGVn
b3J5ID09IHVuZGVmaW5lZCk7DQorCWFzc2VydChyZXMubXNnc1swXS5kbnNIb3N0TmFtZSA9PSB1
bmRlZmluZWQpOw0KIAlhc3NlcnQocmVzLm1zZ3NbMF0ubGFzdExvZ29uID09ICJ4Iik7DQogCWFz
c2VydChyZXMubXNnc1sxXS5kbiA9PSBzNC5kbigiY249WiIpKTsNCi0JYXNzZXJ0KHJlcy5tc2dz
WzFdLm9iamVjdENhdGVnb3J5ID09ICJ6Iik7DQorCWFzc2VydChyZXMubXNnc1sxXS5kbnNIb3N0
TmFtZSA9PSAieiIpOw0KIAlhc3NlcnQocmVzLm1zZ3NbMV0ubGFzdExvZ29uID09ICJ6Iik7DQog
CWFzc2VydChyZXMubXNnc1syXS5kbiA9PSBzNC5kbigiY249QyIpKTsNCi0JYXNzZXJ0KHJlcy5t
c2dzWzJdLm9iamVjdENhdGVnb3J5ID09IHVuZGVmaW5lZCk7DQorCWFzc2VydChyZXMubXNnc1sy
XS5kbnNIb3N0TmFtZSA9PSB1bmRlZmluZWQpOw0KIAlhc3NlcnQocmVzLm1zZ3NbMl0ubGFzdExv
Z29uID09ICJ6Iik7DQogDQogCS8qIFNlYXJjaCBieSBjb21wbGV4IHBhcnNlIHRyZWUgKi8NCi0J
YXR0cnMgPSBuZXcgQXJyYXkoIm9iamVjdENhdGVnb3J5IiwgImxhc3RMb2dvbiIpOw0KLQlyZXMg
PSBsZGIuc2VhcmNoKCIofCgmKHJldmlzaW9uPXgpKG9iamVjdENhdGVnb3J5PXgpKSghKCYoZGVz
Y3JpcHRpb249eCkobmV4dFJpZD15KSkpKGJhZFB3ZENvdW50PXkpKSIsIE5VTEwsIGxkYi5TQ09Q
RV9ERUZBVUxULCBhdHRycyk7DQorCWF0dHJzID0gbmV3IEFycmF5KCJkbnNIb3N0TmFtZSIsICJs
YXN0TG9nb24iKTsNCisJcmVzID0gbGRiLnNlYXJjaCgiKHwoJihyZXZpc2lvbj14KShkbnNIb3N0
TmFtZT14KSkoISgmKGRlc2NyaXB0aW9uPXgpKG5leHRSaWQ9eSkpKShiYWRQd2RDb3VudD15KSki
LCBOVUxMLCBsZGIuU0NPUEVfREVGQVVMVCwgYXR0cnMpOw0KIAlhc3NlcnQocmVzLmVycm9yID09
IDApOw0KIAlhc3NlcnQocmVzLm1zZ3MubGVuZ3RoID09IDUpOw0KIAlhc3NlcnQocmVzLm1zZ3Nb
MF0uZG4gPT0gczQuZG4oImNuPUIiKSk7DQotCWFzc2VydChyZXMubXNnc1swXS5vYmplY3RDYXRl
Z29yeSA9PSB1bmRlZmluZWQpOw0KKwlhc3NlcnQocmVzLm1zZ3NbMF0uZG5zSG9zdE5hbWUgPT0g
dW5kZWZpbmVkKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzBdLmxhc3RMb2dvbiA9PSAieSIpOw0KIAlh
c3NlcnQocmVzLm1zZ3NbMV0uZG4gPT0gczQuZG4oImNuPVgiKSk7DQotCWFzc2VydChyZXMubXNn
c1sxXS5vYmplY3RDYXRlZ29yeSA9PSAieCIpOw0KKwlhc3NlcnQocmVzLm1zZ3NbMV0uZG5zSG9z
dE5hbWUgPT0gIngiKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzFdLmxhc3RMb2dvbiA9PSAieCIpOw0K
IAlhc3NlcnQocmVzLm1zZ3NbMl0uZG4gPT0gczQuZG4oImNuPUEiKSk7DQotCWFzc2VydChyZXMu
bXNnc1syXS5vYmplY3RDYXRlZ29yeSA9PSB1bmRlZmluZWQpOw0KKwlhc3NlcnQocmVzLm1zZ3Nb
Ml0uZG5zSG9zdE5hbWUgPT0gdW5kZWZpbmVkKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzJdLmxhc3RM
b2dvbiA9PSAieCIpOw0KIAlhc3NlcnQocmVzLm1zZ3NbM10uZG4gPT0gczQuZG4oImNuPVoiKSk7
DQotCWFzc2VydChyZXMubXNnc1szXS5vYmplY3RDYXRlZ29yeSA9PSAieiIpOw0KKwlhc3NlcnQo
cmVzLm1zZ3NbM10uZG5zSG9zdE5hbWUgPT0gInoiKTsNCiAJYXNzZXJ0KHJlcy5tc2dzWzNdLmxh
c3RMb2dvbiA9PSAieiIpOw0KIAlhc3NlcnQocmVzLm1zZ3NbNF0uZG4gPT0gczQuZG4oImNuPUMi
KSk7DQotCWFzc2VydChyZXMubXNnc1s0XS5vYmplY3RDYXRlZ29yeSA9PSB1bmRlZmluZWQpOw0K
Kwlhc3NlcnQocmVzLm1zZ3NbNF0uZG5zSG9zdE5hbWUgPT0gdW5kZWZpbmVkKTsNCiAJYXNzZXJ0
KHJlcy5tc2dzWzRdLmxhc3RMb2dvbiA9PSAieiIpOw0KIA0KIAkvKiBDbGVhbiB1cCAqLw0KSW5k
ZXg6IHRlc3Rwcm9ncy9lanMvbGRhcC5qcw0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KLS0tIHRlc3Rwcm9ncy9lanMv
bGRhcC5qcwkocmV2aXNpb24gMjM1NTApDQorKysgdGVzdHByb2dzL2Vqcy9sZGFwLmpzCSh3b3Jr
aW5nIGNvcHkpDQpAQCAtMjUsNyArMjUsNyBAQA0KIA0KIHZhciBob3N0ID0gb3B0aW9ucy5BUkdW
WzBdOw0KIA0KLWZ1bmN0aW9uIGJhc2ljX3Rlc3RzKGxkYiwgZ2NfbGRiLCBiYXNlX2RuLCBjb25m
aWd1cmF0aW9uX2RuKQ0KK2Z1bmN0aW9uIGJhc2ljX3Rlc3RzKGxkYiwgZ2NfbGRiLCBiYXNlX2Ru
LCBjb25maWd1cmF0aW9uX2RuLCBzY2hlbWFfZG4pDQogew0KIAlwcmludGxuKCJSdW5uaW5nIGJh
c2ljIHRlc3RzIik7DQogDQpAQCAtNDczLDYgKzQ3MywzMyBAQA0KIAlhc3NlcnQocmVzLmVycm9y
ID09IDApOw0KIAlhc3NlcnQgKHJlcy5tc2dzLmxlbmd0aCA+IDApOw0KIA0KKwlwcmludGxuKCJU
ZXN0aW5nIG9iamVjdENhdGVnb3J5IGNhbm9uYWNvbGlzYXRpb24iKTsNCisJdmFyIGF0dHJzID0g
bmV3IEFycmF5KCJjbiIpOw0KKwl2YXIgcmVzID0gbGRiLnNlYXJjaCgib2JqZWN0Q2F0ZWdvcnk9
bnREc0RTQSIsIGNvbmZpZ3VyYXRpb25fZG4sIGxkYi5TQ09QRV9TVUJUUkVFLCBhdHRycyk7DQor
CWFzc2VydChyZXMuZXJyb3IgPT0gMCk7DQorCWlmIChyZXMubXNncy5sZW5ndGggPT0gMCkgew0K
KwkJcHJpbnRsbigiRGlkbid0IGZpbmQgYW55IHJlY29yZHMgd2l0aCBvYmplY3RDYXRlZ29yeT1u
dERzRFNBIik7DQorCX0NCisJYXNzZXJ0KHJlcy5tc2dzLmxlbmd0aCAhPSAwKTsNCisJDQorCXZh
ciBhdHRycyA9IG5ldyBBcnJheSgiY24iKTsNCisJdmFyIHJlcyA9IGxkYi5zZWFyY2goIm9iamVj
dENhdGVnb3J5PUNOPW50RHMtRFNBLCIgKyBzY2hlbWFfZG4sIGNvbmZpZ3VyYXRpb25fZG4sIGxk
Yi5TQ09QRV9TVUJUUkVFLCBhdHRycyk7DQorCWFzc2VydChyZXMuZXJyb3IgPT0gMCk7DQorCWlm
IChyZXMubXNncy5sZW5ndGggPT0gMCkgew0KKwkJcHJpbnRsbigiRGlkbid0IGZpbmQgYW55IHJl
Y29yZHMgd2l0aCBvYmplY3RDYXRlZ29yeT1DTj1udERzLURTQSwiICsgc2NoZW1hX2RuKTsNCisJ
fQ0KKwlhc3NlcnQocmVzLm1zZ3MubGVuZ3RoICE9IDApOw0KKwkNCisJcHJpbnRsbigiVGVzdGlu
ZyBvYmplY3RDbGFzcyBhdHRyaWJ1dGUgb3JkZXIgb24gIisgYmFzZV9kbik7DQorCXZhciBhdHRy
cyA9IG5ldyBBcnJheSgib2JqZWN0Y2xhc3MiKTsNCisJdmFyIHJlcyA9IGxkYi5zZWFyY2goIm9i
amVjdENsYXNzPWRvbWFpbiIsIGJhc2VfZG4sIGxkYi5TQ09QRV9CQVNFLCBhdHRycyk7DQorCWFz
c2VydChyZXMuZXJyb3IgPT0gMCk7DQorCWFzc2VydChyZXMubXNncy5sZW5ndGggPT0gMSk7DQor
DQorCWFzc2VydChyZXMubXNnc1swXS5vYmplY3RDbGFzc1swXSA9PSAidG9wIik7DQorCWFzc2Vy
dChyZXMubXNnc1swXS5vYmplY3RDbGFzc1sxXSA9PSAiZG9tYWluIik7DQorCWFzc2VydChyZXMu
bXNnc1swXS5vYmplY3RDbGFzc1syXSA9PSAiZG9tYWluRE5TIik7DQorCQ0KIH0NCiANCiBmdW5j
dGlvbiBiYXNlZG5fdGVzdHMobGRiLCBnY19sZGIpDQpAQCAtNTIyLDYgKzU0OSwxNSBAQA0KICAg
ICByZXR1cm4gcmVzLm1zZ3NbMF0uY29uZmlndXJhdGlvbk5hbWluZ0NvbnRleHQ7DQogfQ0KIA0K
K2Z1bmN0aW9uIGZpbmRfc2NoZW1hZG4obGRiKQ0KK3sNCisgICAgdmFyIGF0dHJzID0gbmV3IEFy
cmF5KCJzY2hlbWFOYW1pbmdDb250ZXh0Iik7DQorICAgIHZhciByZXMgPSBsZGIuc2VhcmNoKCIi
LCAiIiwgbGRiLlNDT1BFX0JBU0UsIGF0dHJzKTsNCisgICAgYXNzZXJ0KHJlcy5lcnJvciA9PSAw
KTsNCisgICAgYXNzZXJ0KHJlcy5tc2dzLmxlbmd0aCA9PSAxKTsNCisgICAgcmV0dXJuIHJlcy5t
c2dzWzBdLnNjaGVtYU5hbWluZ0NvbnRleHQ7DQorfQ0KKw0KIC8qIHVzZSBjb21tYW5kIGxpbmUg
Y3JlZHMgaWYgYXZhaWxhYmxlICovDQogbGRiLmNyZWRlbnRpYWxzID0gb3B0aW9ucy5nZXRfY3Jl
ZGVudGlhbHMoKTsNCiBnY19sZGIuY3JlZGVudGlhbHMgPSBvcHRpb25zLmdldF9jcmVkZW50aWFs
cygpOw0KQEAgLTUyOSw2ICs1NjUsNyBAQA0KIHZhciBvayA9IGxkYi5jb25uZWN0KCJsZGFwOi8v
IiArIGhvc3QpOw0KIHZhciBiYXNlX2RuID0gZmluZF9iYXNlZG4obGRiKTsNCiB2YXIgY29uZmln
dXJhdGlvbl9kbiA9IGZpbmRfY29uZmlndXJhdGlvbmRuKGxkYik7DQordmFyIHNjaGVtYV9kbiA9
IGZpbmRfc2NoZW1hZG4obGRiKTsNCiANCiBwcmludGYoImJhc2VETjogJXNcbiIsIGJhc2VfZG4p
Ow0KIA0KQEAgLTUzNyw3ICs1NzQsNyBAQA0KIAlnY19sZGIgPSB1bmRlZmluZWQ7DQogfQ0KIA0K
LWJhc2ljX3Rlc3RzKGxkYiwgZ2NfbGRiLCBiYXNlX2RuLCBjb25maWd1cmF0aW9uX2RuKQ0KK2Jh
c2ljX3Rlc3RzKGxkYiwgZ2NfbGRiLCBiYXNlX2RuLCBjb25maWd1cmF0aW9uX2RuLCBzY2hlbWFf
ZG4pDQogDQogYmFzZWRuX3Rlc3RzKGxkYiwgZ2NfbGRiKQ0KIA0KSW5kZXg6IHNvdXJjZS9zZXR1
cC9wcm92aXNpb25fcGFydGl0aW9ucy5sZGlmDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQotLS0gc291cmNlL3NldHVw
L3Byb3Zpc2lvbl9wYXJ0aXRpb25zLmxkaWYJKHJldmlzaW9uIDIzNTUxKQ0KKysrIHNvdXJjZS9z
ZXR1cC9wcm92aXNpb25fcGFydGl0aW9ucy5sZGlmCSh3b3JraW5nIGNvcHkpDQpAQCAtNSw5ICs1
LDkgQEANCiByZXBsaWNhdGVFbnRyaWVzOiBAU1VCQ0xBU1NFUw0KIHJlcGxpY2F0ZUVudHJpZXM6
IEBBVFRSSUJVVEVTDQogcmVwbGljYXRlRW50cmllczogQElOREVYTElTVA0KLW1vZHVsZXM6JHtT
Q0hFTUFETn06JHtTQ0hFTUFETl9NT0R9DQotbW9kdWxlczoke0NPTkZJR0ROfToke0NPTkZJR0RO
X01PRH0NCi1tb2R1bGVzOiR7RE9NQUlORE59OiR7RE9NQUlORE5fTU9EfQ0KK21vZHVsZXM6JHtT
Q0hFTUFETn06JHtTQ0hFTUFETl9NT0R9JHtTQ0hFTUFETl9NT0QyfQ0KK21vZHVsZXM6JHtDT05G
SUdETn06JHtDT05GSUdETl9NT0R9JHtDT05GSUdETl9NT0QyfQ0KK21vZHVsZXM6JHtET01BSU5E
Tn06JHtET01BSU5ETl9NT0R9JHtET01BSU5ETl9NT0QyfQ0KIA0KIGRuOiBATU9EVUxFUw0KIEBM
SVNUOiAke01PRFVMRVNfTElTVH0NCkluZGV4OiBzb3VyY2Uvc2V0dXAvcHJvdmlzaW9uDQo9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09DQotLS0gc291cmNlL3NldHVwL3Byb3Zpc2lvbgkocmV2aXNpb24gMjM1NTEpDQorKysg
c291cmNlL3NldHVwL3Byb3Zpc2lvbgkod29ya2luZyBjb3B5KQ0KQEAgLTEzMiwxMSArMTMyLDEx
IEBADQogCQlzdWJvYmpbIkxEQVBNT0RVTEUiXSA9ICJlbnRyeVVVSUQiOw0KIAl9DQogCXN1Ym9i
alsiRE9NQUlORE5fTERCIl0gPSBzdWJvYmpbIkxEQVBCQUNLRU5EIl07DQotCXN1Ym9ialsiRE9N
QUlORE5fTU9EIl0gPSBzdWJvYmpbIkxEQVBNT0RVTEUiXSArICIscGFnZWRfc2VhcmNoZXMiOw0K
KwlzdWJvYmpbIkRPTUFJTkROX01PRDIiXSA9IHN1Ym9ialsiTERBUE1PRFVMRSJdICsgIixwYWdl
ZF9zZWFyY2hlcyI7DQogCXN1Ym9ialsiQ09ORklHRE5fTERCIl0gPSBzdWJvYmpbIkxEQVBCQUNL
RU5EIl07DQotCXN1Ym9ialsiQ09ORklHRE5fTU9EIl0gPSBzdWJvYmpbIkxEQVBNT0RVTEUiXSAr
ICIscGFnZWRfc2VhcmNoZXMiOw0KKwlzdWJvYmpbIkNPTkZJR0ROX01PRDIiXSA9IHN1Ym9ialsi
TERBUE1PRFVMRSJdICsgIixwYWdlZF9zZWFyY2hlcyI7DQogCXN1Ym9ialsiU0NIRU1BRE5fTERC
Il0gPSBzdWJvYmpbIkxEQVBCQUNLRU5EIl07DQotCXN1Ym9ialsiU0NIRU1BRE5fTU9EIl0gPSBz
dWJvYmpbIkxEQVBNT0RVTEUiXSArICIscGFnZWRfc2VhcmNoZXMiOw0KKwlzdWJvYmpbIlNDSEVN
QUROX01PRDIiXSA9IHN1Ym9ialsiTERBUE1PRFVMRSJdICsgIixwYWdlZF9zZWFyY2hlcyI7DQog
fQ0KIA0KIGlmICghcHJvdmlzaW9uX3ZhbGlkYXRlKHN1Ym9iaiwgbWVzc2FnZSkpIHsNCkluZGV4
OiBzb3VyY2Uvc2V0dXAvcHJvdmlzaW9uX3NjaGVtYV9iYXNlZG5fbW9kaWZ5LmxkaWYNCj09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0NCi0tLSBzb3VyY2Uvc2V0dXAvcHJvdmlzaW9uX3NjaGVtYV9iYXNlZG5fbW9kaWZ5Lmxk
aWYJKHJldmlzaW9uIDIzNTUxKQ0KKysrIHNvdXJjZS9zZXR1cC9wcm92aXNpb25fc2NoZW1hX2Jh
c2Vkbl9tb2RpZnkubGRpZgkod29ya2luZyBjb3B5KQ0KQEAgLTIzLDMgKzIzLDIxIEBADQogLQ0K
IHJlcGxhY2U6IG9iamVjdFZlcnNpb24NCiBvYmplY3RWZXJzaW9uOiAzMA0KKy0NCityZXBsYWNl
OiBwcmVmaXhNYXANCitwcmVmaXhNYXA6OiBRa1JUUkFBQUFBQWlBQUFBQUFBQ0FDSUFBQUFBQUFB
QUFnQUFBQVFBQWdBQkFBQUFBZ0FBQUFnQUFnQUNBQUFBQ0ENCisgQUFBQXdBQWdBREFBQUFDQUFB
QUJBQUFnQUVBQUFBQ0FBQUFCUUFBZ0FGQUFBQUNBQUFBQmdBQWdBR0FBQUFDQUFBQUJ3QUFnQUhB
QUENCisgQUNBQUFBQ0FBQWdBSUFBQUFBZ0FBQUNRQUFnQUpBQUFBQ0FBQUFDZ0FBZ0FLQUFBQUNB
QUFBQ3dBQWdBVEFBQUFDQUFBQURBQUFnQVUNCisgQUFBQUNBQUFBRFFBQWdBVkFBQUFDUUFBQURn
QUFnQVdBQUFBQ1FBQUFEd0FBZ0FYQUFBQUNnQUFBRUFBQWdBWUFBQUFBZ0FBQUVRQUENCisgZ0Fa
QUFBQUFnQUFBRWdBQWdBYUFBQUFBZ0FBQUV3QUFnQUxBQUFBQ2dBQUFGQUFBZ0FNQUFBQUNRQUFB
RlFBQWdBTkFBQUFDZ0FBQUYNCisgZ0FBZ0FPQUFBQUNRQUFBRndBQWdBUEFBQUFDZ0FBQUdBQUFn
QVFBQUFBQ1FBQUFHUUFBZ0FSQUFBQUNRQUFBR2dBQWdBU0FBQUFDZ0ENCisgQUFHd0FBZ0FiQUFB
QUNRQUFBSEFBQWdBY0FBQUFDUUFBQUhRQUFnQWRBQUFBQ0FBQUFIZ0FBZ0FlQUFBQUNBQUFBSHdB
QWdBZkFBQUENCisgQ1FBQUFJQUFBZ0FnQUFBQUNRQUFBSVFBQWdBaEFBQUFDUUFBQUlnQUFnQUNB
QUFBVlFRQUFBSUFBQUJWQmdBQUNBQUFBQ3FHU0liM0YNCisgQUVDQ0FBQUFDcUdTSWIzRkFFRENB
QUFBR0NHU0FGbEFnSUJDQUFBQUdDR1NBRmxBZ0lEQ0FBQUFHQ0dTQUZsQWdFRkNBQUFBR0NHU0EN
CisgRmxBZ0VFQWdBQUFGVUZBQUFJQUFBQUtvWklodmNVQVFRSUFBQUFLb1pJaHZjVUFRVUlBQUFB
Q1pJbWlaUHlMR1FJQUFBQVlJWklBWWINCisgNFFnTUpBQUFBQ1pJbWlaUHlMR1FCQUFBQUNRQUFB
R0NHU0FHRytFSURBUUFBQUFvQUFBQXFoa2lHOXhRQkJiWllBQUFDQUFBQVZSVUENCisgQUFJQUFB
QlZFZ0FBQWdBQUFGVVVBQUFLQUFBQUtvWklodmNVQVFTQ0JBQUFDUUFBQUNxR1NJYjNGQUVGT0FB
QUFBb0FBQUFxaGtpRzkNCisgeFFCQklJR0FBQUpBQUFBS29aSWh2Y1VBUVU1QUFBQUNnQUFBQ3FH
U0liM0ZBRUVnZ2NBQUFrQUFBQXFoa2lHOXhRQkJUb0FBQUFKQUENCisgQUFLb1pJaHZjVUFRVkpB
QUFBQ2dBQUFDcUdTSWIzRkFFRWdqRUFBQWtBQUFBckJnRUVBWXM2WlhjQUFBQUpBQUFBWUlaSUFZ
YjRRZ00NCisgQ0FBQUFDQUFBQUNzR0FRUUJnWG9CQ0FBQUFDcUdTSWIzRFFFSkNRQUFBQW1TSm9t
VDhpeGtCQUFBQUFrQUFBQXJCZ0VFQWJkOUJBRUENCisgQUFBSkFBQUFLd1lCQkFHM2ZRUUMNCklu
ZGV4OiBzb3VyY2UvZHNkYi9zY2hlbWEvc2NoZW1hX2luaXQuYw0KPT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KLS0tIHNv
dXJjZS9kc2RiL3NjaGVtYS9zY2hlbWFfaW5pdC5jCShyZXZpc2lvbiAyMzU1MSkNCisrKyBzb3Vy
Y2UvZHNkYi9zY2hlbWEvc2NoZW1hX2luaXQuYwkod29ya2luZyBjb3B5KQ0KQEAgLTMyMyw2ICsz
MjMsMzQgQEANCiAJdGFsbG9jX3N0ZWFsKG1lbV9jdHgsIChwKS0+ZWxlbSk7IFwNCiB9IHdoaWxl
ICgwKQ0KIA0KKyNkZWZpbmUgR0VUX1NUUklOR19MSVNUX0xEQihtc2csIGF0dHIsIG1lbV9jdHgs
IHAsIGVsZW0sIHN0cmljdCkgZG8gewlcDQorCWludCBnZXRfc3RyaW5nX2xpc3RfY291bnRlcjsJ
CQkJCVwNCisJc3RydWN0IGxkYl9tZXNzYWdlX2VsZW1lbnQgKmdldF9zdHJpbmdfbGlzdF9lbCA9
IGxkYl9tc2dfZmluZF9lbGVtZW50KG1zZywgYXR0cik7IFwNCisJaWYgKGdldF9zdHJpbmdfbGlz
dF9lbCA9PSBOVUxMKSB7CQkJCVwNCisJCWlmIChzdHJpY3QpIHsJCQkJCQlcDQorCQkJZF9wcmlu
dGYoIiVzOiAlcyA9PSBOVUxMXG4iLCBfX2xvY2F0aW9uX18sIGF0dHIpOyBcDQorCQkJcmV0dXJu
IFdFUlJfSU5WQUxJRF9QQVJBTTsJCQlcDQorCQl9IGVsc2UgewkJCQkJCVwNCisJCQkocCktPmVs
ZW0gPSBOVUxMOwkJCQlcDQorCQkJYnJlYWs7CQkJCQkJXA0KKwkJfQkJCQkJCQlcDQorCX0JCQkJ
CQkJCVwNCisJKHApLT5lbGVtID0gdGFsbG9jX2FycmF5KG1lbV9jdHgsIGNvbnN0IGNoYXIgKiwg
Z2V0X3N0cmluZ19saXN0X2VsLT5udW1fdmFsdWVzICsgMSk7IFwNCisgICAgICAgIGZvciAoZ2V0
X3N0cmluZ19saXN0X2NvdW50ZXI9MDsJCQkJCVwNCisJICAgICBnZXRfc3RyaW5nX2xpc3RfY291
bnRlciA8IGdldF9zdHJpbmdfbGlzdF9lbC0+bnVtX3ZhbHVlczsJXA0KKwkgICAgIGdldF9zdHJp
bmdfbGlzdF9jb3VudGVyKyspIHsJCQkJXA0KKwkJKHApLT5lbGVtW2dldF9zdHJpbmdfbGlzdF9j
b3VudGVyXSA9IHRhbGxvY19zdHJuZHVwKChwKS0+ZWxlbSwgXA0KKwkJCQkJCQkJICAgIChjb25z
dCBjaGFyICopZ2V0X3N0cmluZ19saXN0X2VsLT52YWx1ZXNbZ2V0X3N0cmluZ19saXN0X2NvdW50
ZXJdLmRhdGEsIFwNCisJCQkJCQkJCSAgICBnZXRfc3RyaW5nX2xpc3RfZWwtPnZhbHVlc1tnZXRf
c3RyaW5nX2xpc3RfY291bnRlcl0ubGVuZ3RoKTsgXA0KKwkJaWYgKCEocCktPmVsZW1bZ2V0X3N0
cmluZ19saXN0X2NvdW50ZXJdKSB7CQlcDQorCQkJZF9wcmludGYoIiVzOiB0YWxsb2Nfc3RybmR1
cCBmYWlsZWQgZm9yICVzXG4iLCBfX2xvY2F0aW9uX18sIGF0dHIpOyBcDQorCQkJcmV0dXJuIFdF
UlJfTk9NRU07CQkJCVwNCisJCX0JCQkJCQkJXA0KKwkJKHApLT5lbGVtW2dldF9zdHJpbmdfbGlz
dF9jb3VudGVyKzFdID0gTlVMTDsJCVwNCisJfQkJCQkJCQkJXA0KKwl0YWxsb2Nfc3RlYWwobWVt
X2N0eCwgKHApLT5lbGVtKTsJCQkJXA0KK30gd2hpbGUgKDApDQorDQogI2RlZmluZSBHRVRfQk9P
TF9MREIobXNnLCBhdHRyLCBwLCBlbGVtLCBzdHJpY3QpIGRvIHsgXA0KIAljb25zdCBjaGFyICpz
dHI7IFwNCiAJc3RyID0gc2FtZGJfcmVzdWx0X3N0cmluZyhtc2csIGF0dHIsIE5VTEwpO1wNCkBA
IC00NjYsMTQgKzQ5NCwxNSBAQA0KIA0KIAlvYmotPnN5c3RlbUF1eGlsaWFyeUNsYXNzCT0gTlVM
TDsNCiAJb2JqLT5zeXN0ZW1Qb3NzU3VwZXJpb3JzCT0gTlVMTDsNCi0Jb2JqLT5zeXN0ZW1NdXN0
Q29udGFpbgkJPSBOVUxMOw0KLQlvYmotPnN5c3RlbU1heUNvbnRhaW4JCT0gTlVMTDsNCiANCiAJ
b2JqLT5hdXhpbGlhcnlDbGFzcwkJPSBOVUxMOw0KIAlvYmotPnBvc3NTdXBlcmlvcnMJCT0gTlVM
TDsNCi0Jb2JqLT5tdXN0Q29udGFpbgkJPSBOVUxMOw0KLQlvYmotPm1heUNvbnRhaW4JCQk9IE5V
TEw7DQogDQorCUdFVF9TVFJJTkdfTElTVF9MREIobXNnLCAic3lzdGVtTXVzdENvbnRhaW4iLCBt
ZW1fY3R4LCBvYmosIHN5c3RlbU11c3RDb250YWluLCBGYWxzZSk7DQorCUdFVF9TVFJJTkdfTElT
VF9MREIobXNnLCAic3lzdGVtTWF5Q29udGFpbiIsIG1lbV9jdHgsIG9iaiwgc3lzdGVtTWF5Q29u
dGFpbiwgRmFsc2UpOw0KKwlHRVRfU1RSSU5HX0xJU1RfTERCKG1zZywgIm11c3RDb250YWluIiwg
bWVtX2N0eCwgb2JqLCBtdXN0Q29udGFpbiwgRmFsc2UpOw0KKwlHRVRfU1RSSU5HX0xJU1RfTERC
KG1zZywgIm1heUNvbnRhaW4iLCBtZW1fY3R4LCBvYmosIG1heUNvbnRhaW4sIEZhbHNlKTsNCisN
CiAJR0VUX1NUUklOR19MREIobXNnLCAiZGVmYXVsdFNlY3VyaXR5RGVzY3JpcHRvciIsIG1lbV9j
dHgsIG9iaiwgZGVmYXVsdFNlY3VyaXR5RGVzY3JpcHRvciwgRmFsc2UpOw0KIA0KIAlHRVRfVUlO
VDMyX0xEQihtc2csICJzY2hlbWFGbGFnc0V4Iiwgb2JqLCBzY2hlbWFGbGFnc0V4KTsNCkBAIC05
MzAsNiArOTU5LDIzIEBADQogCXJldHVybiBOVUxMOw0KIH0NCiANCitjb25zdCBzdHJ1Y3QgZHNk
Yl9jbGFzcyAqZHNkYl9jbGFzc19ieV9jbihjb25zdCBzdHJ1Y3QgZHNkYl9zY2hlbWEgKnNjaGVt
YSwNCisJCQkJCSAgY29uc3QgY2hhciAqY24pDQorew0KKwlzdHJ1Y3QgZHNkYl9jbGFzcyAqY3Vy
Ow0KKw0KKwlpZiAoIWNuKSByZXR1cm4gTlVMTDsNCisNCisJLyogVE9ETzogYWRkIGJpbmFyeSBz
ZWFyY2ggKi8NCisJZm9yIChjdXIgPSBzY2hlbWEtPmNsYXNzZXM7IGN1cjsgY3VyID0gY3VyLT5u
ZXh0KSB7DQorCQlpZiAoc3RyY2FzZWNtcChjdXItPmNuLCBjbikgIT0gMCkgY29udGludWU7DQor
DQorCQlyZXR1cm4gY3VyOw0KKwl9DQorDQorCXJldHVybiBOVUxMOw0KK30NCisNCiBjb25zdCBj
aGFyICpkc2RiX2xEQVBEaXNwbGF5TmFtZV9ieV9pZChjb25zdCBzdHJ1Y3QgZHNkYl9zY2hlbWEg
KnNjaGVtYSwNCiAJCQkJICAgICAgIHVpbnQzMl90IGlkKQ0KIHsNCkBAIC05NjQsNiArMTAxMCwy
MiBAQA0KIAlyZXR1cm4gTERCX1NVQ0NFU1M7DQogfQ0KIA0KK3N0YXRpYyBzdHJ1Y3QgZHNkYl9z
Y2hlbWEgKmdsb2JhbF9zY2hlbWE7DQorDQoraW50IGRzZGJfc2V0X2dsb2JhbF9zY2hlbWEoc3Ry
dWN0IGxkYl9jb250ZXh0ICpsZGIpDQorew0KKwlpbnQgcmV0Ow0KKwlpZiAoIWdsb2JhbF9zY2hl
bWEpIHsNCisJICByZXR1cm4gTERCX1NVQ0NFU1M7DQorCX0NCisJcmV0ID0gbGRiX3NldF9vcGFx
dWUobGRiLCAiZHNkYl9zY2hlbWEiLCBnbG9iYWxfc2NoZW1hKTsNCisJaWYgKHJldCAhPSBMREJf
U1VDQ0VTUykgew0KKwkJcmV0dXJuIHJldDsNCisJfQ0KKw0KKwlyZXR1cm4gTERCX1NVQ0NFU1M7
DQorfQ0KKw0KIGNvbnN0IHN0cnVjdCBkc2RiX3NjaGVtYSAqZHNkYl9nZXRfc2NoZW1hKHN0cnVj
dCBsZGJfY29udGV4dCAqbGRiKQ0KIHsNCiAJY29uc3Qgdm9pZCAqcDsNCkBAIC05ODMsNiArMTA0
NSwyNiBAQA0KIAlyZXR1cm4gc2NoZW1hOw0KIH0NCiANCit2b2lkIGRzZGJfbWFrZV9zY2hlbWFf
Z2xvYmFsKHN0cnVjdCBsZGJfY29udGV4dCAqbGRiKQ0KK3sNCisJY29uc3Qgdm9pZCAqcDsNCisJ
Y29uc3Qgc3RydWN0IGRzZGJfc2NoZW1hICpzY2hlbWE7DQorDQorCS8qIHNlZSBpZiB3ZSBoYXZl
IGEgY2FjaGVkIGNvcHkgKi8NCisJcCA9IGxkYl9nZXRfb3BhcXVlKGxkYiwgImRzZGJfc2NoZW1h
Iik7DQorCWlmICghcCkgew0KKwkJcmV0dXJuOw0KKwl9DQorDQorCXNjaGVtYSA9IHRhbGxvY19n
ZXRfdHlwZShwLCBzdHJ1Y3QgZHNkYl9zY2hlbWEpOw0KKwlpZiAoIXNjaGVtYSkgew0KKwkJcmV0
dXJuOw0KKwl9DQorDQorCXRhbGxvY19zdGVhbChOVUxMLCBzY2hlbWEpOw0KKwlnbG9iYWxfc2No
ZW1hID0gc2NoZW1hOw0KK30NCisNCiBXRVJST1IgZHNkYl9hdHRhY2hfc2NoZW1hX2Zyb21fbGRp
Zl9maWxlKHN0cnVjdCBsZGJfY29udGV4dCAqbGRiLCBjb25zdCBjaGFyICpwZiwgY29uc3QgY2hh
ciAqZGYpDQogew0KIAlzdHJ1Y3QgbGRiX2xkaWYgKmxkaWY7DQpJbmRleDogc291cmNlL2RzZGIv
c2FtZGIvc2FtZGIuYw0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PQ0KLS0tIHNvdXJjZS9kc2RiL3NhbWRiL3NhbWRiLmMJ
KHJldmlzaW9uIDIzNTUxKQ0KKysrIHNvdXJjZS9kc2RiL3NhbWRiL3NhbWRiLmMJKHdvcmtpbmcg
Y29weSkNCkBAIC01MCw2ICs1MCw3IEBADQogCWlmICghbGRiKSB7DQogCQlyZXR1cm4gTlVMTDsN
CiAJfQ0KKwlkc2RiX21ha2Vfc2NoZW1hX2dsb2JhbChsZGIpOw0KIAlyZXR1cm4gbGRiOw0KIH0N
CiANCkluZGV4OiBzb3VyY2UvZHNkYi9zYW1kYi9sZGJfbW9kdWxlcy9zY2hlbWFfZnNtby5jDQo9
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09DQotLS0gc291cmNlL2RzZGIvc2FtZGIvbGRiX21vZHVsZXMvc2NoZW1hX2ZzbW8u
YwkocmV2aXNpb24gMjM1NTEpDQorKysgc291cmNlL2RzZGIvc2FtZGIvbGRiX21vZHVsZXMvc2No
ZW1hX2ZzbW8uYwkod29ya2luZyBjb3B5KQ0KQEAgLTU0LDYgKzU0LDEwIEBADQogCQlOVUxMDQog
CX07DQogDQorCWlmIChkc2RiX2dldF9zY2hlbWEobW9kdWxlLT5sZGIpKSB7DQorCSAgcmV0dXJu
IGxkYl9uZXh0X2luaXQobW9kdWxlKTsNCisJfQ0KKw0KIAlzY2hlbWFfZG4gPSBzYW1kYl9zY2hl
bWFfZG4obW9kdWxlLT5sZGIpOw0KIAlpZiAoIXNjaGVtYV9kbikgew0KIAkJbGRiX2RlYnVnKG1v
ZHVsZS0+bGRiLCBMREJfREVCVUdfV0FSTklORywNCkluZGV4OiBzb3VyY2UvZHNkYi9zYW1kYi9s
ZGJfbW9kdWxlcy9rbHVkZ2VfYWNsLmMNCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCi0tLSBzb3VyY2UvZHNkYi9zYW1k
Yi9sZGJfbW9kdWxlcy9rbHVkZ2VfYWNsLmMJKHJldmlzaW9uIDIzNTUxKQ0KKysrIHNvdXJjZS9k
c2RiL3NhbWRiL2xkYl9tb2R1bGVzL2tsdWRnZV9hY2wuYwkod29ya2luZyBjb3B5KQ0KQEAgLTM3
LDYgKzM3LDcgQEANCiAjaW5jbHVkZSAibGRiL2luY2x1ZGUvbGRiX3ByaXZhdGUuaCINCiAjaW5j
bHVkZSAiYXV0aC9hdXRoLmgiDQogI2luY2x1ZGUgImxpYmNsaS9zZWN1cml0eS9zZWN1cml0eS5o
Ig0KKyNpbmNsdWRlICJkc2RiL3NhbWRiL3NhbWRiLmgiDQogDQogLyogS2x1ZGdlIEFDTCBydWxl
czoNCiAgKg0KQEAgLTEwNSwxMyArMTA2LDc0IEBADQogCWludCAoKnVwX2NhbGxiYWNrKShzdHJ1
Y3QgbGRiX2NvbnRleHQgKiwgdm9pZCAqLCBzdHJ1Y3QgbGRiX3JlcGx5ICopOw0KIA0KIAllbnVt
IHVzZXJfaXMgdXNlcl90eXBlOw0KKwlib29sIGFsbG93ZWRBdHRyaWJ1dGVzOw0KKwlib29sIGFs
bG93ZWRBdHRyaWJ1dGVzRWZmZWN0aXZlOw0KKwljb25zdCBjaGFyICoqYXR0cnM7DQogfTsNCiAN
CisvKiByZWFkIGFsbCBvYmplY3RDbGFzc2VzICovDQorDQorc3RhdGljIGludCBrbHVkZ2VfYWNs
X2FsbG93ZWRBdHRyaWJ1dGVzKHN0cnVjdCBsZGJfY29udGV4dCAqbGRiLCBzdHJ1Y3QgbGRiX21l
c3NhZ2UgKm1zZywNCisJCQkJCQkJIGNvbnN0IGNoYXIgKmF0dHJOYW1lKSANCit7DQorCXN0cnVj
dCBsZGJfbWVzc2FnZV9lbGVtZW50ICpvY19lbCA9IGxkYl9tc2dfZmluZF9lbGVtZW50KG1zZywg
Im9iamVjdENsYXNzIik7DQorCXN0cnVjdCBsZGJfbWVzc2FnZV9lbGVtZW50ICphbGxvd2VkQXR0
cmlidXRlczsNCisJY29uc3Qgc3RydWN0IGRzZGJfc2NoZW1hICpzY2hlbWEgPSBkc2RiX2dldF9z
Y2hlbWEobGRiKTsNCisJY29uc3Qgc3RydWN0IGRzZGJfY2xhc3MgKmNsYXNzOw0KKwlpbnQgaSwg
aiwgcmV0Ow0KKwlyZXQgPSBsZGJfbXNnX2FkZF9lbXB0eShtc2csIGF0dHJOYW1lLCAwLCAmYWxs
b3dlZEF0dHJpYnV0ZXMpOw0KKwlpZiAocmV0ICE9IExEQl9TVUNDRVNTKSB7DQorCQlyZXR1cm4g
cmV0Ow0KKwl9DQorCQ0KKwlmb3IgKGk9MDsgaSA8IG9jX2VsLT5udW1fdmFsdWVzOyBpKyspIHsN
CisJCWNsYXNzID0gZHNkYl9jbGFzc19ieV9sREFQRGlzcGxheU5hbWUoc2NoZW1hLCAoY29uc3Qg
Y2hhciAqKW9jX2VsLT52YWx1ZXNbaV0uZGF0YSk7DQorCQlpZiAoIWNsYXNzKSB7DQorCQkJLyog
V2UgZG9uJ3Qga25vdyB0aGlzIGNsYXNzPyAgd2hhdCBpcyBnb2luZyBvbj8gKi8NCisJCQljb250
aW51ZTsNCisJCX0NCisJCWZvciAoaj0wOyBjbGFzcy0+bWF5Q29udGFpbiAmJiBjbGFzcy0+bWF5
Q29udGFpbltqXTsgaisrKSB7DQorCQkJbGRiX21zZ19hZGRfc3RyaW5nKG1zZywgYXR0ck5hbWUs
IGNsYXNzLT5tYXlDb250YWluW2pdKTsNCisJCX0NCisJCWZvciAoaj0wOyBjbGFzcy0+bXVzdENv
bnRhaW4gJiYgY2xhc3MtPm11c3RDb250YWluW2pdOyBqKyspIHsNCisJCQlsZGJfbXNnX2FkZF9z
dHJpbmcobXNnLCBhdHRyTmFtZSwgY2xhc3MtPm11c3RDb250YWluW2pdKTsNCisJCX0NCisJCWZv
ciAoaj0wOyBjbGFzcy0+c3lzdGVtTWF5Q29udGFpbiAmJiBjbGFzcy0+c3lzdGVtTWF5Q29udGFp
bltqXTsgaisrKSB7DQorCQkJbGRiX21zZ19hZGRfc3RyaW5nKG1zZywgYXR0ck5hbWUsIGNsYXNz
LT5zeXN0ZW1NYXlDb250YWluW2pdKTsNCisJCX0NCisJCWZvciAoaj0wOyBjbGFzcy0+c3lzdGVt
TXVzdENvbnRhaW4gJiYgY2xhc3MtPnN5c3RlbU11c3RDb250YWluW2pdOyBqKyspIHsNCisJCQls
ZGJfbXNnX2FkZF9zdHJpbmcobXNnLCBhdHRyTmFtZSwgY2xhc3MtPnN5c3RlbU11c3RDb250YWlu
W2pdKTsNCisJCX0NCisJfQ0KKwkJDQorCWlmIChhbGxvd2VkQXR0cmlidXRlcy0+bnVtX3ZhbHVl
cyA+IDEpIHsNCisJCXFzb3J0KGFsbG93ZWRBdHRyaWJ1dGVzLT52YWx1ZXMsIA0KKwkJICAgICAg
YWxsb3dlZEF0dHJpYnV0ZXMtPm51bV92YWx1ZXMsIA0KKwkJICAgICAgc2l6ZW9mKCphbGxvd2Vk
QXR0cmlidXRlcy0+dmFsdWVzKSwNCisJCSAgICAgIGRhdGFfYmxvYl9jbXApOw0KKwkNCisJCWZv
ciAoaT0xIDsgaSA8IGFsbG93ZWRBdHRyaWJ1dGVzLT5udW1fdmFsdWVzOyBpKyspIHsNCisJCQlz
dHJ1Y3QgbGRiX3ZhbCAqdmFsMSA9ICZhbGxvd2VkQXR0cmlidXRlcy0+dmFsdWVzW2ktMV07DQor
CQkJc3RydWN0IGxkYl92YWwgKnZhbDIgPSAmYWxsb3dlZEF0dHJpYnV0ZXMtPnZhbHVlc1tpXTsN
CisJCQlpZiAoZGF0YV9ibG9iX2NtcCh2YWwxLCB2YWwyKSA9PSAwKSB7DQorCQkJCW1lbW1vdmUo
dmFsMSwgdmFsMiwgKGFsbG93ZWRBdHRyaWJ1dGVzLT5udW1fdmFsdWVzIC0gaSkgKiBzaXplb2Yo
IHN0cnVjdCBsZGJfdmFsKSk7IA0KKwkJCQlhbGxvd2VkQXR0cmlidXRlcy0+bnVtX3ZhbHVlcy0t
Ow0KKwkJCQlpLS07DQorCQkJfQ0KKwkJfQ0KKwl9DQorDQorCXJldHVybiAwOw0KKw0KK30NCisN
CisvKiBmaW5kIGFsbCBhdHRyaWJ1dGVzIGFsbG93ZWQgYnkgYWxsIHRoZXNlIG9iamVjdENsYXNz
ZXMgKi8NCisNCiBzdGF0aWMgaW50IGtsdWRnZV9hY2xfY2FsbGJhY2soc3RydWN0IGxkYl9jb250
ZXh0ICpsZGIsIHZvaWQgKmNvbnRleHQsIHN0cnVjdCBsZGJfcmVwbHkgKmFyZXMpDQogew0KIAlz
dHJ1Y3Qga2x1ZGdlX2FjbF9jb250ZXh0ICphYzsNCiAJc3RydWN0IGtsdWRnZV9wcml2YXRlX2Rh
dGEgKmRhdGE7DQotCWludCBpOw0KKwlpbnQgaSwgcmV0Ow0KIA0KIAlpZiAoIWNvbnRleHQgfHwg
IWFyZXMpIHsNCiAJCWxkYl9zZXRfZXJyc3RyaW5nKGxkYiwgIk5VTEwgQ29udGV4dCBvciBSZXN1
bHQgaW4gY2FsbGJhY2siKTsNCkBAIC0xMjEsMTIgKzE4MywyOCBAQA0KIAlhYyA9IHRhbGxvY19n
ZXRfdHlwZShjb250ZXh0LCBzdHJ1Y3Qga2x1ZGdlX2FjbF9jb250ZXh0KTsNCiAJZGF0YSA9IHRh
bGxvY19nZXRfdHlwZShhYy0+bW9kdWxlLT5wcml2YXRlX2RhdGEsIHN0cnVjdCBrbHVkZ2VfcHJp
dmF0ZV9kYXRhKTsNCiANCi0JaWYgKGFyZXMtPnR5cGUgPT0gTERCX1JFUExZX0VOVFJZDQotCSAg
ICAmJiBkYXRhICYmIGRhdGEtPnBhc3N3b3JkX2F0dHJzKSAvKiBpZiB3ZSBhcmUgbm90IGluaXRp
YWxpemVkIGp1c3QgZ2V0IHRocm91Z2ggKi8NCisJaWYgKGFyZXMtPnR5cGUgIT0gTERCX1JFUExZ
X0VOVFJZKSB7DQorCQlyZXR1cm4gYWMtPnVwX2NhbGxiYWNrKGxkYiwgYWMtPnVwX2NvbnRleHQs
IGFyZXMpOw0KKwl9DQorDQorCWlmIChhYy0+YWxsb3dlZEF0dHJpYnV0ZXMpIHsNCisJCXJldCA9
IGtsdWRnZV9hY2xfYWxsb3dlZEF0dHJpYnV0ZXMobGRiLCBhcmVzLT5tZXNzYWdlLCAiYWxsb3dl
ZEF0dHJpYnV0ZXMiKTsNCisJCWlmIChyZXQgIT0gTERCX1NVQ0NFU1MpIHsNCisJCQlyZXR1cm4g
cmV0Ow0KKwkJfQ0KKwl9DQorDQorCWlmIChkYXRhICYmIGRhdGEtPnBhc3N3b3JkX2F0dHJzKSAv
KiBpZiB3ZSBhcmUgbm90IGluaXRpYWxpemVkIGp1c3QgZ2V0IHRocm91Z2ggKi8NCiAJew0KIAkJ
c3dpdGNoIChhYy0+dXNlcl90eXBlKSB7DQogCQljYXNlIFNZU1RFTToNCiAJCWNhc2UgQURNSU5J
U1RSQVRPUjoNCisJCQlpZiAoYWMtPmFsbG93ZWRBdHRyaWJ1dGVzRWZmZWN0aXZlKSB7DQorCQkJ
CXJldCA9IGtsdWRnZV9hY2xfYWxsb3dlZEF0dHJpYnV0ZXMobGRiLCBhcmVzLT5tZXNzYWdlLCAi
YWxsb3dlZEF0dHJpYnV0ZXNFZmZlY3RpdmUiKTsNCisJCQkJaWYgKHJldCAhPSBMREJfU1VDQ0VT
Uykgew0KKwkJCQkJcmV0dXJuIHJldDsNCisJCQkJfQ0KKwkJCX0NCiAJCQlicmVhazsNCiAJCWRl
ZmF1bHQ6DQogCQkJLyogcmVtb3ZlIHBhc3N3b3JkIGF0dHJpYnV0ZXMgKi8NCkBAIC0xMzYsNiAr
MjE0LDEyIEBADQogCQl9DQogCX0NCiANCisJaWYgKChhYy0+YWxsb3dlZEF0dHJpYnV0ZXMgfHwg
YWMtPmFsbG93ZWRBdHRyaWJ1dGVzRWZmZWN0aXZlKSAmJiANCisJICAgICghbGRiX2F0dHJfaW5f
bGlzdChhYy0+YXR0cnMsICJvYmplY3RDbGFzcyIpICYmIA0KKwkgICAgICFsZGJfYXR0cl9pbl9s
aXN0KGFjLT5hdHRycywgIioiKSkpIHsNCisJCWxkYl9tc2dfcmVtb3ZlX2F0dHIoYXJlcy0+bWVz
c2FnZSwgIm9iamVjdENsYXNzIik7DQorCX0NCisNCiAJcmV0dXJuIGFjLT51cF9jYWxsYmFjayhs
ZGIsIGFjLT51cF9jb250ZXh0LCBhcmVzKTsNCiANCiBlcnJvcjoNCkBAIC0xNjMsNiArMjQ3LDcg
QEANCiAJYWMtPnVwX2NvbnRleHQgPSByZXEtPmNvbnRleHQ7DQogCWFjLT51cF9jYWxsYmFjayA9
IHJlcS0+Y2FsbGJhY2s7DQogCWFjLT51c2VyX3R5cGUgPSB3aGF0X2lzX3VzZXIobW9kdWxlKTsN
CisJYWMtPmF0dHJzID0gcmVxLT5vcC5zZWFyY2guYXR0cnM7DQogDQogCWRvd25fcmVxID0gdGFs
bG9jX3plcm8ocmVxLCBzdHJ1Y3QgbGRiX3JlcXVlc3QpOw0KIAlpZiAoZG93bl9yZXEgPT0gTlVM
TCkgew0KQEAgLTE3NCw4ICsyNTksMTYgQEANCiAJZG93bl9yZXEtPm9wLnNlYXJjaC5zY29wZSA9
IHJlcS0+b3Auc2VhcmNoLnNjb3BlOw0KIAlkb3duX3JlcS0+b3Auc2VhcmNoLnRyZWUgPSByZXEt
Pm9wLnNlYXJjaC50cmVlOw0KIAlkb3duX3JlcS0+b3Auc2VhcmNoLmF0dHJzID0gcmVxLT5vcC5z
ZWFyY2guYXR0cnM7DQotCQ0KIA0KKwlhYy0+YWxsb3dlZEF0dHJpYnV0ZXMgPSBsZGJfYXR0cl9p
bl9saXN0KHJlcS0+b3Auc2VhcmNoLmF0dHJzLCAiYWxsb3dlZEF0dHJpYnV0ZXMiKTsNCisNCisJ
YWMtPmFsbG93ZWRBdHRyaWJ1dGVzRWZmZWN0aXZlID0gbGRiX2F0dHJfaW5fbGlzdChyZXEtPm9w
LnNlYXJjaC5hdHRycywgImFsbG93ZWRBdHRyaWJ1dGVzRWZmZWN0aXZlIik7DQorDQorCWlmIChh
Yy0+YWxsb3dlZEF0dHJpYnV0ZXMgfHwgYWMtPmFsbG93ZWRBdHRyaWJ1dGVzRWZmZWN0aXZlKSB7
DQorCQlkb3duX3JlcS0+b3Auc2VhcmNoLmF0dHJzDQorCQkJPSBsZGJfYXR0cl9saXN0X2NvcHlf
YWRkKGRvd25fcmVxLCBkb3duX3JlcS0+b3Auc2VhcmNoLmF0dHJzLCAib2JqZWN0Q2xhc3MiKTsN
CisJfQ0KKw0KIAkvKiAgRklYTUU6IEkgaGluayB3ZSBzaG91bGQgY29weSB0aGUgdHJlZSBhbmQg
a2VlcCB0aGUgb3JpZ2luYWwNCiAJICogIHVubW9kaWZpZWQuIFNTUyAqLw0KIAkvKiByZXBsYWNl
IGFueSBhdHRyaWJ1dGVzIGluIHRoZSBwYXJzZSB0cmVlIHRoYXQgYXJlIHByaXZhdGUsDQpJbmRl
eDogc291cmNlL2xpYi9kYl93cmFwLmMNCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCi0tLSBzb3VyY2UvbGliL2RiX3dy
YXAuYwkocmV2aXNpb24gMjM1NTEpDQorKysgc291cmNlL2xpYi9kYl93cmFwLmMJKHdvcmtpbmcg
Y29weSkNCkBAIC0zNSw2ICszNSw3IEBADQogI2luY2x1ZGUgImxpYi9sZGIvaW5jbHVkZS9sZGJf
ZXJyb3JzLmgiDQogI2luY2x1ZGUgImxpYi9sZGIvc2FtYmEvbGRpZl9oYW5kbGVycy5oIg0KICNp
bmNsdWRlICJkYl93cmFwLmgiDQorI2luY2x1ZGUgImRzZGIvc2FtZGIvc2FtZGIuaCINCiANCiBz
dGF0aWMgc3RydWN0IHRkYl93cmFwICp0ZGJfbGlzdDsNCiANCkBAIC0xMjYsNiArMTI3LDEwIEBA
DQogCQl0YWxsb2NfZnJlZShsZGIpOw0KIAkJcmV0dXJuIE5VTEw7DQogCX0NCisJDQorCWlmIChz
dHJjbXAobHBfc2FtX3VybCgpLCB1cmwpID09IDApIHsNCisJICBkc2RiX3NldF9nbG9iYWxfc2No
ZW1hKGxkYik7DQorCX0NCiANCiAJcmV0ID0gbGRiX3JlZ2lzdGVyX3NhbWJhX2hhbmRsZXJzKGxk
Yik7DQogCWlmIChyZXQgPT0gLTEpIHsNCkluZGV4OiBzb3VyY2UvbGliL2xkYi9zYW1iYS9sZGlm
X2hhbmRsZXJzLmMNCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0NCi0tLSBzb3VyY2UvbGliL2xkYi9zYW1iYS9sZGlmX2hh
bmRsZXJzLmMJKHJldmlzaW9uIDIzNTUxKQ0KKysrIHNvdXJjZS9saWIvbGRiL3NhbWJhL2xkaWZf
aGFuZGxlcnMuYwkod29ya2luZyBjb3B5KQ0KQEAgLTI5OSw2NiArMjk5LDUzIEBADQogCQkJCQkg
ICAgY29uc3Qgc3RydWN0IGxkYl92YWwgKmluLCBzdHJ1Y3QgbGRiX3ZhbCAqb3V0KQ0KIHsNCiAJ
c3RydWN0IGxkYl9kbiAqZG4xID0gTlVMTDsNCi0JY2hhciAqb2MxLCAqb2MyOw0KKwljb25zdCBz
dHJ1Y3QgZHNkYl9zY2hlbWEgKnNjaGVtYSA9IGRzZGJfZ2V0X3NjaGVtYShsZGIpOw0KKwljb25z
dCBzdHJ1Y3QgZHNkYl9jbGFzcyAqY2xhc3M7DQogDQorCWlmICghc2NoZW1hKSB7DQorCQkqb3V0
ID0gZGF0YV9ibG9iX3RhbGxvYyhtZW1fY3R4LCBpbi0+ZGF0YSwgaW4tPmxlbmd0aCk7DQorCQly
ZXR1cm4gTERCX1NVQ0NFU1M7DQorCX0NCiAJZG4xID0gbGRiX2RuX25ldyhtZW1fY3R4LCBsZGIs
IChjaGFyICopaW4tPmRhdGEpOw0KIAlpZiAoICEgbGRiX2RuX3ZhbGlkYXRlKGRuMSkpIHsNCi0J
CW9jMSA9IHRhbGxvY19zdHJuZHVwKG1lbV9jdHgsIChjaGFyICopaW4tPmRhdGEsIGluLT5sZW5n
dGgpOw0KLQl9IGVsc2UgaWYgKGxkYl9kbl9nZXRfY29tcF9udW0oZG4xKSA+PSAxICYmIHN0cmNh
c2VjbXAobGRiX2RuX2dldF9yZG5fbmFtZShkbjEpLCAiY24iKSA9PSAwKSB7DQorCQljb25zdCBj
aGFyICpsREFQRGlzcGxheU5hbWUgPSB0YWxsb2Nfc3RybmR1cChtZW1fY3R4LCAoY2hhciAqKWlu
LT5kYXRhLCBpbi0+bGVuZ3RoKTsNCisJCWNsYXNzID0gZHNkYl9jbGFzc19ieV9sREFQRGlzcGxh
eU5hbWUoc2NoZW1hLCBsREFQRGlzcGxheU5hbWUpOw0KKwkJdGFsbG9jX2ZyZWUobERBUERpc3Bs
YXlOYW1lKTsNCisJfSBlbHNlIGlmIChsZGJfZG5fZ2V0X2NvbXBfbnVtKGRuMSkgPj0gMSAmJiBs
ZGJfYXR0cl9jbXAobGRiX2RuX2dldF9yZG5fbmFtZShkbjEpLCAiY24iKSA9PSAwKSB7DQogCQlj
b25zdCBzdHJ1Y3QgbGRiX3ZhbCAqdmFsID0gbGRiX2RuX2dldF9yZG5fdmFsKGRuMSk7DQotCQlv
YzEgPSB0YWxsb2Nfc3RybmR1cChtZW1fY3R4LCAoY2hhciAqKXZhbC0+ZGF0YSwgdmFsLT5sZW5n
dGgpOw0KKwkJY29uc3QgY2hhciAqY24gPSB0YWxsb2Nfc3RybmR1cChtZW1fY3R4LCAoY2hhciAq
KXZhbC0+ZGF0YSwgdmFsLT5sZW5ndGgpOw0KKwkJY2xhc3MgPSBkc2RiX2NsYXNzX2J5X2NuKHNj
aGVtYSwgY24pOw0KKwkJdGFsbG9jX2ZyZWUoY24pOw0KIAl9IGVsc2Ugew0KKwkJdGFsbG9jX2Zy
ZWUoZG4xKTsNCiAJCXJldHVybiAtMTsNCiAJfQ0KLQ0KLQlvYzIgPSBsZGJfY2FzZWZvbGQobGRi
LCBtZW1fY3R4LCBvYzEpOw0KLQlvdXQtPmRhdGEgPSAodm9pZCAqKW9jMjsNCi0Jb3V0LT5sZW5n
dGggPSBzdHJsZW4ob2MyKTsNCi0JdGFsbG9jX2ZyZWUob2MxKTsNCiAJdGFsbG9jX2ZyZWUoZG4x
KTsNCi0JcmV0dXJuIDA7DQorDQorCWlmICghY2xhc3MpIHsNCisJCXJldHVybiAtMTsNCisJfQ0K
KwkNCisJKm91dCA9IGRhdGFfYmxvYl9zdHJpbmdfY29uc3QodGFsbG9jX3N0cmR1cChtZW1fY3R4
LCBjbGFzcy0+bERBUERpc3BsYXlOYW1lKSk7DQorDQorCXJldHVybiBMREJfU1VDQ0VTUzsNCiB9
DQogDQogc3RhdGljIGludCBsZGlmX2NvbXBhcmlzb25fb2JqZWN0Q2F0ZWdvcnkoc3RydWN0IGxk
Yl9jb250ZXh0ICpsZGIsIHZvaWQgKm1lbV9jdHgsDQogCQkJCQkgIGNvbnN0IHN0cnVjdCBsZGJf
dmFsICp2MSwNCiAJCQkJCSAgY29uc3Qgc3RydWN0IGxkYl92YWwgKnYyKQ0KIHsNCi0Jc3RydWN0
IGxkYl9kbiAqZG4xID0gTlVMTCwgKmRuMiA9IE5VTEw7DQotCWNvbnN0IGNoYXIgKm9jMSwgKm9j
MjsNCiANCi0JZG4xID0gbGRiX2RuX25ldyhtZW1fY3R4LCBsZGIsIChjaGFyICopdjEtPmRhdGEp
Ow0KLQlpZiAoICEgbGRiX2RuX3ZhbGlkYXRlKGRuMSkpIHsNCi0JCW9jMSA9IHRhbGxvY19zdHJu
ZHVwKG1lbV9jdHgsIChjaGFyICopdjEtPmRhdGEsIHYxLT5sZW5ndGgpOw0KLQl9IGVsc2UgaWYg
KGxkYl9kbl9nZXRfY29tcF9udW0oZG4xKSA+PSAxICYmIHN0cmNhc2VjbXAobGRiX2RuX2dldF9y
ZG5fbmFtZShkbjEpLCAiY24iKSA9PSAwKSB7DQotCQljb25zdCBzdHJ1Y3QgbGRiX3ZhbCAqdmFs
ID0gbGRiX2RuX2dldF9yZG5fdmFsKGRuMSk7DQotCQlvYzEgPSB0YWxsb2Nfc3RybmR1cChtZW1f
Y3R4LCAoY2hhciAqKXZhbC0+ZGF0YSwgdmFsLT5sZW5ndGgpOw0KLQl9IGVsc2Ugew0KLQkJb2Mx
ID0gTlVMTDsNCi0JfQ0KKwlpbnQgcmV0MSwgcmV0MjsNCisJc3RydWN0IGxkYl92YWwgdjFfY2Fu
b24sIHYyX2Nhbm9uOw0KKwlyZXQxID0gbGRpZl9jYW5vbmljYWxpc2Vfb2JqZWN0Q2F0ZWdvcnko
bGRiLCBtZW1fY3R4LCB2MSwgJnYxX2Nhbm9uKTsNCisJcmV0MiA9IGxkaWZfY2Fub25pY2FsaXNl
X29iamVjdENhdGVnb3J5KGxkYiwgbWVtX2N0eCwgdjIsICZ2Ml9jYW5vbik7DQogDQotCWRuMiA9
IGxkYl9kbl9uZXcobWVtX2N0eCwgbGRiLCAoY2hhciAqKXYyLT5kYXRhKTsNCi0JaWYgKCAhIGxk
Yl9kbl92YWxpZGF0ZShkbjIpKSB7DQotCQlvYzIgPSB0YWxsb2Nfc3RybmR1cChtZW1fY3R4LCAo
Y2hhciAqKXYyLT5kYXRhLCB2Mi0+bGVuZ3RoKTsNCi0JfSBlbHNlIGlmIChsZGJfZG5fZ2V0X2Nv
bXBfbnVtKGRuMikgPj0gMiAmJiBzdHJjYXNlY21wKGxkYl9kbl9nZXRfcmRuX25hbWUoZG4yKSwg
ImNuIikgPT0gMCkgew0KLQkJY29uc3Qgc3RydWN0IGxkYl92YWwgKnZhbCA9IGxkYl9kbl9nZXRf
cmRuX3ZhbChkbjIpOw0KLQkJb2MyID0gdGFsbG9jX3N0cm5kdXAobWVtX2N0eCwgKGNoYXIgKil2
YWwtPmRhdGEsIHZhbC0+bGVuZ3RoKTsNCisJaWYgKHJldDEgPT0gTERCX1NVQ0NFU1MgJiYgcmV0
MiA9PSBMREJfU1VDQ0VTUykgew0KKwkJcmV0dXJuIGxkYl9hdHRyX2NtcCh2MV9jYW5vbi5kYXRh
LCB2Ml9jYW5vbi5kYXRhKTsNCiAJfSBlbHNlIHsNCi0JCW9jMiA9IE5VTEw7DQorCQlyZXR1cm4g
c3RyY2FzZWNtcCh2MS0+ZGF0YSwgdjItPmRhdGEpOw0KIAl9DQotDQotCW9jMSA9IGxkYl9jYXNl
Zm9sZChsZGIsIG1lbV9jdHgsIG9jMSk7DQotCW9jMiA9IGxkYl9jYXNlZm9sZChsZGIsIG1lbV9j
dHgsIG9jMik7DQotCWlmICghb2MxICYmIG9jMikgew0KLQkJcmV0dXJuIC0xOw0KLQl9IA0KLQlp
ZiAob2MxICYmICFvYzIpIHsNCi0JCXJldHVybiAxOw0KLQl9CQ0KLQlpZiAoIW9jMSAmJiAhb2My
KSB7DQotCQlyZXR1cm4gLTE7DQotCX0NCi0NCi0JcmV0dXJuIHN0cmNtcChvYzEsIG9jMik7DQog
fQ0KIA0KICNkZWZpbmUgTERCX1NZTlRBWF9TQU1CQV9TSUQJCQkiTERCX1NZTlRBWF9TQU1CQV9T
SUQiDQpJbmRleDogc291cmNlL2xpYi9sZGIvY29tbW9uL2xkYl9tc2cuYw0KPT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0K
LS0tIHNvdXJjZS9saWIvbGRiL2NvbW1vbi9sZGJfbXNnLmMJKHJldmlzaW9uIDIzNTUxKQ0KKysr
IHNvdXJjZS9saWIvbGRiL2NvbW1vbi9sZGJfbXNnLmMJKHdvcmtpbmcgY29weSkNCkBAIC02NjYs
NyArNjY2LDE1IEBADQogew0KIAljb25zdCBjaGFyICoqcmV0Ow0KIAlpbnQgaTsNCi0JZm9yIChp
PTA7YXR0cnNbaV07aSsrKSAvKiBub29wICovIDsNCisJYm9vbCBmb3VuZCA9IGZhbHNlOw0KKwlm
b3IgKGk9MDthdHRyc1tpXTtpKyspIHsNCisJCWlmIChsZGJfYXR0cl9jbXAoYXR0cnNbaV0sIG5l
d19hdHRyKSA9PSAwKSB7DQorCQkJZm91bmQgPSB0cnVlOw0KKwkJfQ0KKwl9DQorCWlmIChmb3Vu
ZCkgew0KKwkJcmV0dXJuIGxkYl9hdHRyX2xpc3RfY29weShtZW1fY3R4LCBhdHRycyk7DQorCX0N
CiAJcmV0ID0gdGFsbG9jX2FycmF5KG1lbV9jdHgsIGNvbnN0IGNoYXIgKiwgaSsyKTsNCiAJaWYg
KHJldCA9PSBOVUxMKSB7DQogCQlyZXR1cm4gTlVMTDsNCkBAIC02ODYsNyArNjk0LDcgQEANCiBp
bnQgbGRiX2F0dHJfaW5fbGlzdChjb25zdCBjaGFyICogY29uc3QgKmF0dHJzLCBjb25zdCBjaGFy
ICphdHRyKQ0KIHsNCiAJaW50IGk7DQotCWZvciAoaT0wO2F0dHJzW2ldO2krKykgew0KKwlmb3Ig
KGk9MDthdHRycyAmJiBhdHRyc1tpXTtpKyspIHsNCiAJCWlmIChsZGJfYXR0cl9jbXAoYXR0cnNb
aV0sIGF0dHIpID09IDApIHsNCiAJCQlyZXR1cm4gMTsNCiAJCX0NCkluZGV4OiBzb3VyY2Uvc2Ny
aXB0aW5nL2xpYmpzL3Byb3Zpc2lvbi5qcw0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KLS0tIHNvdXJjZS9zY3JpcHRp
bmcvbGlianMvcHJvdmlzaW9uLmpzCShyZXZpc2lvbiAyMzU1MSkNCisrKyBzb3VyY2Uvc2NyaXB0
aW5nL2xpYmpzL3Byb3Zpc2lvbi5qcwkod29ya2luZyBjb3B5KQ0KQEAgLTYxMSw3ICs2MTEsNyBA
QA0KIAl2YXIgbW9kaWZ5X29rID0gc2V0dXBfbGRiX21vZGlmeSgicHJvdmlzaW9uX3NjaGVtYV9i
YXNlZG5fbW9kaWZ5LmxkaWYiLCBpbmZvLCBzYW1kYik7DQogCWlmICghbW9kaWZ5X29rKSB7DQog
CQlpZiAoIWFkZF9vaykgew0KLQkJCW1lc3NhZ2UoIkZhaWxlZCB0byBib3RoIGFkZCBhbmQgbW9k
aWZ5IHNjaGVtYSBkbjogKyBzYW1kYi5lcnJzdHJpbmcoKSArICJcbiIpOw0KKwkJCW1lc3NhZ2Uo
IkZhaWxlZCB0byBib3RoIGFkZCBhbmQgbW9kaWZ5IHNjaGVtYSBkbjoiICsgc2FtZGIuZXJyc3Ry
aW5nKCkgKyAiXG4iKTsNCiAJCQltZXNzYWdlKCJQZXJoYXBzIHlvdSBuZWVkIHRvIHJ1biB0aGUg
cHJvdmlzaW9uIHNjcmlwdCB3aXRoIHRoZSAtLWxkYXAtYmFzZS1kbiBvcHRpb24sIGFuZCBhZGQg
dGhpcyByZWNvcmQgdG8gdGhlIGJhY2tlbmQgbWFudWFsbHlcbiIpOyANCiAJCQlhc3NlcnQobW9k
aWZ5X29rKTsNCiAJCX0NCkBAIC03NDQsNyArNzQ0LDcgQEANCiAJdmFyIG1vZGlmeV9vayA9IHNl
dHVwX2xkYl9tb2RpZnkoInByb3Zpc2lvbl9zY2hlbWFfYmFzZWRuX21vZGlmeS5sZGlmIiwgaW5m
bywgc2FtZGIpOw0KIAlpZiAoIW1vZGlmeV9vaykgew0KIAkJaWYgKCFhZGRfb2spIHsNCi0JCQlt
ZXNzYWdlKCJGYWlsZWQgdG8gYm90aCBhZGQgYW5kIG1vZGlmeSBzY2hlbWEgZG46ICsgc2FtZGIu
ZXJyc3RyaW5nKCkgKyAiXG4iKTsNCisJCQltZXNzYWdlKCJGYWlsZWQgdG8gYm90aCBhZGQgYW5k
IG1vZGlmeSBzY2hlbWEgZG46ICIgKyBzYW1kYi5lcnJzdHJpbmcoKSArICJcbiIpOw0KIAkJCW1l
c3NhZ2UoIlBlcmhhcHMgeW91IG5lZWQgdG8gcnVuIHRoZSBwcm92aXNpb24gc2NyaXB0IHdpdGgg
dGhlIC0tbGRhcC1iYXNlLWRuIG9wdGlvbiwgYW5kIGFkZCB0aGlzIHJlY29yZCB0byB0aGUgYmFj
a2VuZCBtYW51YWxseVxuIik7IA0KIAkJCWFzc2VydChtb2RpZnlfb2spOw0KIAkJfQ0KQEAgLTg4
MiwxNiArODgyLDE4IEBADQogCQkJCQkiZXh0ZW5kZWRfZG4iLA0KIAkJCQkJImFzcSIsDQogCQkJ
CQkic2FtbGRiIiwNCi0JCQkJCSJwYXNzd29yZF9oYXNoIiwNCiAJCQkJCSJvcGVyYXRpb25hbCIs
DQogCQkJCQkib2JqZWN0Y2xhc3MiLA0KIAkJCQkJInJkbl9uYW1lIiwNCiAJCQkJCSJzaG93X2Rl
bGV0ZWQiLA0KIAkJCQkJInBhcnRpdGlvbiIpOw0KIAlzdWJvYmouTU9EVUxFU19MSVNUID0gam9p
bigiLCIsIG1vZHVsZXNfbGlzdCk7DQotCXN1Ym9iai5ET01BSU5ETl9NT0QgPSAib2JqZWN0Z3Vp
ZCI7DQotCXN1Ym9iai5DT05GSUdETl9NT0QgPSAib2JqZWN0Z3VpZCI7DQotCXN1Ym9iai5TQ0hF
TUFETl9NT0QgPSAib2JqZWN0Z3VpZCI7DQorCXN1Ym9iai5ET01BSU5ETl9NT0QgPSAicGRjX2Zz
bW8scGFzc3dvcmRfaGFzaCI7DQorCXN1Ym9iai5DT05GSUdETl9NT0QgPSAibmFtaW5nX2ZzbW8i
Ow0KKwlzdWJvYmouU0NIRU1BRE5fTU9EID0gInNjaGVtYV9mc21vIjsNCisJc3Vib2JqLkRPTUFJ
TkROX01PRDIgPSAiLG9iamVjdGd1aWQiOw0KKwlzdWJvYmouQ09ORklHRE5fTU9EMiA9ICIsb2Jq
ZWN0Z3VpZCI7DQorCXN1Ym9iai5TQ0hFTUFETl9NT0QyID0gIixvYmplY3RndWlkIjsNCiANCiAJ
c3Vib2JqLkVYVEVOU0lCTEVPQkpFQ1QgPSAiIyBubyBvYmplY3RDbGFzczogZXh0ZW5zaWJsZU9i
amVjdCBmb3IgbG9jYWwgbGRiIjsNCiAJc3Vib2JqLkFDSQkJPSAiIyBubyBhY2kgZm9yIGxvY2Fs
IGxkYiI7DQo=


--=-fVrw6eB8mcrUhg5OgLca--

--=-kX1bS734ddd7UAY4ZxtJ
Content-Type: application/pgp-signature; name=signature.asc
Content-Description: This is a digitally signed message part

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.7 (GNU/Linux)

iD4DBQBGed1/z4A8Wyi0NrsRAtkQAJ0bwXu3M7veOF7vQ9iFaxHpJ6OT4ACY/o+/
iMuDuK6Wym0zoHaBUlr+jA==
=SJ0o
-----END PGP SIGNATURE-----

--=-kX1bS734ddd7UAY4ZxtJ--

