From perl6-all-return-80793-ktwarwic=speedy.uwaterloo.ca@perl.org  Sun Apr 22 20:39:32 2007
Return-Path: <perl6-all-return-80793-ktwarwic=speedy.uwaterloo.ca@perl.org>
Received: from lists.develooper.com (x6.develooper.com [63.251.223.186])
	by speedy.uwaterloo.ca (8.12.8/8.12.5) with SMTP id l3N0dH0I025820
	for <ktwarwic@speedy.uwaterloo.ca>; Sun, 22 Apr 2007 20:39:20 -0400
Received: (qmail 4439 invoked by uid 514); 23 Apr 2007 00:38:49 -0000
Mailing-List: contact perl6-all-help@perl.org; run by ezmlm
Precedence: bulk
List-Post: <mailto:perl6-all@perl.org>
List-Help: <mailto:perl6-all-help@perl.org>
List-Unsubscribe: <mailto:perl6-all-unsubscribe@perl.org>
List-Subscribe: <mailto:perl6-all-subscribe@perl.org>
List-Id: <perl6-all.perl.org>
Delivered-To: mailing list perl6-all@perl.org
Received: (qmail 4434 invoked from network); 23 Apr 2007 00:38:49 -0000
Delivered-To: perl6-all-poster@perl.org
X-Spam-Status: No, hits=-2.6 required=8.0
	tests=BAYES_00,DKIM_SIGNED,DKIM_VERIFIED,DK_POLICY_SIGNSOME,DK_SIGNED
X-Spam-Check-By: la.mx.develooper.com
Received-SPF: pass (x1.develooper.com: local policy)
X-Mailing-List: contact perl6-internals-help@perl.org; run by ezmlm
X-Mailing-List-Name: perl6-internals
List-Id: <perl6-internals.perl.org>
Delivered-To: mailing list perl6-internals@perl.org
Delivered-To: perl6-internals@perl.org
Received-SPF: neutral (x1.develooper.com: 63.251.223.186 is neither permitted nor denied by domain of mddiep@gmail.com)
Delivered-To: perlmail-parrot-porters@onion.perl.org
Delivered-To: parrot-porters@perl.org
Received-SPF: pass (x1.develooper.com: domain of mddiep@gmail.com designates 64.233.166.179 as permitted sender)
DKIM-Signature: a=rsa-sha1; c=relaxed/relaxed;
        d=gmail.com; s=beta;
        h=domainkey-signature:received:received:message-id:date:from:reply-to:to:subject:mime-version:content-type;
        b=c27uGPBktgaYzLcFs0iPJXKJtuYBxBNtyUps10IDWhF97UVsLABN4DN7xafxWu7RYUlom0TvlmxjpWt1HGorh+4SyYPa+Y1Etr74WVN2GXtVWEDRRs9mNDsbjh2m0EdKkz3kydQjASYkAmQwBk6tG0n+XUqHAJ278nVlktRDXIw=
DomainKey-Signature: a=rsa-sha1; c=nofws;
        d=gmail.com; s=beta;
        h=received:message-id:date:from:reply-to:to:subject:mime-version:content-type;
        b=lRmviy0zs/U2uqQaAWp+1Sg9aUgW7jnEcfpsyL0kXtx1e7pXTnIytzPbugjedQFivjDFi2Df+VnhbW7VplN21Gr8+rwD/5Ney7DmB50x3O2eaXYb0EDoHCzs1itd3qpWw7zNq3NoFsbSkp1uxseo6PXVXxdwc+ocBT/D7Qy5Mxw=
Message-ID: <198c87380704221738v4c87182cyb3b648734f631172@mail.gmail.com>
Date: Sun, 22 Apr 2007 20:38:11 -0400
From: "Matt Diephouse" <mddiep@gmail.com>
Reply-To: matt@diephouse.com
To: parrot-porters@perl.org
Subject: [PATCH] Re-work Parrot_process_args
MIME-Version: 1.0
Content-Type: multipart/mixed; 
	boundary="----=_Part_59139_23135858.1177288691524"
X-Virus-Checked: Checked
X-Virus-Checked: Checked
X-Old-Spam-Check-By: la.mx.develooper.com
X-Old-Spam-Status: No, hits=-2.6 required=8.0
	tests=BAYES_00,DKIM_SIGNED,DKIM_VERIFIED,DK_POLICY_SIGNSOME,DK_SIGNED,SPF_PASS
X-Virus-Checked: Checked
X-Old-Spam-Check-By: la.mx.develooper.com
X-Old-Spam-Status: No, hits=-1.5 required=8.0
	tests=BAYES_00,DKIM_SIGNED,DKIM_VERIFIED,DK_POLICY_SIGNSOME,DK_SIGNED,SPF_NEUTRAL
Status: O
Content-Length: 44048
Lines: 588

------=_Part_59139_23135858.1177288691524
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit
Content-Disposition: inline

The attached patch completely reworks Parrot_process_args. The changes
are extensive and I think they make the code much clearer. Rather than
just check it in, I thought I'd try to get feedback here to make sure
that it is clearer to everyone else and not just to myself.

This patch also fixes a few bugs:
    #40490: Flat/Slurpy Named Parameter Passing Errors
    A couple todo'd error condition tests

I'm sure there is more that can be done to clean things up, but this
is at least a start. I've already spent 15+ hours on this patch, so
I'm ready to check things in and leave further improvements for
another time.

-- 
Matt Diephouse
http://matt.diephouse.com

------=_Part_59139_23135858.1177288691524
Content-Type: application/octet-stream; name=arg-handling.patch
Content-Transfer-Encoding: base64
X-Attachment-Id: f_f0u71vj4
Content-Disposition: attachment; filename="arg-handling.patch"

SW5kZXg6IHNyYy9pbnRlcl9jYWxsLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQotLS0gc3JjL2ludGVyX2NhbGwuYwko
cmV2aXNpb24gMTgyOTcpCisrKyBzcmMvaW50ZXJfY2FsbC5jCSh3b3JraW5nIGNvcHkpCkBAIC0x
MjcsNiArMTI3LDcgQEAKICAgICAgICAgKytpbmRleGVzOwogICAgIH0KIAorICAgIHN0LT51c2Vk
ID0gMTsKICAgICBzdC0+aSA9IDA7CiAgICAgc3QtPm4gPSAwOwogICAgIHN0LT5tb2RlID0gQ0FM
TF9TVEFURV9PUDsKQEAgLTE2NCw2ICsxNjUsNyBAQAogUGFycm90X2luaXRfYXJnX3NpZyhJbnRl
cnAgKmludGVycCwgcGFycm90X2NvbnRleHRfdCAqY3R4LCBjb25zdCBjaGFyICpzaWcsCiAgICAg
dm9pZCAqYXAsIGNhbGxfc3RhdGVfaXRlbSAqc3QpCiB7CisgICAgc3QtPnVzZWQgPSAxOwogICAg
IHN0LT5pID0gMDsKICAgICBzdC0+biA9IDA7CiAgICAgc3QtPm1vZGUgPSBDQUxMX1NUQVRFX1NJ
RzsKQEAgLTIxMSw3ICsyMTMsNiBAQAogICAgIHN0LT5zcmMuc2x1cnBfbiA9IFZUQUJMRV9lbGVt
ZW50cyhpbnRlcnAsIHBfYXJnKTsKICAgICAvKiB0aGUgLTEgaXMgYmVjYXVzZSB0aGUgOmZsYXQg
UE1DIGl0c2VsZiBkb2Vzbid0IGNvdW50LiAqLwogICAgIHN0LT5uX2FjdHVhbF9hcmdzICs9IHN0
LT5zcmMuc2x1cnBfbiAtIDE7Ci0gICAgUGFycm90X2ZldGNoX2FyZyhpbnRlcnAsIHN0KTsKIH0K
IAogCkBAIC0yNTAsMTIgKzI1MSwxMSBAQAogICAgICAgICBzdC0+c2lnID0gMDsKICAgICAgICAg
cmV0dXJuIDA7CiAgICAgfQotICAgIHN0LT5tb2RlICY9IH5DQUxMX1NUQVRFX05FWFRfQVJHOwog
ICAgIG5leHRfYXJnX3NpZyhpbnRlcnAsIHN0KTsKICAgICByZXR1cm4gMTsKIH0KIAotc3RhdGlj
IHZvaWQKK3N0YXRpYyBpbnQKIGZldGNoX2FyZ19zaWcoSW50ZXJwICppbnRlcnAsIGNhbGxfc3Rh
dGUgKnN0KQogewogICAgIHZhX2xpc3QgKmFwID0gKHZhX2xpc3QqKShzdC0+c3JjLnUuc2lnLmFw
KTsKQEAgLTI3NywxNSArMjc3LDIyIEBACiAKICAgICAgICAgICAgIGlmIChzdC0+c3JjLnNpZyAm
IFBBUlJPVF9BUkdfRkxBVFRFTikgewogICAgICAgICAgICAgICAgIHN0YXJ0X2ZsYXR0ZW4oaW50
ZXJwLCBzdCwgVVZhbF9wbWMoc3QtPnZhbCkpOwotICAgICAgICAgICAgICAgIHJldHVybjsKKyAg
ICAgICAgICAgICAgICAvKiBpZiB0aGUgOmZsYXQgYXJnIGlzIGVtcHR5LCBqdXN0IGdvIHRvIHRo
ZSBuZXh0IGFyZyAqLworICAgICAgICAgICAgICAgIGlmICghc3QtPnNyYy5zbHVycF9uKSB7Cisg
ICAgICAgICAgICAgICAgICAgIHN0LT5zcmMubW9kZSAmPSB+Q0FMTF9TVEFURV9GTEFUVEVOOwor
ICAgICAgICAgICAgICAgICAgICBzdC0+c3JjLmkrKzsKKyAgICAgICAgICAgICAgICB9CisgICAg
ICAgICAgICAgICAgc3QtPnNyYy51c2VkID0gMTsKKyAgICAgICAgICAgICAgICByZXR1cm4gUGFy
cm90X2ZldGNoX2FyZyhpbnRlcnAsIHN0KTsKICAgICAgICAgICAgIH0KICAgICAgICAgICAgIGJy
ZWFrOwogICAgIH0KLSAgICBzdC0+c3JjLm1vZGUgfD0gQ0FMTF9TVEFURV9ORVhUX0FSRzsKKyAg
ICBzdC0+c3JjLmkrKzsKKyAgICByZXR1cm4gMTsKIH0KIAogCi1zdGF0aWMgdm9pZAorc3RhdGlj
IGludAogZmV0Y2hfYXJnX29wKEludGVycCAqaW50ZXJwLCBjYWxsX3N0YXRlICpzdCkKIHsKICAg
ICBpbnQgY29uc3RhbnQgPSBQQVJST1RfQVJHX0NPTlNUQU5UX0lTU0VUKHN0LT5zcmMuc2lnKTsK
QEAgLTI5NywxMTggKzMwNCwxMTEgQEAKICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICBjYXNl
IFBBUlJPVF9BUkdfU1RSSU5HOgogICAgICAgICAgICAgVVZhbF9zdHIoc3QtPnZhbCkgPSBjb25z
dGFudCA/IHN0LT5zcmMuY3R4LT5jb25zdGFudHNbaWR4XS0+dS5zdHJpbmcKLSAgICAgICAgICAg
ICAgICA6IENUWF9SRUdfU1RSKHN0LT5zcmMuY3R4LCBpZHgpOworICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICA6IENUWF9SRUdfU1RSKHN0LT5zcmMuY3R4LCBpZHgpOwogICAg
ICAgICAgICAgYnJlYWs7CiAgICAgICAgIGNhc2UgUEFSUk9UX0FSR19GTE9BVFZBTDoKICAgICAg
ICAgICAgIFVWYWxfbnVtKHN0LT52YWwpID0gY29uc3RhbnQgPyBzdC0+c3JjLmN0eC0+Y29uc3Rh
bnRzW2lkeF0tPnUubnVtYmVyCi0gICAgICAgICAgICAgICAgOiBDVFhfUkVHX05VTShzdC0+c3Jj
LmN0eCwgaWR4KTsKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBDVFhf
UkVHX05VTShzdC0+c3JjLmN0eCwgaWR4KTsKICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICBj
YXNlIFBBUlJPVF9BUkdfUE1DOgogICAgICAgICAgICAgVVZhbF9wbWMoc3QtPnZhbCkgPSBjb25z
dGFudCA/IHN0LT5zcmMuY3R4LT5jb25zdGFudHNbaWR4XS0+dS5rZXkKLSAgICAgICAgICAgICAg
ICA6IENUWF9SRUdfUE1DKHN0LT5zcmMuY3R4LCBpZHgpOworICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICA6IENUWF9SRUdfUE1DKHN0LT5zcmMuY3R4LCBpZHgpOwogCiAgICAg
ICAgICAgICBpZiAoc3QtPnNyYy5zaWcgJiBQQVJST1RfQVJHX0ZMQVRURU4pIHsKICAgICAgICAg
ICAgICAgICBzdGFydF9mbGF0dGVuKGludGVycCwgc3QsIFVWYWxfcG1jKHN0LT52YWwpKTsKLSAg
ICAgICAgICAgICAgICByZXR1cm47CisgICAgICAgICAgICAgICAgLyogaWYgdGhlIDpmbGF0IGFy
ZyBpcyBlbXB0eSwganVzdCBnbyB0byB0aGUgbmV4dCBhcmcgKi8KKyAgICAgICAgICAgICAgICBp
ZiAoIXN0LT5zcmMuc2x1cnBfbikgeworICAgICAgICAgICAgICAgICAgICBzdC0+c3JjLm1vZGUg
Jj0gfkNBTExfU1RBVEVfRkxBVFRFTjsKKyAgICAgICAgICAgICAgICAgICAgc3QtPnNyYy5pKys7
CisgICAgICAgICAgICAgICAgfQorICAgICAgICAgICAgICAgIHN0LT5zcmMudXNlZCA9IDE7Cisg
ICAgICAgICAgICAgICAgcmV0dXJuIFBhcnJvdF9mZXRjaF9hcmcoaW50ZXJwLCBzdCk7CiAgICAg
ICAgICAgICB9CiAgICAgICAgICAgICBicmVhazsKICAgICB9Ci0gICAgc3QtPnNyYy5tb2RlIHw9
IENBTExfU1RBVEVfTkVYVF9BUkc7CisgICAgc3QtPnNyYy5pKys7CisgICAgcmV0dXJuIDE7CiB9
CiAKIAogaW50CiBQYXJyb3RfZmV0Y2hfYXJnKEludGVycCAqaW50ZXJwLCBjYWxsX3N0YXRlICpz
dCkKIHsKLSAgICBpZiAoc3QtPmRlc3QubW9kZSAmIENBTExfU1RBVEVfTkVYVF9BUkcpIHsKLSAg
ICAgICAgaWYgKCFuZXh0X2FyZyhpbnRlcnAsICZzdC0+ZGVzdCkpCi0gICAgICAgICAgICBzdC0+
ZGVzdC5tb2RlIHw9IENBTExfU1RBVEVfeF9FTkQ7Ci0gICAgfQotICAgIGlmICghc3QtPnNyYy5u
KSB7Ci0gICAgICAgIHN0LT5kZXN0Lm1vZGUgfD0gQ0FMTF9TVEFURV9FTkRfeDsKKyAgICBpZiAo
IXN0LT5zcmMudXNlZCkKKyAgICAgICAgcmV0dXJuIDE7CisgICAgaWYgKHN0LT5zcmMuaSA+PSBz
dC0+c3JjLm4pCiAgICAgICAgIHJldHVybiAwOwotICAgIH0KLSAgICBpZiAoc3QtPnNyYy5tb2Rl
ICYgQ0FMTF9TVEFURV9ORVhUX0FSRykgewotICAgICAgICBpZiAoIW5leHRfYXJnKGludGVycCwg
JnN0LT5zcmMpKSB7Ci0gICAgICAgICAgICBzdC0+ZGVzdC5tb2RlIHw9IENBTExfU1RBVEVfRU5E
X3g7Ci0gICAgICAgICAgICByZXR1cm4gMDsKLSAgICAgICAgfQotICAgIH0KLSNpZiAwCi0gICAg
LyogTk9UIFlFVAotICAgICAqIGUuZy4KLSAgICAgKiAkIG1ha2UKLSAgICAgKiAuLi8uLi9wYXJy
b3QgcGdjLnBpciAgLS1vdXRwdXQ9UEdFL2J1aWx0aW5zX2dlbi5waXIgUEdFL2J1aWx0aW5zLnBn
Ci0gICAgICogcG9zaXRpb25hbCBpbnNpZGUgbmFtZWQgYXJncwotICAgICAqIC4uLgotICAgICAq
LworICAgIHN0LT5zcmMudXNlZCA9IDA7CiAKLSAgICBpZiAoKHN0LT5kZXN0Lm1vZGUgJiBDQUxM
X1NUQVRFX05BTUVEX3gpICYmICEoc3QtPnNyYy5zaWcgJiBQQVJST1RfQVJHX05BTUUpKQotICAg
ICAgICByZWFsX2V4Y2VwdGlvbihpbnRlcnAsIE5VTEwsIEVfVmFsdWVFcnJvciwgInBvc2l0aW9u
YWwgaW5zaWRlIG5hbWVkIGFyZ3MiKTsKLSNlbmRpZgorICAgIG5leHRfYXJnX3NpZyhpbnRlcnAs
ICZzdC0+c3JjKTsKIAorICAgIC8qIGNoZWNrIGlmIHdlJ3JlIGF0IGEgOmZsYXQgYXJndW1lbnQg
Ki8KICAgICBpZiAoc3QtPnNyYy5tb2RlICYgQ0FMTF9TVEFURV9GTEFUVEVOKSB7Ci0gICAgICAg
IGlmIChzdC0+c3JjLnNsdXJwX2kgPCBzdC0+c3JjLnNsdXJwX24pIHsKLSAgICAgICAgICAgIFBN
QyAqZWxlbTsKLSAgICAgICAgICAgIGlmIChzdC0+a2V5KSB7Ci0gICAgICAgICAgICAgICAgc3Qt
PnNyYy5zbHVycF9pKys7Ci0gICAgICAgICAgICAgICAgc3QtPm5hbWUgPSAoU1RSSU5HICopcGFy
cm90X2hhc2hfZ2V0X2lkeChpbnRlcnAsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
KEhhc2ggKilQTUNfc3RydWN0X3ZhbChzdC0+c3JjLnNsdXJwKSwgc3QtPmtleSk7Ci0gICAgICAg
ICAgICAgICAgYXNzZXJ0KHN0LT5uYW1lKTsKLSAgICAgICAgICAgICAgICBlbGVtID0gVlRBQkxF
X2dldF9wbWNfa2V5ZWRfc3RyKGludGVycCwgc3QtPnNyYy5zbHVycCwgc3QtPm5hbWUpOwotICAg
ICAgICAgICAgfQotICAgICAgICAgICAgZWxzZSB7Ci0gICAgICAgICAgICAgICAgZWxlbSA9IFZU
QUJMRV9nZXRfcG1jX2tleWVkX2ludChpbnRlcnAsIHN0LT5zcmMuc2x1cnAsIHN0LT5zcmMuc2x1
cnBfaSsrKTsKLSAgICAgICAgICAgIH0KLSAgICAgICAgICAgIHN0LT5zcmMuc2lnID0gUEFSUk9U
X0FSR19QTUM7Ci0gICAgICAgICAgICBVVmFsX3BtYyhzdC0+dmFsKSA9IGVsZW07Ci0gICAgICAg
ICAgICByZXR1cm4gMTsKKyAgICAgICAgUE1DICplbGVtOworICAgICAgICBhc3NlcnQoc3QtPnNy
Yy5zbHVycF9pIDwgc3QtPnNyYy5zbHVycF9uKTsKKyAgICAgICAgaWYgKHN0LT5rZXkpIHsKKyAg
ICAgICAgICAgIHN0LT5zcmMuc2x1cnBfaSsrOworICAgICAgICAgICAgc3QtPm5hbWUgPSAoU1RS
SU5HICopcGFycm90X2hhc2hfZ2V0X2lkeChpbnRlcnAsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgKEhhc2ggKilQTUNfc3RydWN0X3ZhbChzdC0+c3JjLnNsdXJwKSwgc3QtPmtleSk7Cisg
ICAgICAgICAgICBhc3NlcnQoc3QtPm5hbWUpOworICAgICAgICAgICAgZWxlbSA9IFZUQUJMRV9n
ZXRfcG1jX2tleWVkX3N0cihpbnRlcnAsIHN0LT5zcmMuc2x1cnAsIHN0LT5uYW1lKTsKICAgICAg
ICAgfQorICAgICAgICBlbHNlIHsKKyAgICAgICAgICAgIGVsZW0gPSBWVEFCTEVfZ2V0X3BtY19r
ZXllZF9pbnQoaW50ZXJwLCBzdC0+c3JjLnNsdXJwLCBzdC0+c3JjLnNsdXJwX2krKyk7CisgICAg
ICAgIH0KKyAgICAgICAgc3QtPnNyYy5zaWcgPSBQQVJST1RfQVJHX1BNQzsKKyAgICAgICAgVVZh
bF9wbWMoc3QtPnZhbCkgPSBlbGVtOworCiAgICAgICAgIC8qIGRvbmUgd2l0aCBmbGF0dGVuaW5n
ICovCi0gICAgICAgIHN0LT5zcmMubW9kZSAmPSB+Q0FMTF9TVEFURV9GTEFUVEVOOwotICAgICAg
ICBzdC0+c3JjLm1vZGUgfD0gQ0FMTF9TVEFURV9ORVhUX0FSRzsKLSAgICAgICAgc3QtPmtleSA9
IE5VTEw7Ci0gICAgICAgIC8qIGFkdmFuY2Ugc3JjIC0gZ2V0IG5leHQgYXJnICovCi0gICAgICAg
IHJldHVybiBQYXJyb3RfZmV0Y2hfYXJnKGludGVycCwgc3QpOworICAgICAgICBpZiAoc3QtPnNy
Yy5zbHVycF9pID09IHN0LT5zcmMuc2x1cnBfbikgeworICAgICAgICAgICAgc3QtPnNyYy5tb2Rl
ICY9IH5DQUxMX1NUQVRFX0ZMQVRURU47CisgICAgICAgICAgICBzdC0+a2V5ID0gTlVMTDsKKyAg
ICAgICAgICAgIHN0LT5zcmMuaSsrOworICAgICAgICB9CisKKyAgICAgICAgcmV0dXJuIDE7CiAg
ICAgfQogCisgICAgLyogSWYgd2UncmUgYXQgYSBuYW1lZCBhcmcsIHN0b3JlIHRoZSBuYW1lIGFu
ZCB0aGVuIGdldCB0aGUgbmV4dCBhcmcsIHdoaWNoCisgICAgICogaXMgdGhlIGFjdHVhbCB2YWx1
ZSBvZiB0aGUgbmFtZWQgYXJnLiAqLwogICAgIGlmICgoc3QtPnNyYy5zaWcgJiBQQVJST1RfQVJH
X05BTUUpICYmICEoc3QtPnNyYy5zaWcgJiBQQVJST1RfQVJHX0ZMQVRURU4pKSB7CiAgICAgICAg
IGZldGNoX2FyZ19vcChpbnRlcnAsIHN0KTsKICAgICAgICAgc3QtPm5hbWUgPSBVVmFsX3N0cihz
dC0+dmFsKTsKLSAgICAgICAgbmV4dF9hcmcoaW50ZXJwLCAmc3QtPnNyYyk7CisgICAgICAgIG5l
eHRfYXJnX3NpZyhpbnRlcnAsICZzdC0+c3JjKTsKICAgICB9CiAgICAgc3dpdGNoIChzdC0+c3Jj
Lm1vZGUgJiBDQUxMX1NfRF9NQVNLKSB7CiAgICAgICAgIGNhc2UgQ0FMTF9TVEFURV9PUDoKLSAg
ICAgICAgICAgIGZldGNoX2FyZ19vcChpbnRlcnAsIHN0KTsKLSAgICAgICAgICAgIGJyZWFrOwor
ICAgICAgICAgICAgcmV0dXJuIGZldGNoX2FyZ19vcChpbnRlcnAsIHN0KTsKICAgICAgICAgY2Fz
ZSBDQUxMX1NUQVRFX1NJRzoKLSAgICAgICAgICAgIGZldGNoX2FyZ19zaWcoaW50ZXJwLCBzdCk7
Ci0gICAgICAgICAgICBicmVhazsKKyAgICAgICAgICAgIHJldHVybiBmZXRjaF9hcmdfc2lnKGlu
dGVycCwgc3QpOwogICAgIH0KLSAgICByZXR1cm4gMTsKKworICAgIGludGVybmFsX2V4Y2VwdGlv
bigxLCAiaW52YWxpZCBjYWxsIHN0YXRlIG1vZGUiKTsKKyAgICByZXR1cm4gMDsKIH0KIAogCiBp
bnQKIFBhcnJvdF9mZXRjaF9hcmdfbmNpKEludGVycCAqaW50ZXJwLCBjYWxsX3N0YXRlICpzdCkK
IHsKLSAgICBQYXJyb3RfZmV0Y2hfYXJnKGludGVycCwgc3QpOworICAgIG5leHRfYXJnX3NpZyhp
bnRlcnAsICZzdC0+ZGVzdCk7CiAgICAgaWYgKHN0LT5kZXN0LnNpZyAmIFBBUlJPVF9BUkdfU0xV
UlBZX0FSUkFZKSB7CiAgICAgICAgIFBNQyAqc2x1cnBlZDsKICAgICAgICAgYXNzZXJ0KChzdC0+
ZGVzdC5zaWcgJiBQQVJST1RfQVJHX1RZUEVfTUFTSykgPT0gUEFSUk9UX0FSR19QTUMpOwogICAg
ICAgICBzbHVycGVkID0gcG1jX25ldyhpbnRlcnAsIGVudW1fY2xhc3NfUmVzaXphYmxlUE1DQXJy
YXkpOwotICAgICAgICB3aGlsZSAoIShzdC0+ZGVzdC5tb2RlICYgQ0FMTF9TVEFURV9FTkRfeCkp
IHsKKyAgICAgICAgd2hpbGUgKFBhcnJvdF9mZXRjaF9hcmcoaW50ZXJwLCBzdCkpIHsKKyAgICAg
ICAgICAgIHN0LT5zcmMudXNlZCA9IDE7CiAgICAgICAgICAgICBQYXJyb3RfY29udmVydF9hcmco
aW50ZXJwLCBzdCk7Ci0gICAgICAgICAgICBzdC0+ZGVzdC5tb2RlIHw9IENBTExfU1RBVEVfU0xV
UlA7CiAgICAgICAgICAgICBWVEFCTEVfcHVzaF9wbWMoaW50ZXJwLCBzbHVycGVkLCBVVmFsX3Bt
YyhzdC0+dmFsKSk7Ci0gICAgICAgICAgICBQYXJyb3RfZmV0Y2hfYXJnKGludGVycCwgc3QpOwog
ICAgICAgICB9CiAgICAgICAgIFVWYWxfcG1jKHN0LT52YWwpID0gc2x1cnBlZDsKICAgICB9CiAg
ICAgZWxzZSB7CisgICAgICAgIFBhcnJvdF9mZXRjaF9hcmcoaW50ZXJwLCBzdCk7CisgICAgICAg
IHN0LT5zcmMudXNlZCA9IDE7CiAgICAgICAgIFBhcnJvdF9jb252ZXJ0X2FyZyhpbnRlcnAsIHN0
KTsKLSAgICAgICAgc3QtPmRlc3QubW9kZSB8PSBDQUxMX1NUQVRFX05FWFRfQVJHOwogICAgIH0K
KyAgICBzdC0+ZGVzdC5pKys7CiAgICAgcmV0dXJuIDE7CiB9CiAKQEAgLTUzMSw5ICs1MzEsNyBA
QAogCiAgICAgLyogMSkgaWYgd2Ugd2VyZSBzbHVycHlpbmcgcG9zaXRpb25hbCBhcmdzLCB3ZSBh
cmUgZG9uZSwgdHVybiBpdCBvZmYKICAgICAgKiAyKSBzZXQgZGVzdGluYXRpb24gbmFtZWQgYXJn
cyBiaXQgKi8KLSAgICBzdC0+ZGVzdC5tb2RlICY9IH5DQUxMX1NUQVRFX1NMVVJQOwogICAgIHN0
LT5kZXN0LnNsdXJwID0gTlVMTDsKLSAgICBzdC0+ZGVzdC5tb2RlIHw9IENBTExfU1RBVEVfeF9O
QU1FRDsKIAogICAgIC8qIDEpIGNvdW50IG5hbWVkIGFyZ3MsIG1ha2Ugc3VyZSB0aGVyZSBpcyBs
ZXNzIHRoYW4gMzIvNjQKICAgICAgKiAyKSBjcmVhdGUgc2x1cnB5IGhhc2ggaWYgbmVlZGVkICov
CkBAIC01NzUsOCArNTczLDYgQEAKICAgICBJTlRWQUwgc2lnOwogCiAgICAgbl9uYW1lZCA9IC0x
OwotICAgIHN0LT5kZXN0Lm1vZGUgJj0gfkNBTExfU1RBVEVfU0xVUlA7Ci0gICAgc3QtPmRlc3Qu
bW9kZSB8PSBDQUxMX1NUQVRFX3hfTkFNRUQ7CiAgICAgZm9yIChpID0gc3QtPmZpcnN0X25hbWVk
OyBpIDwgc3QtPmRlc3QubjsgKytpKSB7CiAgICAgICAgIHNpZyA9IFNJR19JVEVNKHN0LT5kZXN0
LnUub3Auc2lnbmF0dXJlLCBpKTsKICAgICAgICAgaWYgKCEoc2lnICYgUEFSUk9UX0FSR19OQU1F
KSkKQEAgLTU5Miw3ICs1ODgsNiBAQAogICAgICAgICBzdC0+bmFtZWRfZG9uZSB8PSAxIDw8IG5f
bmFtZWQ7CiAgICAgICAgIHJldHVybiAxOwogICAgIH0KLSAgICBzdC0+ZGVzdC5tb2RlIHw9IENB
TExfU1RBVEVfeF9FTkQ7CiAgICAgcmV0dXJuIDA7CiB9CiAKQEAgLTYwMywyMyArNTk4LDE4IEBA
CiBsb2NhdGVfbmFtZWRfbmFtZWQoSW50ZXJwICppbnRlcnAsIGNhbGxfc3RhdGUgKnN0KQogewog
ICAgIGludCBpLCBuX25hbWVkLCBpZHg7Ci0gICAgSU5UVkFMIHNpZzsKICAgICBTVFJJTkcgKnBh
cmFtOwogCiAgICAgbl9uYW1lZCA9IC0xOwotICAgIHN0LT5kZXN0Lm1vZGUgJj0gfkNBTExfU1RB
VEVfU0xVUlA7Ci0gICAgc3QtPmRlc3QubW9kZSAmPSB+Q0FMTF9TVEFURV9PUFQ7CiAgICAgZm9y
IChpID0gc3QtPmZpcnN0X25hbWVkOyBpIDwgc3QtPmRlc3QubjsgKytpKSB7Ci0gICAgICAgIHNp
ZyA9IFNJR19JVEVNKHN0LT5kZXN0LnUub3Auc2lnbmF0dXJlLCBpKTsKLSAgICAgICAgaWYgKCEo
c2lnICYgUEFSUk9UX0FSR19OQU1FKSkKKyAgICAgICAgc3QtPmRlc3Quc2lnID0gU0lHX0lURU0o
c3QtPmRlc3QudS5vcC5zaWduYXR1cmUsIGkpOworICAgICAgICBpZiAoIShzdC0+ZGVzdC5zaWcg
JiBQQVJST1RfQVJHX05BTUUpKQogICAgICAgICAgICAgY29udGludWU7Ci0gICAgICAgIGlmIChz
aWcgJiBQQVJST1RfQVJHX1NMVVJQWV9BUlJBWSkgewotICAgICAgICAgICAgc3QtPmRlc3QubW9k
ZSB8PSBDQUxMX1NUQVRFX1NMVVJQOworICAgICAgICBpZiAoc3QtPmRlc3Quc2lnICYgUEFSUk9U
X0FSR19TTFVSUFlfQVJSQVkpCiAgICAgICAgICAgICByZXR1cm4gMTsKLSAgICAgICAgfQogICAg
ICAgICBuX25hbWVkKys7CiAgICAgICAgIGlkeCA9IHN0LT5kZXN0LnUub3AucGNbaV07Ci0gICAg
ICAgIHBhcmFtID0gUEFSUk9UX0FSR19DT05TVEFOVF9JU1NFVChzaWcpID8gc3QtPmRlc3QuY3R4
LT5jb25zdGFudHNbaWR4XS0+dS5zdHJpbmcKKyAgICAgICAgcGFyYW0gPSBQQVJST1RfQVJHX0NP
TlNUQU5UX0lTU0VUKHN0LT5kZXN0LnNpZykgPyBzdC0+ZGVzdC5jdHgtPmNvbnN0YW50c1tpZHhd
LT51LnN0cmluZwogICAgICAgICAgICAgICAgIDogQ1RYX1JFR19TVFIoc3QtPmRlc3QuY3R4LCBp
ZHgpOwogICAgICAgICBpZiAoc3QtPm5hbWUgPT0gcGFyYW0gfHwgMCA9PSBzdHJpbmdfZXF1YWwo
aW50ZXJwLCBzdC0+bmFtZSwgcGFyYW0pKSB7CiAgICAgICAgICAgICArK2k7CkBAIC02MzMsMTAg
KzYyMywxMCBAQAogICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgIH0KICAgICB9Ci0gICAg
c3QtPmRlc3QubW9kZSB8PSBDQUxMX1NUQVRFX3hfRU5EOwogICAgIHJldHVybiAwOwogfQogCisK
IHN0YXRpYyB2b2lkCiBzdG9yZV9hcmcoY2FsbF9zdGF0ZSAqc3QsIElOVFZBTCBpZHgpCiB7CkBA
IC02NTYsNiArNjQ2LDcgQEAKICAgICB9CiB9CiAKKwogc3RhdGljIGludAogc3RvcmVfY3VycmVu
dF9hcmcoSW50ZXJwICppbnRlcnAsIGNhbGxfc3RhdGUgKnN0KQogewpAQCAtNjc0LDE4ICs2NjUs
MTcgQEAKIGludAogUGFycm90X3N0b3JlX2FyZyhJbnRlcnAgKmludGVycCwgY2FsbF9zdGF0ZSAq
c3QpCiB7Ci0gICAgaWYgKCFzdG9yZV9jdXJyZW50X2FyZyhpbnRlcnAsIHN0KSkKLSAgICAgICAg
cmV0dXJuIDA7Ci0gICAgaWYgKCEoc3QtPmRlc3QubW9kZSAmIENBTExfU1RBVEVfeF9OQU1FRCkp
Ci0gICAgICAgIHN0LT5kZXN0Lm1vZGUgfD0gQ0FMTF9TVEFURV9ORVhUX0FSRzsKLSAgICByZXR1
cm4gMTsKKyAgICByZXR1cm4gc3RvcmVfY3VycmVudF9hcmcoaW50ZXJwLCBzdCk7CiB9CiAKIAog
CiBzdGF0aWMgdm9pZAotY3JlYXRlX3NsdXJweV9hcnJheShJbnRlcnAgKmludGVycCwgY2FsbF9z
dGF0ZSAqc3QsIElOVFZBTCBpZHgpCitjcmVhdGVfc2x1cnB5X2FycmF5KEludGVycCAqaW50ZXJw
LCBjYWxsX3N0YXRlICpzdCkKIHsKKyAgICBJTlRWQUwgaWR4ID0gc3QtPmRlc3QudS5vcC5wY1tz
dC0+ZGVzdC5pXTsKKyAgICBhc3NlcnQoaWR4ID49IDApOworCiAgICAgc3QtPmRlc3Quc2x1cnAg
PQogICAgICAgICBwbWNfbmV3KGludGVycCwgUGFycm90X2dldF9jdHhfSExMX3R5cGUoaW50ZXJw
LCBlbnVtX2NsYXNzX1Jlc2l6YWJsZVBNQ0FycmF5KSk7CiAKQEAgLTY5NCw4ICs2ODQsNiBAQAog
ICAgIGRvZF9yZWdpc3Rlcl9wbWMoaW50ZXJwLCBzdC0+ZGVzdC5zbHVycCk7CiAKICAgICBDVFhf
UkVHX1BNQyhzdC0+ZGVzdC5jdHgsIGlkeCkgPSBzdC0+ZGVzdC5zbHVycDsKLSAgICBzdC0+ZGVz
dC5tb2RlIHw9IENBTExfU1RBVEVfU0xVUlA7Ci0gICAgc3QtPmRlc3QubW9kZSAmPSB+Q0FMTF9T
VEFURV9PUFQ7CiB9CiAKIHN0YXRpYyB2b2lkCkBAIC04MjUsMTEgKzgxMywxMiBAQAogdm9pZAog
UGFycm90X3Byb2Nlc3NfYXJncyhJbnRlcnAgKmludGVycCwgY2FsbF9zdGF0ZSAqc3QsIGFyZ19w
YXNzX3QgcGFyYW1fb3JfcmVzdWx0KQogewotICAgIGludCBzdGF0ZSwgb3B0X2ZsYWc7CisgICAg
aW50IGhhc19hcmcsIG5fbmFtZWQ7CiAgICAgaW50IGVycl9jaGVjayA9IDE7CiAgICAgY29uc3Qg
Y2hhciAqYWN0aW9uID0gKHBhcmFtX29yX3Jlc3VsdCA9PSBQQVJST1RfUEFTU19SRVNVTFRTKSA/
ICJyZXN1bHRzIiA6ICJwYXJhbXMiOwotICAgIElOVFZBTCBpZHg7CiAKKyAgICAvKiBDaGVjayBp
ZiB3ZSBzaG91bGQgYmUgdGhyb3dpbmcgZXJyb3JzLiBUaGlzIGNhbiBiZSBjb25maWd1cmVkIHNl
cGFyYXRlbHkKKyAgICAgKiBmb3IgcGFyYW1ldGVycyBhbmQgcmV0dXJuIHZhbHVlcy4gKi8KICAg
ICBpZiAocGFyYW1fb3JfcmVzdWx0ID09IFBBUlJPVF9QQVNTX1JFU1VMVFMpIHsKICAgICAgICAg
aWYgKCFQQVJST1RfRVJST1JTX3Rlc3QoaW50ZXJwLCBQQVJST1RfRVJST1JTX1JFU1VMVF9DT1VO
VF9GTEFHKSkKICAgICAgICAgICAgIGVycl9jaGVjayA9IDA7CkBAIC04MzksMTg3ICs4MjgsMTk0
IEBACiAgICAgICAgICAgICBlcnJfY2hlY2sgPSAwOwogICAgIH0KIAotICAgIGlmICghc3QtPnNy
Yy5uKQotICAgICAgICBzdC0+ZGVzdC5tb2RlIHw9IENBTExfU1RBVEVfRU5EX3g7Ci0gICAgaWYg
KCFzdC0+ZGVzdC5uKQotICAgICAgICBzdC0+ZGVzdC5tb2RlIHw9IENBTExfU1RBVEVfeF9FTkQ7
CiAgICAgaW5pdF9jYWxsX3N0YXRzKHN0KTsKIAotICAgIGRvIHsKLSAgICAgICAgUGFycm90X2Zl
dGNoX2FyZyhpbnRlcnAsIHN0KTsKLSAgICAgICAgc3RhdGUgPSBzdC0+ZGVzdC5tb2RlICYgQ0FM
TF9TVEFURV9NQVNLOworICAgIGNhbGxfc3RhdGVfaXRlbSAqc3JjICA9ICZzdC0+c3JjOworICAg
IGNhbGxfc3RhdGVfaXRlbSAqZGVzdCA9ICZzdC0+ZGVzdDsKIAotICAgICAgICAvKiAgZmluaXNo
ZWQgaWYgYm90aCBhcmUgYXQgZW5kIG9yIHNyYyBhdCBlbmQgKiBhbmQgd2UgYXJlIHNsdXJweWlu
ZyAqLwotICAgICAgICBpZiAoKHN0YXRlICYgQ0FMTF9TVEFURV9FTkRfeCkgJiYKLSAgICAgICAg
ICAgICAgICAoKHN0YXRlICYgQ0FMTF9TVEFURV94X0VORCkgfHwgKHN0YXRlICYgQ0FMTF9TVEFU
RV9TTFVSUCkpKQotICAgICAgICAgICAgcmV0dXJuOworICAgIC8qCisgICAgICogMXN0OiBQb3Np
dGlvbmFsIG5vbi06c2x1cnB5CisgICAgICovCisgICAgZm9yICg7IGRlc3QtPmkgPCBkZXN0LT5u
OyBkZXN0LT5pKyspIHsKKyAgICAgICAgSU5UVkFMIGlkeDsKIAotICAgICAgICAvKgotICAgICAg
ICAgKiBoYW5kbGUgc3RhdGUgY2hhbmdlcwotICAgICAgICAgKi8KLSAgICAgICAgaWYgKCEoc3Rh
dGUgJiBDQUxMX1NUQVRFX05BTUVEX3gpKSB7Ci0gICAgICAgICAgICBpZiAoIShzdGF0ZSAmIENB
TExfU1RBVEVfU0xVUlApICYmCi0gICAgICAgICAgICAgICAgICAgIChzdC0+ZGVzdC5zaWcgJiAo
UEFSUk9UX0FSR19TTFVSUFlfQVJSQVl8UEFSUk9UX0FSR19OQU1FKSkKLSAgICAgICAgICAgICAg
ICAgICAgPT0gUEFSUk9UX0FSR19TTFVSUFlfQVJSQVkpIHsKLSAgICAgICAgICAgICAgICAvKiBj
cmVhdGUgZGVzdCBzbHVycCBhcnJheSAqLwotICAgICAgICAgICAgICAgIGlkeCA9IHN0LT5kZXN0
LnUub3AucGNbc3QtPmRlc3QuaV07Ci0gICAgICAgICAgICAgICAgYXNzZXJ0KGlkeCA+PSAwKTsK
LSAgICAgICAgICAgICAgICBjcmVhdGVfc2x1cnB5X2FycmF5KGludGVycCwgc3QsIGlkeCk7Ci0g
ICAgICAgICAgICAgICAgc3RhdGUgPSBDQUxMX1NUQVRFX1BPU19QT1NfU0xVUlA7Ci0gICAgICAg
ICAgICB9Ci0gICAgICAgICAgICAvKiBwb3NpdGlvbmFsIHNyYyAtPiBuYW1lZCBzcmMgKi8KLSAg
ICAgICAgICAgIGlmIChzdC0+bmFtZSkgewotICAgICAgICAgICAgICAgIHN0LT5kZXN0Lm1vZGUg
fD0gQ0FMTF9TVEFURV9OQU1FRF94OworICAgICAgICAvKiBjaGVjayBpZiB0aGUgbmV4dCBkZXN0
IGFyZyBpcyA6c2x1cnB5ICovCisgICAgICAgIG5leHRfYXJnX3NpZyhpbnRlcnAsIGRlc3QpOwor
ICAgICAgICBpZiAoZGVzdC0+c2lnICYgUEFSUk9UX0FSR19TTFVSUFlfQVJSQVkpCisgICAgICAg
ICAgICBicmVhazsKIAotICAgICAgICAgICAgICAgIGlmIChzdGF0ZSA9PSBDQUxMX1NUQVRFX1BP
U19QT1NfU0xVUlApIHsKLSAgICAgICAgICAgICAgICAgICAgLyogc3RvcCBzbHVycHkgYXJyYXkg
Ki8KLSAgICAgICAgICAgICAgICAgICAgc3QtPmRlc3Quc2x1cnAgPSBOVUxMOwotICAgICAgICAg
ICAgICAgICAgICBzdC0+ZGVzdC5tb2RlICY9IH5DQUxMX1NUQVRFX1NMVVJQOwotICAgICAgICAg
ICAgICAgICAgICAvKgotICAgICAgICAgICAgICAgICAgICAgKiB3b3JrIGFyb3VuZCBiYWQgaW50
ZXJhY3Rpb24gb2YgX05FWFRfQVJHCi0gICAgICAgICAgICAgICAgICAgICAqIGFuZCBmbGF0dGVu
aW5nICh3aGljaCBhbHdheXMgYWR2YW5jZXMgdG8gbmV4dCkKLSAgICAgICAgICAgICAgICAgICAg
ICogVE9ETyByZXdyaXRlIGFsbCBhZ2Fpbiwgbm93IHRoYXQgYWxsIHBpZWNlcyBhcmUKLSAgICAg
ICAgICAgICAgICAgICAgICogdG9nZXRoZXIKLSAgICAgICAgICAgICAgICAgICAgICovCi0gICAg
ICAgICAgICAgICAgICAgIGlmIChzdC0+c3JjLm1vZGUgJiBDQUxMX1NUQVRFX0ZMQVRURU4pIHsK
LSAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbmV4dF9hcmcoaW50ZXJwLCAmc3QtPmRlc3Qp
KSB7Ci0gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3QtPmRlc3QubW9kZSB8PSBDQUxMX1NU
QVRFX3hfRU5EOwotICAgICAgICAgICAgICAgICAgICAgICAgfQotICAgICAgICAgICAgICAgICAg
ICB9Ci0gICAgICAgICAgICAgICAgICAgIGVsc2UgewotICAgICAgICAgICAgICAgICAgICAgICAg
c3QtPnNyYy5tb2RlICY9IH5DQUxMX1NUQVRFX05FWFRfQVJHOwotICAgICAgICAgICAgICAgICAg
ICAgICAgc3QtPmRlc3QubW9kZSB8PSBDQUxMX1NUQVRFX05FWFRfQVJHOwotICAgICAgICAgICAg
ICAgICAgICAgICAgY29udGludWU7Ci0gICAgICAgICAgICAgICAgICAgIH0KLSAgICAgICAgICAg
ICAgICB9Ci0gICAgICAgICAgICB9Ci0gICAgICAgIH0KKyAgICAgICAgLyogY2hlY2sgaWYgdGhl
cmUgaXMgYW5vdGhlciBhcmd1bWVudC4gd2UgbmVlZCB0byBzdG9yZSB0aGUgdmFsdWUgdG8KKyAg
ICAgICAgICogaGFuZGxlIDpvcHRfZmxhZywgd2hpY2ggbmVlZHMgdG8ga25vdyBpZiB0aGVyZSB3
YXMgYSBwcmVjZWRpbmcKKyAgICAgICAgICogYXJndW1lbnQuICovCisgICAgICAgIGhhc19hcmcg
PSBQYXJyb3RfZmV0Y2hfYXJnKGludGVycCwgc3QpOwogCi0gICAgICAgIC8qIGZpcnN0IGRlc3Qg
bmFtZWQgYXJnLCBzZXR1cCBmb3IgcmVjaWV2aW5nIG9mIG5hbWVkIGFyZ3MgKi8KLSAgICAgICAg
aWYgKCEoc3RhdGUgJiBDQUxMX1NUQVRFX3hfTkFNRUQpICYmIChzdC0+ZGVzdC5zaWcgJiBQQVJS
T1RfQVJHX05BTUUpKSB7Ci0gICAgICAgICAgICAvKiBwb3MgLT4gbmFtZWQgZGVzdCAqLwotICAg
ICAgICAgICAgaW5pdF9maXJzdF9kZXN0X25hbWVkKGludGVycCwgc3QpOwotICAgICAgICB9Cisg
ICAgICAgIC8qIGlmIHRoZSBzcmMgYXJnIGlzIG5hbWVkLCB3ZSdyZSBkb25lIGhlcmUgKi8KKyAg
ICAgICAgaWYgKHN0LT5uYW1lKQorICAgICAgICAgICAgYnJlYWs7CiAKLSAgICAgICAgc3RhdGUg
PSBzdC0+ZGVzdC5tb2RlICYgQ0FMTF9TVEFURV9NQVNLOwotICAgICAgICBzd2l0Y2ggKHN0YXRl
KSB7Ci0gICAgICAgICAgICBjYXNlIENBTExfU1RBVEVfTkFNRURfTkFNRUQ6Ci0gICAgICAgICAg
ICBjYXNlIENBTExfU1RBVEVfTkFNRURfTkFNRURfT1BUOgotICAgICAgICAgICAgICAgIGlmICgh
bG9jYXRlX25hbWVkX25hbWVkKGludGVycCwgc3QpKQotICAgICAgICAgICAgICAgICAgICByZWFs
X2V4Y2VwdGlvbihpbnRlcnAsIE5VTEwsIEVfVmFsdWVFcnJvciwKLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAidG9vIG1hbnkgbmFtZWQgYXJndW1lbnRzIC0gJyVTcycgbm90IGV4cGVjdGVk
Iiwgc3QtPm5hbWUpOwotICAgICAgICAgICAgICAgIGlmIChzdC0+ZGVzdC5tb2RlICYgQ0FMTF9T
VEFURV9TTFVSUCkKLSAgICAgICAgICAgICAgICAgICAgc3RhdGUgfD0gQ0FMTF9TVEFURV9TTFVS
UDsKKyAgICAgICAgLyogaWYgdGhlIGRlc3QgaXMgYSBuYW1lZCBhcmd1bWVudCwgd2UgbmVlZCB0
byBmaWxsIGl0IGFzIGEgcG9zaXRpb25hbAorICAgICAgICAgKiBzaW5jZSBubyBuYW1lZCBhcmd1
bWVudHMgaGF2ZSBiZWVuIGdpdmVuLiBzbyBza2lwIHRoZSBuYW1lLiAqLworICAgICAgICBpZiAo
ZGVzdC0+c2lnICYgUEFSUk9UX0FSR19OQU1FKSB7CisgICAgICAgICAgICBpZiAoIWhhc19hcmcp
CiAgICAgICAgICAgICAgICAgYnJlYWs7Ci0gICAgICAgICAgICBjYXNlIENBTExfU1RBVEVfUE9T
X05BTUVEOgotICAgICAgICAgICAgICAgIGxvY2F0ZV9wb3NfbmFtZWQoaW50ZXJwLCBzdCk7Ci0g
ICAgICAgICAgICAgICAgYnJlYWs7CisgICAgICAgICAgICBkZXN0LT5pKys7CisgICAgICAgICAg
ICBuZXh0X2FyZ19zaWcoaW50ZXJwLCBkZXN0KTsKICAgICAgICAgfQotICAgICAgICBpZiAoc3Qt
PmRlc3Quc2lnICYgUEFSUk9UX0FSR19PUFRJT05BTCkgewotICAgICAgICAgICAgc3QtPmRlc3Qu
bW9kZSB8PSBDQUxMX1NUQVRFX09QVDsKLSAgICAgICAgICAgIHN0YXRlICAgICAgICAgfD0gQ0FM
TF9TVEFURV9PUFQ7CisKKyAgICAgICAgLyogaWYgdGhlcmUgKmlzKiBhbiBhcmcsIGNvbnZlcnQg
aXQgKi8KKyAgICAgICAgaWYgKGhhc19hcmcpIHsKKyAgICAgICAgICAgIHNyYy0+dXNlZCA9IDE7
CisgICAgICAgICAgICBQYXJyb3RfY29udmVydF9hcmcoaW50ZXJwLCBzdCk7CiAgICAgICAgIH0K
LSAgICAgICAgZWxzZSBpZiAoc3RhdGUgJiBDQUxMX1NUQVRFX1NMVVJQKSB7Ci0gICAgICAgICAg
ICBzdC0+ZGVzdC5zaWcgJj0gflBBUlJPVF9BUkdfVFlQRV9NQVNLOwotICAgICAgICAgICAgc3Qt
PmRlc3Quc2lnIHw9IFBBUlJPVF9BUkdfUE1DOwotICAgICAgICB9CisgICAgICAgIC8qIGlmIHRo
aXMgaXMgYW4gb3B0aW9uYWwgYXJndW1lbnQsIG51bGwgaXQgKi8KKyAgICAgICAgZWxzZSBpZiAo
ZGVzdC0+c2lnICYgUEFSUk9UX0FSR19PUFRJT05BTCkKKyAgICAgICAgICAgIG51bGxfdmFsKHN0
LT5kZXN0LnNpZywgc3QpOworICAgICAgICAvKiB0aGVyZSdzIG5vIGFyZ3VtZW50IC0gdGhyb3cg
YW4gZXhjZXB0aW9uIChpZiB3ZSdyZSBpbiB0byB0aGF0KSAqLworICAgICAgICBlbHNlIGlmIChl
cnJfY2hlY2spCisgICAgICAgICAgICB0b29fZmV3KGludGVycCwgc3QsIGFjdGlvbik7CisgICAg
ICAgIC8qIG90aGVyd2lzZSwgd2UncmUgZG9uZSAqLworICAgICAgICBlbHNlCisgICAgICAgICAg
ICByZXR1cm47CisgICAgICAgIC8qIGFjdHVhbGx5IHN0b3JlIHRoZSBhcmd1bWVudCAqLworICAg
ICAgICBpZHggPSBzdC0+ZGVzdC51Lm9wLnBjW3N0LT5kZXN0LmldOworICAgICAgICBhc3NlcnQo
aWR4ID49IDApOworICAgICAgICBzdG9yZV9hcmcoc3QsIGlkeCk7CiAKLSAgICAgICAgc3dpdGNo
IChzdGF0ZSkgewotICAgICAgICAgICAgY2FzZSBDQUxMX1NUQVRFX1BPU19QT1M6Ci0gICAgICAg
ICAgICAgICAgc3QtPmRlc3QubW9kZSB8PSBDQUxMX1NUQVRFX05FWFRfQVJHOwotICAgICAgICAg
ICAgICAgIFBhcnJvdF9jb252ZXJ0X2FyZyhpbnRlcnAsIHN0KTsKLSAgICAgICAgICAgICAgICBz
dG9yZV9jdXJyZW50X2FyZyhpbnRlcnAsIHN0KTsKKyAgICAgICAgLyogaWYgd2UncmUgYXQgYW4g
Om9wdGlvbmFsIGFyZ3VtZW50LCB3ZSBuZWVkIHRvIGNoZWNrIGZvciBhbiA6b3B0X2ZsYWcgKi8K
KyAgICAgICAgaWYgKGRlc3QtPnNpZyAmIFBBUlJPVF9BUkdfT1BUSU9OQUwpIHsKKyAgICAgICAg
ICAgIElOVFZBTCBpZHg7CisgICAgICAgICAgICArK3N0LT5vcHRpb25hbHM7CisKKyAgICAgICAg
ICAgIC8qIGxvb2sgYXQgdGhlIG5leHQgYXJnICovCisgICAgICAgICAgICBkZXN0LT5pKys7Cisg
ICAgICAgICAgICBpZiAoZGVzdC0+aSA+PSBkZXN0LT5uKQogICAgICAgICAgICAgICAgIGJyZWFr
OwogCi0gICAgICAgICAgICBjYXNlIENBTExfU1RBVEVfTkFNRURfTkFNRUQ6Ci0gICAgICAgICAg
ICBjYXNlIENBTExfU1RBVEVfUE9TX05BTUVEOgotICAgICAgICAgICAgICAgIFBhcnJvdF9jb252
ZXJ0X2FyZyhpbnRlcnAsIHN0KTsKLSAgICAgICAgICAgICAgICBzdG9yZV9jdXJyZW50X2FyZyhp
bnRlcnAsIHN0KTsKKyAgICAgICAgICAgIG5leHRfYXJnX3NpZyhpbnRlcnAsIGRlc3QpOworICAg
ICAgICAgICAgLyogaWYgdGhpcyBpc24ndCBhbiA6b3B0X2ZsYWcgYXJndW1lbnQsIHdlIG5lZWQg
dG8gcmVzZXQgdGhpbmdzCisgICAgICAgICAgICAgKiBhbmQgZ28gdG8gdGhlIG5leHQgYXJndW1l
bnQgKi8KKyAgICAgICAgICAgIGlmICghKHN0LT5kZXN0LnNpZyAmIFBBUlJPVF9BUkdfT1BUX0ZM
QUcpKSB7CisgICAgICAgICAgICAgICAgZGVzdC0+aS0tOworICAgICAgICAgICAgICAgIGNvbnRp
bnVlOworICAgICAgICAgICAgfQorCisgICAgICAgICAgICAvKiB3ZSdyZSBhdCBhbiA6b3B0X2Zs
YWcgYXJndW1lbnQsIHNvIGFjdHVhbGx5IHN0b3JlIHNvbWV0aGluZyAqLworICAgICAgICAgICAg
aWR4ID0gc3QtPmRlc3QudS5vcC5wY1tzdC0+ZGVzdC5pXTsKKyAgICAgICAgICAgIC0tc3QtPnBh
cmFtczsKKyAgICAgICAgICAgIGFzc2VydChpZHggPj0gMCk7CisgICAgICAgICAgICBDVFhfUkVH
X0lOVChzdC0+ZGVzdC5jdHgsIGlkeCkgPSBoYXNfYXJnOworICAgICAgICB9CisgICAgfQorCisK
KyAgICAvKgorICAgICAqIDJuZDogUG9zaXRpb25hbCA6c2x1cnB5CisgICAgICovCisgICAgaWYg
KGRlc3QtPnNpZyAmIFBBUlJPVF9BUkdfU0xVUlBZX0FSUkFZICYmICEoZGVzdC0+c2lnICYgUEFS
Uk9UX0FSR19OQU1FKSkgeworICAgICAgICBQTUMgKmFycmF5ID0gcG1jX25ldyhpbnRlcnAsIGVu
dW1fY2xhc3NfUmVzaXphYmxlUE1DQXJyYXkpOworCisgICAgICAgIElOVFZBTCBpZHggPSBzdC0+
ZGVzdC51Lm9wLnBjW2Rlc3QtPmldOworICAgICAgICBhc3NlcnQoaWR4ID49IDApOworICAgICAg
ICAvKiBNdXN0IHJlZ2lzdGVyIHRoaXMgUE1DIG9yIGl0IG1heSBnZXQgY29sbGVjdGVkIHdoZW4g
b25seSB0aGUgc3RydWN0CisgICAgICAgICAqIHJlZmVyZW5jZXMgaXQuICovCisgICAgICAgIGRv
ZF9yZWdpc3Rlcl9wbWMoaW50ZXJwLCBhcnJheSk7CisgICAgICAgIENUWF9SRUdfUE1DKHN0LT5k
ZXN0LmN0eCwgaWR4KSA9IGFycmF5OworCisgICAgICAgIHdoaWxlIChQYXJyb3RfZmV0Y2hfYXJn
KGludGVycCwgc3QpKSB7CisgICAgICAgICAgICAvKiBpZiB0aGUgc3JjIGFyZyBpcyBuYW1lZCwg
d2UncmUgZG9uZSBoZXJlICovCisgICAgICAgICAgICBpZiAoc3QtPm5hbWUpCiAgICAgICAgICAg
ICAgICAgYnJlYWs7CiAKLSAgICAgICAgICAgIGNhc2UgQ0FMTF9TVEFURV9OQU1FRF9OQU1FRF9P
UFQ6Ci0gICAgICAgICAgICBjYXNlIENBTExfU1RBVEVfUE9TX1BPU19PUFQ6Ci0gICAgICAgICAg
ICAgICAgb3B0X2ZsYWcgPSAxOworICAgICAgICAgICAgc3JjLT51c2VkID0gMTsKIAotICAgICAg
ICAgICAgICBzdG9yZV9vcHQ6CisgICAgICAgICAgICAvKiB3ZSBoYXZlIHRvIGNvbnZlcnQgdG8g
YSBQTUMgdG8gd2UgY2FuIHB1dCBpdCBpbiB0aGUgUE1DIGFycmF5ICovCisgICAgICAgICAgICBk
ZXN0LT5zaWcgfD0gUEFSUk9UX0FSR19QTUM7CisgICAgICAgICAgICBQYXJyb3RfY29udmVydF9h
cmcoaW50ZXJwLCBzdCk7CisKKyAgICAgICAgICAgIFZUQUJMRV9wdXNoX3BtYyhpbnRlcnAsIGFy
cmF5LCBVVmFsX3BtYyhzdC0+dmFsKSk7CisgICAgICAgIH0KKworICAgICAgICBkZXN0LT5pKys7
CisgICAgICAgIGRvZF91bnJlZ2lzdGVyX3BtYyhpbnRlcnAsIGFycmF5KTsKKyAgICB9CisKKyAg
ICAvKiBpcyB0aGVyZSBhbm90aGVyIGFyZ3VtZW50PyBpZiB3ZSdyZSB0aG93aW5nIGVycm9ycywg
dGhhdCdzIGFuIGVycm9yICovCisgICAgaWYgKGVycl9jaGVjayAmJiBQYXJyb3RfZmV0Y2hfYXJn
KGludGVycCwgc3QpICYmICFzdC0+bmFtZSAmJiAhKGRlc3QtPnNpZyAmIFBBUlJPVF9BUkdfTkFN
RSkpCisgICAgICAgIHRvb19tYW55KGludGVycCwgc3QsIGFjdGlvbik7CisKKyAgICAvKiBhcmUg
d2UgYXQgdGhlIGVuZD8gKi8KKyAgICBpZiAoZGVzdC0+aSA9PSBkZXN0LT5uKQorICAgICAgICBy
ZXR1cm47CisKKworICAgIC8qCisgICAgICogM3JkOiA6bmFtZWQKKyAgICAgKi8KKyAgICBpbml0
X2ZpcnN0X2Rlc3RfbmFtZWQoaW50ZXJwLCBzdCk7CisgICAgbl9uYW1lZCA9IDA7CisgICAgd2hp
bGUgKFBhcnJvdF9mZXRjaF9hcmcoaW50ZXJwLCBzdCkpIHsKKyAgICAgICAgc3JjLT51c2VkID0g
MTsKKworICAgICAgICBpZiAoIXN0LT5uYW1lKQorICAgICAgICAgICAgcmVhbF9leGNlcHRpb24o
aW50ZXJwLCBOVUxMLCAwLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgInBvc2l0aW9uYWwg
aW5zaWRlIG5hbWVkIGFyZ3MgYXQgcG9zaXRpb24gJWkiLAorICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc3QtPnNyYy5pIC0gbl9uYW1lZCk7CisKKyAgICAgICAgaWYgKCFsb2NhdGVfbmFtZWRf
bmFtZWQoaW50ZXJwLCBzdCkpCisgICAgICAgICAgICByZWFsX2V4Y2VwdGlvbihpbnRlcnAsIE5V
TEwsIEVfVmFsdWVFcnJvciwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0b28gbWFueSBu
YW1lZCBhcmd1bWVudHMgLSAnJVNzJyBub3QgZXhwZWN0ZWQiLCBzdC0+bmFtZSk7CisKKyAgICAg
ICAgbl9uYW1lZCsrOworICAgICAgICAvKiBpZiB0aGUgZGVzdCBhcmcgaXMgOm5hbWVkIDpzbHVy
cHkgKi8KKyAgICAgICAgaWYgKGRlc3QtPnNpZyAmIFBBUlJPVF9BUkdfU0xVUlBZX0FSUkFZKSB7
CisgICAgICAgICAgICAvKiBDb252ZXJ0IHRvIGEgUE1DIHRvIHN0b3JlIGluIHRoZSBoYXNoICov
CisgICAgICAgICAgICBkZXN0LT5zaWcgfD0gUEFSUk9UX0FSR19QTUM7CisgICAgICAgICAgICBQ
YXJyb3RfY29udmVydF9hcmcoaW50ZXJwLCBzdCk7CisgICAgICAgICAgICBWVEFCTEVfc2V0X3Bt
Y19rZXllZF9zdHIoaW50ZXJwLCBkZXN0LT5zbHVycCwgc3QtPm5hbWUsIFVWYWxfcG1jKHN0LT52
YWwpKTsKKyAgICAgICAgfQorICAgICAgICBlbHNlIHsKKyAgICAgICAgICAgIFBhcnJvdF9jb252
ZXJ0X2FyZyhpbnRlcnAsIHN0KTsKKyAgICAgICAgICAgIHN0b3JlX2N1cnJlbnRfYXJnKGludGVy
cCwgc3QpOworCisgICAgICAgICAgICAvKiBpZiB3ZSdyZSBhdCBhbiA6b3B0aW9uYWwgYXJndW1l
bnQsIHdlIG5lZWQgdG8gY2hlY2sgZm9yIGFuIDpvcHRfZmxhZyAqLworICAgICAgICAgICAgaWYg
KGRlc3QtPnNpZyAmIFBBUlJPVF9BUkdfT1BUSU9OQUwpIHsKKyAgICAgICAgICAgICAgICBJTlRW
QUwgaWR4OwogICAgICAgICAgICAgICAgICsrc3QtPm9wdGlvbmFsczsKLSAgICAgICAgICAgICAg
ICBQYXJyb3RfY29udmVydF9hcmcoaW50ZXJwLCBzdCk7Ci0gICAgICAgICAgICAgICAgc3RvcmVf
Y3VycmVudF9hcmcoaW50ZXJwLCBzdCk7CiAKLSAgICAgICAgICAgICAgICAvKiA6b3B0X2ZsYWcg
aXMgdHJ1ZWx5IG9wdGlvbmFsICovCi0gICAgICAgICAgICAgICAgaWYgKCFuZXh0X2FyZyhpbnRl
cnAsICZzdC0+ZGVzdCkpIHsKLSAgICAgICAgICAgICAgICAgICAgLyogZG8gbm90aGluZyAqLwor
ICAgICAgICAgICAgICAgIC8qIGxvb2sgYXQgdGhlIG5leHQgYXJnICovCisgICAgICAgICAgICAg
ICAgZGVzdC0+aSsrOworICAgICAgICAgICAgICAgIGlmIChkZXN0LT5pID49IGRlc3QtPm4pCisg
ICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOworCisgICAgICAgICAgICAgICAgbmV4dF9hcmdf
c2lnKGludGVycCwgZGVzdCk7CisgICAgICAgICAgICAgICAgLyogaWYgdGhpcyBpc24ndCBhbiA6
b3B0X2ZsYWcgYXJndW1lbnQsIHdlIG5lZWQgdG8gcmVzZXQgdGhpbmdzCisgICAgICAgICAgICAg
ICAgICogYW5kIGdvIHRvIHRoZSBuZXh0IGFyZ3VtZW50ICovCisgICAgICAgICAgICAgICAgaWYg
KCEoc3QtPmRlc3Quc2lnICYgUEFSUk9UX0FSR19PUFRfRkxBRykpIHsKKyAgICAgICAgICAgICAg
ICAgICAgZGVzdC0+aS0tOworICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAg
ICAgICAgICB9Ci0gICAgICAgICAgICAgICAgZWxzZSBpZiAoIShzdC0+ZGVzdC5zaWcgJiBQQVJS
T1RfQVJHX09QVF9GTEFHKSkgewotICAgICAgICAgICAgICAgICAgICBzdC0+ZGVzdC5pLS07Ci0g
ICAgICAgICAgICAgICAgfQotICAgICAgICAgICAgICAgIGVsc2UKLSAgICAgICAgICAgICAgICB7
Ci0gICAgICAgICAgICAgICAgICAgIGludCBpZHggPSBzdC0+ZGVzdC51Lm9wLnBjW3N0LT5kZXN0
LmldOwotICAgICAgICAgICAgICAgICAgICAtLXN0LT5wYXJhbXM7Ci0gICAgICAgICAgICAgICAg
ICAgIGFzc2VydChpZHggPj0gMCk7Ci0gICAgICAgICAgICAgICAgICAgIENUWF9SRUdfSU5UKHN0
LT5kZXN0LmN0eCwgaWR4KSA9IG9wdF9mbGFnOwotICAgICAgICAgICAgICAgIH0KLSAgICAgICAg
ICAgICAgICBpZiAoIShzdGF0ZSAmIENBTExfU1RBVEVfeF9OQU1FRCkpCi0gICAgICAgICAgICAg
ICAgICAgIHN0LT5kZXN0Lm1vZGUgfD0gQ0FMTF9TVEFURV9ORVhUX0FSRzsKLSAgICAgICAgICAg
ICAgICBicmVhazsKLSAgICAgICAgICAgIGNhc2UgQ0FMTF9TVEFURV9FTkRfUE9TX09QVDoKLSAg
ICAgICAgICAgICAgICBudWxsX3ZhbChzdC0+ZGVzdC5zaWcsIHN0KTsKLSAgICAgICAgICAgICAg
ICBvcHRfZmxhZyA9IDA7Ci0gICAgICAgICAgICAgICAgZ290byBzdG9yZV9vcHQ7Ci0gICAgICAg
ICAgICBjYXNlIENBTExfU1RBVEVfUE9TX1BPU19TTFVSUDoKLSAgICAgICAgICAgICAgICBQYXJy
b3RfY29udmVydF9hcmcoaW50ZXJwLCBzdCk7Ci0gICAgICAgICAgICAgICAgVlRBQkxFX3B1c2hf
cG1jKGludGVycCwgc3QtPmRlc3Quc2x1cnAsIFVWYWxfcG1jKHN0LT52YWwpKTsKLSAgICAgICAg
ICAgICAgICBicmVhazsKLSAgICAgICAgICAgIGNhc2UgQ0FMTF9TVEFURV9OQU1FRF9OQU1FRF9T
TFVSUDoKLSAgICAgICAgICAgICAgICBQYXJyb3RfY29udmVydF9hcmcoaW50ZXJwLCBzdCk7Ci0g
ICAgICAgICAgICAgICAgVlRBQkxFX3NldF9wbWNfa2V5ZWRfc3RyKGludGVycCwgc3QtPmRlc3Qu
c2x1cnAsIHN0LT5uYW1lLCBVVmFsX3BtYyhzdC0+dmFsKSk7Ci0gICAgICAgICAgICAgICAgYnJl
YWs7CiAKLSAgICAgICAgICAgIGNhc2UgQ0FMTF9TVEFURV9FTkRfTkFNRURfTkFNRUR8Q0FMTF9T
VEFURV9PUFQ6Ci0gICAgICAgICAgICBjYXNlIENBTExfU1RBVEVfRU5EX05BTUVEX05BTUVEOgot
ICAgICAgICAgICAgY2FzZSBDQUxMX1NUQVRFX0VORF9QT1NfTkFNRUQ6Ci0gICAgICAgICAgICAg
ICAgY2hlY2tfbmFtZWQoaW50ZXJwLCBzdCwgYWN0aW9uKTsKLSAgICAgICAgICAgICAgICByZXR1
cm47Ci0KLSAgICAgICAgICAgIC8qIGVycm9yIGNvbmRpdGlvbnMgKi8KLSAgICAgICAgICAgIGNh
c2UgQ0FMTF9TVEFURV9FTkRfeDoKLSAgICAgICAgICAgICAgICBpZiAoZXJyX2NoZWNrKQotICAg
ICAgICAgICAgICAgICAgICB0b29fZmV3KGludGVycCwgc3QsIGFjdGlvbik7Ci0gICAgICAgICAg
ICAgICAgcmV0dXJuOwotICAgICAgICAgICAgY2FzZSBDQUxMX1NUQVRFX3hfRU5EfENBTExfU1RB
VEVfT1BUOgotICAgICAgICAgICAgY2FzZSBDQUxMX1NUQVRFX3hfRU5EOgotICAgICAgICAgICAg
ICAgIGlmIChlcnJfY2hlY2spCi0gICAgICAgICAgICAgICAgICAgIHRvb19tYW55KGludGVycCwg
c3QsIGFjdGlvbik7Ci0gICAgICAgICAgICAgICAgcmV0dXJuOwotICAgICAgICAgICAgY2FzZSBD
QUxMX1NUQVRFX0VORF94fENBTExfU1RBVEVfU0xVUlA6Ci0gICAgICAgICAgICAgICAgLyogdGhp
cyBoYXBwZW5zIHdoZW4gZmxhdHRlbmluZyBhbiBlbXB0eSBhcnJheSBpbnRvIGEgc2x1cnB5ICov
Ci0gICAgICAgICAgICAgICAgcmV0dXJuOwotICAgICAgICAgICAgY2FzZSBDQUxMX1NUQVRFX05B
TUVEX1BPUzoKLSAgICAgICAgICAgIGNhc2UgQ0FMTF9TVEFURV9OQU1FRF9QT1NfT1BUOgotICAg
ICAgICAgICAgY2FzZSBDQUxMX1NUQVRFX05BTUVEX1BPU19TTFVSUDoKLSAgICAgICAgICAgICAg
ICByZWFsX2V4Y2VwdGlvbihpbnRlcnAsIE5VTEwsIEVfVmFsdWVFcnJvciwgInRvbyBtYW55IG5h
bWVkIGFyZ3VtZW50cyIpOwotICAgICAgICAgICAgICAgIGJyZWFrOwotICAgICAgICAgICAgY2Fz
ZSBDQUxMX1NUQVRFX05BTUVEX3h8Q0FMTF9TVEFURV94X05BTUVEfENBTExfU1RBVEVfeF9FTkQ6
Ci0gICAgICAgICAgICAgICAgLyogWFhYOiB0aGlzIHN0YXRlIGRvZXNuJ3QgcHJvcGVybHkgcmVm
bGVjdCB3aGF0J3MgZ29pbmcgb24gKi8KLSAgICAgICAgICAgICAgICByZWFsX2V4Y2VwdGlvbihp
bnRlcnAsIE5VTEwsIDAsCi0gICAgICAgICAgICAgICAgICAgICAgICAicG9zaXRpb25hbCBpbnNp
ZGUgbmFtZWQgYXJncyBhdCBwb3NpdGlvbiAlaSIsIHN0LT5zcmMuaS0xKTsKLSAgICAgICAgICAg
ICAgICBicmVhazsKLSAgICAgICAgICAgIGRlZmF1bHQ6Ci0gICAgICAgICAgICAgICAgcmVhbF9l
eGNlcHRpb24oaW50ZXJwLCBOVUxMLCAwLCAiVW5oYW5kbGVkIHByb2Nlc3NfYXJncyBzdGF0ZSAw
eCV4Iiwgc3RhdGUpOwotICAgICAgICAgICAgICAgIGJyZWFrOworICAgICAgICAgICAgICAgIC8q
IHdlJ3JlIGF0IGFuIDpvcHRfZmxhZyBhcmd1bWVudCwgc28gYWN0dWFsbHkgc3RvcmUgc29tZXRo
aW5nICovCisgICAgICAgICAgICAgICAgaWR4ID0gc3QtPmRlc3QudS5vcC5wY1tzdC0+ZGVzdC5p
XTsKKyAgICAgICAgICAgICAgICAtLXN0LT5wYXJhbXM7CisgICAgICAgICAgICAgICAgYXNzZXJ0
KGlkeCA+PSAwKTsKKyAgICAgICAgICAgICAgICBDVFhfUkVHX0lOVChzdC0+ZGVzdC5jdHgsIGlk
eCkgPSAxOworICAgICAgICAgICAgfQogICAgICAgICB9Ci0gICAgfSB3aGlsZSAoMSk7CisKKyAg
ICAgICAgLyogb3RoZXJ3aXNlIHRoaXMgZG9lc24ndCBnZXQgcmVzZXQgYW5kIHdlIGNhbid0IGNh
dGNoIHBvc2l0aW9uYWwgYXJncworICAgICAgICAgKiBpbnNpZGUgb2YgbmFtZWQgYXJncyAqLwor
ICAgICAgICBzdC0+bmFtZSA9IE5VTEw7CisgICAgfQorCisgICAgY2hlY2tfbmFtZWQoaW50ZXJw
LCBzdCwgYWN0aW9uKTsKKyAgICAvKiB3ZSBtYXkgb3IgbWF5IG5vdCBoYXZlIHJlZ2lzdGVyZWQg
dGhpcyBwbWMgKi8KKyAgICBkb2RfdW5yZWdpc3Rlcl9wbWMoaW50ZXJwLCBkZXN0LT5zbHVycCk7
CiB9CiAKIHZvaWQKIFBhcnJvdF9jb252ZXJ0X2FyZyhJbnRlcnAgKmludGVycCwgY2FsbF9zdGF0
ZSAqc3QpCiB7Ci0jZGVmaW5lIEVORF9PRl9BUkdTKHgpICh4LmkgPj0geC5uKQotICAgIC8qIGlm
IEVORCBPRiBTUkMgb3IgREVTVCBBUkdTLCBubyBuZWVkIHRvIGNvbnZlcnQgKi8KLSAgICBpZiAo
KEVORF9PRl9BUkdTKHN0LT5zcmMpIHx8IEVORF9PRl9BUkdTKHN0LT5kZXN0KSkpCi0gICAgICAg
IHJldHVybjsKLQogICAgIC8qIHJlZ2lzdGVyIGtleSBhcmdzIGhhdmUgdG8gYmUgY2xvbmVkICov
CiAgICAgaWYgKChzdC0+c3JjLnNpZyAmIFBBUlJPVF9BUkdfVFlQRV9NQVNLKSA9PSBQQVJST1Rf
QVJHX1BNQykKICAgICAgICAgY2xvbmVfa2V5X2FyZyhpbnRlcnAsIHN0KTsKQEAgLTEwNDIsNyAr
MTAzOCw2IEBACiAgICAgICAgIGNhc2UgUEFSUk9UX0FSR19QTUM6CiAgICAgICAgICAgICBjb252
ZXJ0X2FyZ19mcm9tX3BtYyhpbnRlcnAsIHN0KTsKICAgICAgICAgICAgIGJyZWFrOwotCiAgICAg
fQogfQogCkluZGV4OiB0b29scy9idWlsZC9uYXRpdmVjYWxsLnBsCj09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLS0tIHRv
b2xzL2J1aWxkL25hdGl2ZWNhbGwucGwJKHJldmlzaW9uIDE4Mjk3KQorKysgdG9vbHMvYnVpbGQv
bmF0aXZlY2FsbC5wbAkod29ya2luZyBjb3B5KQpAQCAtMzcwLDM2ICszNzAsNDQgQEAKIHNldF9u
Y2lfSShJbnRlcnAgKmludGVycCwgY2FsbF9zdGF0ZSAqc3QsIElOVFZBTCB2YWwpCiB7CiAgICAg
UGFycm90X2luaXRfcmV0X25jaShpbnRlcnAsIHN0LCAiSSIpOwotICAgIFVWYWxfaW50KHN0LT52
YWwpID0gdmFsOwotICAgIFBhcnJvdF9jb252ZXJ0X2FyZyhpbnRlcnAsIHN0KTsKLSAgICBQYXJy
b3Rfc3RvcmVfYXJnKGludGVycCwgc3QpOworICAgIGlmIChzdC0+ZGVzdC5pIDwgc3QtPmRlc3Qu
bikgeworICAgICAgICBVVmFsX2ludChzdC0+dmFsKSA9IHZhbDsKKyAgICAgICAgUGFycm90X2Nv
bnZlcnRfYXJnKGludGVycCwgc3QpOworICAgICAgICBQYXJyb3Rfc3RvcmVfYXJnKGludGVycCwg
c3QpOworICAgIH0KIH0KIAogc3RhdGljIHZvaWQKIHNldF9uY2lfTihJbnRlcnAgKmludGVycCwg
Y2FsbF9zdGF0ZSAqc3QsIEZMT0FUVkFMIHZhbCkKIHsKICAgICBQYXJyb3RfaW5pdF9yZXRfbmNp
KGludGVycCwgc3QsICJOIik7Ci0gICAgVVZhbF9udW0oc3QtPnZhbCkgPSB2YWw7Ci0gICAgUGFy
cm90X2NvbnZlcnRfYXJnKGludGVycCwgc3QpOwotICAgIFBhcnJvdF9zdG9yZV9hcmcoaW50ZXJw
LCBzdCk7CisgICAgaWYgKHN0LT5kZXN0LmkgPCBzdC0+ZGVzdC5uKSB7CisgICAgICAgIFVWYWxf
bnVtKHN0LT52YWwpID0gdmFsOworICAgICAgICBQYXJyb3RfY29udmVydF9hcmcoaW50ZXJwLCBz
dCk7CisgICAgICAgIFBhcnJvdF9zdG9yZV9hcmcoaW50ZXJwLCBzdCk7CisgICAgfQogfQogCiBz
dGF0aWMgdm9pZAogc2V0X25jaV9TKEludGVycCAqaW50ZXJwLCBjYWxsX3N0YXRlICpzdCwgU1RS
SU5HICp2YWwpCiB7CiAgICAgUGFycm90X2luaXRfcmV0X25jaShpbnRlcnAsIHN0LCAiUyIpOwot
ICAgIFVWYWxfc3RyKHN0LT52YWwpID0gdmFsOwotICAgIFBhcnJvdF9jb252ZXJ0X2FyZyhpbnRl
cnAsIHN0KTsKLSAgICBQYXJyb3Rfc3RvcmVfYXJnKGludGVycCwgc3QpOworICAgIGlmIChzdC0+
ZGVzdC5pIDwgc3QtPmRlc3QubikgeworICAgICAgICBVVmFsX3N0cihzdC0+dmFsKSA9IHZhbDsK
KyAgICAgICAgUGFycm90X2NvbnZlcnRfYXJnKGludGVycCwgc3QpOworICAgICAgICBQYXJyb3Rf
c3RvcmVfYXJnKGludGVycCwgc3QpOworICAgIH0KIH0KIAogc3RhdGljIHZvaWQKIHNldF9uY2lf
UChJbnRlcnAgKmludGVycCwgY2FsbF9zdGF0ZSAqc3QsIFBNQyogdmFsKQogewogICAgIFBhcnJv
dF9pbml0X3JldF9uY2koaW50ZXJwLCBzdCwgIlAiKTsKLSAgICBVVmFsX3BtYyhzdC0+dmFsKSA9
IHZhbDsKLSAgICBQYXJyb3RfY29udmVydF9hcmcoaW50ZXJwLCBzdCk7Ci0gICAgUGFycm90X3N0
b3JlX2FyZyhpbnRlcnAsIHN0KTsKKyAgICBpZiAoc3QtPmRlc3QuaSA8IHN0LT5kZXN0Lm4pIHsK
KyAgICAgICAgVVZhbF9wbWMoc3QtPnZhbCkgPSB2YWw7CisgICAgICAgIFBhcnJvdF9jb252ZXJ0
X2FyZyhpbnRlcnAsIHN0KTsKKyAgICAgICAgUGFycm90X3N0b3JlX2FyZyhpbnRlcnAsIHN0KTsK
KyAgICB9CiB9CiAKIC8qIEFsbCBvdXIgc3RhdGljIGZ1bmN0aW9ucyB0aGF0IGNhbGwgaW4gdmFy
aW91cyB3YXlzLiBZZXMsIHRlcnJpYmx5CkluZGV4OiBpbmNsdWRlL3BhcnJvdC9pbnRlcl9jYWxs
LmgKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PQotLS0gaW5jbHVkZS9wYXJyb3QvaW50ZXJfY2FsbC5oCShyZXZpc2lvbiAx
ODI5NykKKysrIGluY2x1ZGUvcGFycm90L2ludGVyX2NhbGwuaAkod29ya2luZyBjb3B5KQpAQCAt
Niw5ICs2LDExIEBACiAgKiAgRGF0YSBTdHJ1Y3R1cmUgYW5kIEFsZ29yaXRobXM6CiAgKiAgICAg
Q2FsbCBhcmd1bWVudCBoYW5kbGluZy4KICAqICBIaXN0b3J5OgotICogICAgIEluaXRpYWwgdmVy
c2lvbiBieSBsZW8gb24gb24gMjAwNS8wNy8yMgorICogICAgIEluaXRpYWwgdmVyc2lvbiBieSBs
ZW8gb24gMjAwNS8wNy8yMgorICogICAgIE1ham9yIGNoYW5nZXMgYnkgbWRpZXAgaW4gQXByaWwg
MjAwNwogICogIE5vdGVzOgogICogIFJlZmVyZW5jZXM6CisgKiAgICAgcGRkMDMgLSBDYWxsaW5n
IENvbnZlbnRpb25zCiAgKi8KIAogI2lmICFkZWZpbmVkKFBBUlJPVF9JTlRFUl9DQUxMX0hfR1VB
UkQpCkBAIC0xNyw2MSArMTksMTUgQEAKIGVudW0gY2FsbF9zdGF0ZV9tb2RlIHsKICAgICAvKiBh
cmcgcHJvY2Vzc2luZyBzdGF0ZXMKICAgICAgKiAgICAgICA8c3JjPl88ZGVzdD4gICAgICAgICAg
IHNkICBuaWJibGVzICAgICovCi0gICAgQ0FMTF9TVEFURV9QT1NfUE9TICAgICAgICAgID0gMHgw
MCwKLSAgICBDQUxMX1NUQVRFX09QVCAgICAgICAgICAgICAgPSAweDAxLCAgLyogZGVzdCBvbmx5
ICovCi0gICAgQ0FMTF9TVEFURV9TTFVSUCAgICAgICAgICAgID0gMHgwMiwgIC8qIGRlc3Qgb25s
eSAqLwotICAgIENBTExfU1RBVEVfTkFNRURfeCAgICAgICAgICA9IDB4NDAsCi0gICAgQ0FMTF9T
VEFURV9FTkRfeCAgICAgICAgICAgID0gMHg4MCwKLSAgICBDQUxMX1NUQVRFX3hfTkFNRUQgICAg
ICAgICAgPSAweDA0LAotICAgIENBTExfU1RBVEVfeF9FTkQgICAgICAgICAgICA9IDB4MDgsCi0g
ICAgQ0FMTF9TVEFURV9QT1NfUE9TX09QVCAgICAgID0gQ0FMTF9TVEFURV9PUFQsCi0gICAgQ0FM
TF9TVEFURV9QT1NfUE9TX1NMVVJQICAgID0gQ0FMTF9TVEFURV9TTFVSUCwKLSAgICBDQUxMX1NU
QVRFX1BPU19OQU1FRCAgICAgICAgPSBDQUxMX1NUQVRFX3hfTkFNRUQsCi0gICAgQ0FMTF9TVEFU
RV9QT1NfTkFNRURfT1BUICAgID0gQ0FMTF9TVEFURV9QT1NfTkFNRUR8Q0FMTF9TVEFURV9PUFQs
Ci0gICAgQ0FMTF9TVEFURV9QT1NfRU5EICAgICAgICAgID0gQ0FMTF9TVEFURV94X0VORCwKLSAg
ICBDQUxMX1NUQVRFX05BTUVEX1BPUyAgICAgICAgPSBDQUxMX1NUQVRFX05BTUVEX3gsCi0gICAg
Q0FMTF9TVEFURV9OQU1FRF9QT1NfT1BUICAgID0gQ0FMTF9TVEFURV9OQU1FRF94fENBTExfU1RB
VEVfT1BULAotICAgIENBTExfU1RBVEVfTkFNRURfUE9TX1NMVVJQICA9IENBTExfU1RBVEVfTkFN
RURfeHxDQUxMX1NUQVRFX1NMVVJQLAotICAgIENBTExfU1RBVEVfTkFNRURfTkFNRUQgICAgICA9
IENBTExfU1RBVEVfTkFNRURfeHxDQUxMX1NUQVRFX3hfTkFNRUQsCi0gICAgQ0FMTF9TVEFURV9O
QU1FRF9OQU1FRF9PUFQgID0gQ0FMTF9TVEFURV9OQU1FRF9OQU1FRHxDQUxMX1NUQVRFX09QVCwK
LSAgICBDQUxMX1NUQVRFX05BTUVEX05BTUVEX1NMVVJQPSBDQUxMX1NUQVRFX05BTUVEX05BTUVE
fENBTExfU1RBVEVfU0xVUlAsCi0gICAgQ0FMTF9TVEFURV9FTkRfUE9TX09QVCAgICAgID0gQ0FM
TF9TVEFURV9FTkRfeHxDQUxMX1NUQVRFX09QVCwKLSAgICBDQUxMX1NUQVRFX0VORF9OQU1FRF9O
QU1FRCAgPSBDQUxMX1NUQVRFX0VORF94fENBTExfU1RBVEVfTkFNRURfTkFNRUQsCi0gICAgQ0FM
TF9TVEFURV9FTkRfUE9TX05BTUVEICAgID0gQ0FMTF9TVEFURV9FTkRfeHxDQUxMX1NUQVRFX1BP
U19OQU1FRCwKLSAgICBDQUxMX1NUQVRFX0VORF9OQU1FRF9PUFQgICAgPSBDQUxMX1NUQVRFX0VO
RF94fENBTExfU1RBVEVfUE9TX05BTUVEX09QVCwKLSAgICBDQUxMX1NUQVRFX0VORF9FTkQgICAg
ICAgICAgPSBDQUxMX1NUQVRFX0VORF94fENBTExfU1RBVEVfeF9FTkQsCi0gICAgQ0FMTF9TVEFU
RV9NQVNLICAgICAgICAgICAgID0gMHhmZiwKIAogICAgIENBTExfU1RBVEVfU0lHICAgICAgICA9
ICAweDEwMCwgICAgIC8qIHJ1bm9wcywgbmNpICovCiAgICAgQ0FMTF9TVEFURV9PUCAgICAgICAg
ID0gIDB4MjAwLCAgICAgLyogZ2V0Xywgc2V0XyBvcHMgKi8KICAgICBDQUxMX1NfRF9NQVNLICAg
ICAgICAgPSAgMHgzMDAsICAgICAvKiBzcmMvZGVzdCBtYXNrICovCiAKLSAgICBDQUxMX1NUQVRF
X0ZMQVRURU4gICAgPSAgMHg0MDAsICAgICAvKiBmbGF0dGVuIHNyYyAqLwotICAgIENBTExfU1RB
VEVfTkVYVF9BUkcgICA9ICAweDgwMAorICAgIENBTExfU1RBVEVfRkxBVFRFTiAgICA9ICAweDQw
MCAgICAgIC8qIGZsYXR0ZW4gc3JjICovCiAKIH07CiAKLSNkZWZpbmUgQ0FMTF9TVEFURV94X0lT
U0VUKG8sIHgpIChvICYgQ0FMTF9TVEFURV8gIyMgeCkKLSNkZWZpbmUgQ0FMTF9TVEFURV94X1NF
VChvLCB4KSAobyB8PSBDQUxMX1NUQVRFXyAjIyB4KQotI2RlZmluZSBDQUxMX1NUQVRFX3hfVU5T
RVQobywgeCkgKG8gJj0gfkNBTExfU1RBVEVfICMjIHgpCi0KLSNkZWZpbmUgQ0FMTF9TVEFURV9N
QVNLX01BU0sobykgICAgICAgKENBTExfU1RBVEVfWF9JU1NFVChvLCBNQVNLKSkKLSNkZWZpbmUg
Q0FMTF9TVEFURV9TSUdfSVNTRVQobykgICAgICAgKENBTExfU1RBVEVfWF9JU1NFVChvLCBTSUcp
KQotI2RlZmluZSBDQUxMX1NUQVRFX09QX0lTU0VUKG8pICAgICAgICAoQ0FMTF9TVEFURV9YX0lT
U0VUKG8sIE9QKSkKLSNkZWZpbmUgQ0FMTF9TX0RfTUFTS19NQVNLKG8pICAgICAgICAgKG8gJiBD
QUxMX1NfRF9NQVNLKQotI2RlZmluZSBDQUxMX1NUQVRFX0ZMQVRURU5fSVNTRVQobykgICAoQ0FM
TF9TVEFURV9YX0lTU0VUKG8sIEZMQVRURU4pKQotI2RlZmluZSBDQUxMX1NUQVRFX05FWFRfQVJH
X0lTU0VUKG8pICAoQ0FMTF9TVEFURV9YX0lTU0VUKG8sIE5FWFRfQVJHKSkKLQotI2RlZmluZSBD
QUxMX1NUQVRFX1NJR19TRVQobykgICAgICAgKENBTExfU1RBVEVfWF9TRVQobywgU0lHKSkKLSNk
ZWZpbmUgQ0FMTF9TVEFURV9PUF9TRVQobykgICAgICAgIChDQUxMX1NUQVRFX1hfU0VUKG8sIE9Q
KSkKLSNkZWZpbmUgQ0FMTF9TVEFURV9GTEFUVEVOX1NFVChvKSAgIChDQUxMX1NUQVRFX1hfU0VU
KG8sIEZMQVRURU4pKQotI2RlZmluZSBDQUxMX1NUQVRFX05FWFRfQVJHX1NFVChvKSAgKENBTExf
U1RBVEVfWF9TRVQobywgTkVYVF9BUkcpKQotCi0jZGVmaW5lIENBTExfU1RBVEVfU0lHX1VOU0VU
KG8pICAgICAgIChDQUxMX1NUQVRFX1hfVU5TRVQobywgU0lHKSkKLSNkZWZpbmUgQ0FMTF9TVEFU
RV9PUF9VTlNFVChvKSAgICAgICAgKENBTExfU1RBVEVfWF9VTlNFVChvLCBPUCkpCi0jZGVmaW5l
IENBTExfU1RBVEVfRkxBVFRFTl9VTlNFVChvKSAgIChDQUxMX1NUQVRFX1hfVU5TRVQobywgRkxB
VFRFTikpCi0jZGVmaW5lIENBTExfU1RBVEVfTkVYVF9BUkdfVU5TRVQobykgIChDQUxMX1NUQVRF
X1hfVU5TRVQobywgTkVYVF9BUkcpKQotCiB0eXBlZGVmIHN0cnVjdCBjYWxsX3N0YXRlX2l0ZW0g
ewogICAgIGludCBtb2RlOyAgICAgICAvKiBmcm9tX3NpZywgZnJvbV9zZXRfb3BzLCBmbGF0dGVu
IC4uLiovCiAgICAgdW5pb24gewpAQCAtODUsNiArNDEsNyBAQAogICAgICAgICB9IG9wOwogICAg
IH0gdTsKICAgICBwYXJyb3RfY29udGV4dF90ICpjdHg7CisgICAgSU5UVkFMIHVzZWQ7CiAgICAg
SU5UVkFMIGk7CiAgICAgSU5UVkFMIG47CiAgICAgSU5UVkFMIHNpZzsKSW5kZXg6IHQvcG1jL21t
ZC50Cj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT0KLS0tIHQvcG1jL21tZC50CShyZXZpc2lvbiAxODI5NykKKysrIHQvcG1j
L21tZC50CSh3b3JraW5nIGNvcHkpCkBAIC0zNDcsNyArMzQ3LDcgQEAKICAgICBlbmQKIC5wY2Nf
c3ViIEludGVnZXJfYnhvcl9JbnR2YWw6CiAgICAgIyB0aGUgZGVzdGluYXRpb24gaXMgb3B0aW9u
YWwsIGRlcGVuZGluZyBvbiB0aGUgaW5maXggb3AgdXNlZAotICAgIGdldF9wYXJhbXMgIigwLDAs
MHgyMCwweDQwKSIsIFA1LCBJNSwgUDYsIEk3CisgICAgZ2V0X3BhcmFtcyAiKDAsMCwweDgwLDB4
MTAwKSIsIFA1LCBJNSwgUDYsIEk3CiAgICAgcHJpbnQgIm9rXG4iCiAgICAgc2V0IEkxMCwgUDUK
ICAgICBieG9yIEkxMSwgSTEwLCBJNQpJbmRleDogdC9vcC9jYWxsaW5nLnQKPT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQot
LS0gdC9vcC9jYWxsaW5nLnQJKHJldmlzaW9uIDE4Mjk3KQorKysgdC9vcC9jYWxsaW5nLnQJKHdv
cmtpbmcgY29weSkKQEAgLTIzNzMsNyArMjM3Myw3IEBACiAvcG9zaXRpb25hbCBpbnNpZGUgbmFt
ZWQgYXJncyBhdCBwb3NpdGlvbiAyLwogT1VUUFVUCiAKLXBpcl9vdXRwdXRfbGlrZSggPDwnQ09E
RScsIDw8J09VVFBVVCcsICJ1bmV4cGVjdGVkIHBvc2l0aW9uYWwgYXJnIiwgdG9kbyA9PiAndW5p
bXBsZW1lbnRlZCcgKTsKK3Bpcl9vdXRwdXRfbGlrZSggPDwnQ09ERScsIDw8J09VVFBVVCcsICJ1
bmV4cGVjdGVkIHBvc2l0aW9uYWwgYXJnIiApOwogLnN1YiAnbWFpbicKICAgICAnZm9vJygnYWJj
JywgJ2RlZic9PjEsICdnaGknLCAnamtsJz0+MSkKIC5lbmQKQEAgLTIzODYsOCArMjM4Niw3IEBA
CiAvcG9zaXRpb25hbCBpbnNpZGUgbmFtZWQgYXJncyBhdCBwb3NpdGlvbiAzLwogT1VUUFVUCiAK
LXBpcl9vdXRwdXRfaXMoCi0gICAgPDwnQ09ERScsIDw8J09VVFBVVCcsICJSVCAjNDA0OTAgLSBm
bGF0L3NsdXJweSBuYW1lZCBhcmd1bWVudHMiLCB0b2RvID0+ICd1bmltcGxlbWVudGVkJyApOwor
cGlyX291dHB1dF9pcyggPDwnQ09ERScsIDw8J09VVFBVVCcsICJSVCAjNDA0OTAgLSBmbGF0L3Ns
dXJweSBuYW1lZCBhcmd1bWVudHMiICk7CiAuc3ViICdtYWluJyA6bWFpbgogICAgICAgICAubG9j
YWwgcG1jIGFyZ3MKICAgICAgICAgYXJncyA9IG5ldyAuSGFzaApJbmRleDogdC9vcC9jY19zdGF0
ZS50Cj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT0KLS0tIHQvb3AvY2Nfc3RhdGUudAkocmV2aXNpb24gMTgyOTcpCisrKyB0
L29wL2NjX3N0YXRlLnQJKHdvcmtpbmcgY29weSkKQEAgLTY0LDggKzY0LDcgQEAKIAogcGNjX29r
KAogICAgIHsgcGFyYW1zID0+ICIucGFyYW0gcG1jIGFiYyA6b3B0aW9uYWwgOnNsdXJweSIgfSwK
LSAgICAnRzQ6IG9wdGlvbmFsIHNsdXJweSBwYXJhbSBtYXkgYmUgZW1wdHknLAotICAgIHRvZG8g
PT4gJ2NjIHByb2Nlc3NvciBzdGF0ZSBtaXNzaW5nJywKKyAgICAnRzQ6IG9wdGlvbmFsIHNsdXJw
eSBwYXJhbSBtYXkgYmUgZW1wdHknCiApOwogCiBwY2NfbGlrZSgK
------=_Part_59139_23135858.1177288691524--

